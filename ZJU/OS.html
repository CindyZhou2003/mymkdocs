
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Cindy的笔记本">
      
      
      
        <link rel="canonical" href="https://cindyzhou2003.github.io/mymkdocs/ZJU/OS.html">
      
      
        <link rel="prev" href="PIS.html">
      
      
        <link rel="next" href="CN.html">
      
      
      <link rel="icon" href="../assets/images/favcion.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>操作系统 - Cindy的笔记本</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=LXGW+WenKai:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"LXGW WenKai";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
      <link rel="stylesheet" href="../css/neoteroi-mkdocs.css">
    
      <link rel="stylesheet" href="../css/style.css">
    
      <link rel="stylesheet" href="../css/font.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="forest" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#operating-system-concepts" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href=".." title="Cindy的笔记本" class="md-header__button md-logo" aria-label="Cindy的笔记本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M384 512H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h304c26.5 0 48 21.5 48 48v288c0 20.9-13.4 38.7-32 45.3V448c17.7 0 32 14.3 32 32s-14.3 32-32 32zM96 384c-17.7 0-32 14.3-32 32s14.3 32 32 32h256v-64zm32-232c0 13.3 10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24H152c-13.3 0-24 10.7-24 24m24 72c-13.3 0-24 10.7-24 24s10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cindy的笔记本
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              操作系统
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="forest" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="forest-dark" data-md-color-primary="Brown" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CindyZhou2003/mymkdocs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Cindy's notebook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  
    
  
  主页🤖

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="DM.html" class="md-tabs__link">
          
  
  
    
  
  ZJU-SE课程📝

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../UIUC/ECE408.html" class="md-tabs__link">
          
  
  
    
  
  UIUC-MEng courses📚

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../skills/Algorithm.html" class="md-tabs__link">
          
  
  
    
  
  技能⚙️

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../abroad/IELTs_speaking1.html" class="md-tabs__link">
          
  
  
    
  
  出国✈️

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../work/Interview.html" class="md-tabs__link">
          
  
  
    
  
  找工

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../other/test.html" class="md-tabs__link">
          
  
  
    
  
  其他🎊

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Cindy的笔记本" class="md-nav__button md-logo" aria-label="Cindy的笔记本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M384 512H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h304c26.5 0 48 21.5 48 48v288c0 20.9-13.4 38.7-32 45.3V448c17.7 0 32 14.3 32 32s-14.3 32-32 32zM96 384c-17.7 0-32 14.3-32 32s14.3 32 32 32h256v-64zm32-232c0 13.3 10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24H152c-13.3 0-24 10.7-24 24m24 72c-13.3 0-24 10.7-24 24s10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></svg>

    </a>
    Cindy的笔记本
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CindyZhou2003/mymkdocs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Cindy's notebook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    主页🤖
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            主页🤖
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    ZJU-SE课程📝
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ZJU-SE课程📝
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大一春夏
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            大一春夏
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DM.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    离散数学及其应用
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大二秋冬
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            大二秋冬
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OOP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    面向对象程序设计
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="FDS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据结构基础
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大二春夏
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            大二春夏
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ADS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高级数据结构与算法分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DB.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据库系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ML.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    机器学习（国际化）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PIS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    信息安全原理
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大三秋冬
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            大三秋冬
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    操作系统
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="OS.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    操作系统
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      概述 Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="概述 Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统功能&amp;定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      计算机系统的运行
    </span>
  </a>
  
    <nav class="md-nav" aria-label="计算机系统的运行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#atmic-operation" class="md-nav__link">
    <span class="md-ellipsis">
      原语 atmic operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupt" class="md-nav__link">
    <span class="md-ellipsis">
      中断 interrupt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      存储
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      计算机体系结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统设计
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-operations" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统执行 OS operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="操作系统执行 OS operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-management" class="md-nav__link">
    <span class="md-ellipsis">
      Process management 进程管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    <span class="md-ellipsis">
      Memory management 内存管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-management" class="md-nav__link">
    <span class="md-ellipsis">
      File management 文件管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-management" class="md-nav__link">
    <span class="md-ellipsis">
      Storage management 存储管理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-purposes" class="md-nav__link">
    <span class="md-ellipsis">
      总结 OS purposes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operating-system-structures" class="md-nav__link">
    <span class="md-ellipsis">
      结构 Operating-System Structures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="结构 Operating-System Structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-call" class="md-nav__link">
    <span class="md-ellipsis">
      System call 系统调用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System call 系统调用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      系统调用实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      参数传递
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      系统调用分类/功能
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      系统程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    <span class="md-ellipsis">
      os 设计和实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统结构
    </span>
  </a>
  
    <nav class="md-nav" aria-label="操作系统结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unix" class="md-nav__link">
    <span class="md-ellipsis">
      UNIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monolithic-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Monolithic System Structure 宏内核架构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microkernel-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Microkernel System Structure 微内核
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-structuredarwin" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid Structure——Darwin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layered-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Layered Approach 分层方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules 模块化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Other Structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-machines" class="md-nav__link">
    <span class="md-ellipsis">
      虚拟机 Virtual Machines
    </span>
  </a>
  
    <nav class="md-nav" aria-label="虚拟机 Virtual Machines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      分类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hypervisor" class="md-nav__link">
    <span class="md-ellipsis">
      HyperVisor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os_1" class="md-nav__link">
    <span class="md-ellipsis">
      OS 生成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-boot" class="md-nav__link">
    <span class="md-ellipsis">
      系统启动 System Boot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processes" class="md-nav__link">
    <span class="md-ellipsis">
      进程 Processes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程 Processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      进程概念
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-state" class="md-nav__link">
    <span class="md-ellipsis">
      Process state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-control-blockpcb" class="md-nav__link">
    <span class="md-ellipsis">
      Process control block(PCB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      进程调度 scheduling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程调度 scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-scheduling-queues" class="md-nav__link">
    <span class="md-ellipsis">
      Process Scheduling Queues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedulers" class="md-nav__link">
    <span class="md-ellipsis">
      Schedulers 调度器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#context-switch" class="md-nav__link">
    <span class="md-ellipsis">
      Context Switch 上下文切换
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      进程操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Process Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-termination" class="md-nav__link">
    <span class="md-ellipsis">
      Process Termination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cooperating" class="md-nav__link">
    <span class="md-ellipsis">
      共同协作 cooperating
    </span>
  </a>
  
    <nav class="md-nav" aria-label="共同协作 cooperating">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cooperating-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Cooperating Processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer-consumer" class="md-nav__link">
    <span class="md-ellipsis">
      Producer-consumer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      进程间通信
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程间通信">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interprocess-communication-ipc" class="md-nav__link">
    <span class="md-ellipsis">
      Interprocess Communication (IPC)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Direct Communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indirect-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Indirect Communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronization" class="md-nav__link">
    <span class="md-ellipsis">
      Synchronization 同步性
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communication-in-client-server-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Communication in Client-Server Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Communication in Client-Server Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sockets" class="md-nav__link">
    <span class="md-ellipsis">
      Sockets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threads" class="md-nav__link">
    <span class="md-ellipsis">
      线程 Threads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="线程 Threads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-and-multithreaded-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Single and Multithreaded Processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benfits" class="md-nav__link">
    <span class="md-ellipsis">
      Benfits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-level-threadsult" class="md-nav__link">
    <span class="md-ellipsis">
      User Level Threads(ULT)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-level-threadsklt" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Level Threads(KLT)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multithreading-models" class="md-nav__link">
    <span class="md-ellipsis">
      Multithreading Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multithreading Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#many-to-one-model" class="md-nav__link">
    <span class="md-ellipsis">
      Many-to-one Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-to-one" class="md-nav__link">
    <span class="md-ellipsis">
      One-to-one
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#many-to-many-model" class="md-nav__link">
    <span class="md-ellipsis">
      Many-to-Many Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-level-model" class="md-nav__link">
    <span class="md-ellipsis">
      Two-level Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threading-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Threading Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threading Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#thread-cancellation" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Cancellation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signal-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Signal Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Pools 线程池
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduler-activations" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduler Activations 调度激活
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpu-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      调度 CPU Scheduling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调度 CPU Scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Basic concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu-scheduler" class="md-nav__link">
    <span class="md-ellipsis">
      CPU Scheduler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dispacher" class="md-nav__link">
    <span class="md-ellipsis">
      Dispacher
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      scheduling criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      调度算法 scheduling algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调度算法 scheduling algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fcfsfirst-come-first-served" class="md-nav__link">
    <span class="md-ellipsis">
      FCFS(First-Come, First-Served)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sjfshortest-job-first" class="md-nav__link">
    <span class="md-ellipsis">
      SJF(Shortest-Job-First)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#priority-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Priority Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highest-response-ratio-next-hrrn" class="md-nav__link">
    <span class="md-ellipsis">
      Highest Response Ratio Next （HRRN）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#round-robin-rr" class="md-nav__link">
    <span class="md-ellipsis">
      Round Robin (RR)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multilevel-queue" class="md-nav__link">
    <span class="md-ellipsis">
      Multilevel Queue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-feedback-queue" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Feedback Queue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-processor-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple-processor scheduling(了解)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Real-time scheduling(了解)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Thread scheduling(了解)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q" class="md-nav__link">
    <span class="md-ellipsis">
      Q
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process-synchronization" class="md-nav__link">
    <span class="md-ellipsis">
      进程同步 Process synchronization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程同步 Process synchronization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      背景 background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="背景 background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#race-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Race condition 竞态条件
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#critical-section-problem" class="md-nav__link">
    <span class="md-ellipsis">
      临界区问题 critical-section problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="临界区问题 critical-section problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      解决方案 solution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      同步机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="同步机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      软件方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      硬件方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutex-locks" class="md-nav__link">
    <span class="md-ellipsis">
      互斥锁 Mutex locks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semaphores" class="md-nav__link">
    <span class="md-ellipsis">
      信号量方法 Semaphores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor" class="md-nav__link">
    <span class="md-ellipsis">
      管程方法 monitor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      例子
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deadlock" class="md-nav__link">
    <span class="md-ellipsis">
      死锁 Deadlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="死锁 Deadlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-deadlock-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Deadlock Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Deadlock Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      产生死锁的四个必要条件
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-model" class="md-nav__link">
    <span class="md-ellipsis">
      系统模型 System Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="系统模型 System Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-allocation-graph" class="md-nav__link">
    <span class="md-ellipsis">
      资源分配图 Resource-Allocation Graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods-for-handling-deadlocks" class="md-nav__link">
    <span class="md-ellipsis">
      死锁处理方法 Methods for Handling Deadlocks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="死锁处理方法 Methods for Handling Deadlocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deadlock-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Prevention (预防)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-avoidance" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Avoidance (避免)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Detection ( 检测 )
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-from-deadlock" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery from Deadlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovery from Deadlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-preemption" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Preemption
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-management_1" class="md-nav__link">
    <span class="md-ellipsis">
      内存管理 Memory Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="内存管理 Memory Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background_1" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cache-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Cache Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multistep-processing-of-a-user-program" class="md-nav__link">
    <span class="md-ellipsis">
      Multistep Processing of a User Program
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binding-of-instructions-and-data-to-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Binding of Instructions and Data to Memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logical-vs-physical-address-space" class="md-nav__link">
    <span class="md-ellipsis">
      Logical vs. Physical Address Space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linking" class="md-nav__link">
    <span class="md-ellipsis">
      链接 Linking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading" class="md-nav__link">
    <span class="md-ellipsis">
      装入 Loading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contiguous-memory-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      连续分配 Contiguous Memory Allocation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="连续分配 Contiguous Memory Allocation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-storage-allocation-problem" class="md-nav__link">
    <span class="md-ellipsis">
      动态分配的算法 Dynamic storage-allocation problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fragmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Fragmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#paging" class="md-nav__link">
    <span class="md-ellipsis">
      分页 Paging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="分页 Paging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address-translation-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Address Translation Scheme
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      已知条件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      转换步骤
    </span>
  </a>
  
    <nav class="md-nav" aria-label="转换步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 计算虚拟地址的页号和页内偏移
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 根据页表找到对应页框号
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 计算物理地址
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      结果
    </span>
  </a>
  
    <nav class="md-nav" aria-label="结果">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#paging-hardware-with-tlb" class="md-nav__link">
    <span class="md-ellipsis">
      Paging Hardware With TLB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effective-access-time" class="md-nav__link">
    <span class="md-ellipsis">
      Effective Access Time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-protection-in-paged-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Protection in Paged Scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-pages" class="md-nav__link">
    <span class="md-ellipsis">
      Shared Pages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure-of-the-page-table" class="md-nav__link">
    <span class="md-ellipsis">
      Structure of the Page Table
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structure of the Page Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hierarchical-paging" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchical Paging 分级页表/多级页表
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashed-page-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Hashed Page Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inverted-page-tables" class="md-nav__link">
    <span class="md-ellipsis">
      倒排页表 Inverted Page Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      页表项计算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swapping" class="md-nav__link">
    <span class="md-ellipsis">
      Swapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      分段 Segmentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-the-intel-pentium" class="md-nav__link">
    <span class="md-ellipsis">
      Example: The Intel Pentium
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example: The Intel Pentium">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#intel-pentium-segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Intel Pentium Segmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#virtual-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Memory 虚拟内存
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virtual Memory 虚拟内存">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background_2" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle-of-locality" class="md-nav__link">
    <span class="md-ellipsis">
      principle of locality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-creation_1" class="md-nav__link">
    <span class="md-ellipsis">
      Process Creation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demand-paging" class="md-nav__link">
    <span class="md-ellipsis">
      Demand Paging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demand Paging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#valid-invalid-bit" class="md-nav__link">
    <span class="md-ellipsis">
      Valid-Invalid Bit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-fault" class="md-nav__link">
    <span class="md-ellipsis">
      Page Fault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-of-demand-paging" class="md-nav__link">
    <span class="md-ellipsis">
      Performance of Demand Paging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-on-write" class="md-nav__link">
    <span class="md-ellipsis">
      Copy-on-Write
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-replacement" class="md-nav__link">
    <span class="md-ellipsis">
      Page Replacement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page Replacement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page-replacement_1" class="md-nav__link">
    <span class="md-ellipsis">
      Page replacement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-replacement-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Page Replacement Algorithms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-of-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation of Frames
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocation of Frames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fixed-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed Allocation 固定分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#priority-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Priority Allocation 优先级分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-vs-local-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Global vs. Local Allocation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Thrashing 抖动、颠簸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Thrashing 抖动、颠簸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demand-paging-and-thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Demand Paging and Thrashing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-set-model" class="md-nav__link">
    <span class="md-ellipsis">
      Working-Set Model 工作集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-fault-frequency-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Page-Fault Frequency Scheme
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-mapped-files" class="md-nav__link">
    <span class="md-ellipsis">
      内存映射文件 Memory-Mapped Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocating-kernel-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating Kernel Memory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocating Kernel Memory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buddy-system" class="md-nav__link">
    <span class="md-ellipsis">
      Buddy System （伙伴系统）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slab-allocator" class="md-nav__link">
    <span class="md-ellipsis">
      Slab Allocator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-prepaging" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – Prepaging ( 预调页 )
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-page-size" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – Page Size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-tlb-reach-tlb" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – TLB Reach（ TLB 范围）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-program-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – Program Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Other Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-system-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Operating-System Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-interface" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-System Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-concept" class="md-nav__link">
    <span class="md-ellipsis">
      File Concept
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Concept">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-system" class="md-nav__link">
    <span class="md-ellipsis">
      File system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-concept_1" class="md-nav__link">
    <span class="md-ellipsis">
      File Concept
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operations-file-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Operations &amp; file attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-files" class="md-nav__link">
    <span class="md-ellipsis">
      Open files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Access Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      目录结构 Directory Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="目录结构 Directory Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#both-the-directory-structure-and-the-files-reside-on-disk" class="md-nav__link">
    <span class="md-ellipsis">
      Both the directory structure and the files reside on disk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operations-performed-on-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Operations Performed on Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      目录作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-level-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Single-Level Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-level-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Level Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree-structured-directories" class="md-nav__link">
    <span class="md-ellipsis">
      Tree-Structured Directories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acyclic-graph-directories" class="md-nav__link">
    <span class="md-ellipsis">
      Acyclic-Graph Directories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-symbolic-link-vs-hard-link" class="md-nav__link">
    <span class="md-ellipsis">
      Soft (Symbolic) Link vs. Hard Link
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-system-mounting" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Mounting 文件系统挂载
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-System Mounting 文件系统挂载">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mount-point" class="md-nav__link">
    <span class="md-ellipsis">
      Mount Point
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-sharing" class="md-nav__link">
    <span class="md-ellipsis">
      File Sharing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Sharing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-users" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-file-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Remote File Systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consistency-semantics" class="md-nav__link">
    <span class="md-ellipsis">
      Consistency Semantics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protection" class="md-nav__link">
    <span class="md-ellipsis">
      Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-lists-and-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Access Lists and Groups
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      文件系统实现 File system Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="文件系统实现 File system Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-System Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#layered-file-system" class="md-nav__link">
    <span class="md-ellipsis">
      Layered File System 分层
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-structures-used-to-implement-fs" class="md-nav__link">
    <span class="md-ellipsis">
      Data Structures Used to Implement FS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fcb" class="md-nav__link">
    <span class="md-ellipsis">
      FCB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-memory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      In-memory Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-file-system-vfs" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual File System (VFS) 虚拟文件系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contiguous-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Contiguous allocation 连续分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Linked allocation 链接分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed allocation 索引分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#free-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Free-Space Management 磁盘空闲空间管理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Free-Space Management 磁盘空闲空间管理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      空闲表法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bit-map" class="md-nav__link">
    <span class="md-ellipsis">
      Bit Map 位示图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked-list" class="md-nav__link">
    <span class="md-ellipsis">
      Linked list 链表法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protect" class="md-nav__link">
    <span class="md-ellipsis">
      Protect
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#efficiency-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Efficiency and Performance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Efficiency and Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page-cache" class="md-nav__link">
    <span class="md-ellipsis">
      Page Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-buffer-cache" class="md-nav__link">
    <span class="md-ellipsis">
      Unified Buffer Cache
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mass-storage-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Mass-Storage Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mass-Storage Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview-of-mass-storage-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Overview of Mass Storage Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview of Mass Storage Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetic-disks" class="md-nav__link">
    <span class="md-ellipsis">
      Magnetic disks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonvolatile-memory-devices" class="md-nav__link">
    <span class="md-ellipsis">
      Nonvolatile Memory Devices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk" class="md-nav__link">
    <span class="md-ellipsis">
      Disk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Disk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disk-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-attachment" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Attachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-a-disk-page" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing a Disk Page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-management" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Swap-Space Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid-structure" class="md-nav__link">
    <span class="md-ellipsis">
      RAID Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stable-storage-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Stable-Storage Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io-systems" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I/O Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#io-hardware-application" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Hardware Application
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I/O Hardware Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#io-port-registers" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Port Registers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-controling-methods" class="md-nav__link">
    <span class="md-ellipsis">
      I/O controling methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-io-interface-io" class="md-nav__link">
    <span class="md-ellipsis">
      Application I/O Interface 应用程序 I/O 接口
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-devices" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Devices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blocking-and-nonblocking-io" class="md-nav__link">
    <span class="md-ellipsis">
      Blocking and Nonblocking I/O
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-io-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel I/O Interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kernel I/O Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kernel-io-subsystem" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel I/O Subsystem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-subsystem-transforming" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Subsystem Transforming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-requests-to-hardware-operations" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Requests to Hardware Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quiz-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Quiz &amp; LAB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quiz &amp; LAB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quiz" class="md-nav__link">
    <span class="md-ellipsis">
      quiz
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab" class="md-nav__link">
    <span class="md-ellipsis">
      lab
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机网络
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E6%AF%9B%E6%A6%82.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    毛概
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="IoT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    物联网技术基础与应用开发
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SQAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    软件质量与保证测试
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大三春夏
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            大三春夏
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CLDF.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数字逻辑设计
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E4%B9%A0%E6%A6%82.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    习概
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UIUC-MEng courses📚
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            UIUC-MEng courses📚
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fall 2025
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Fall 2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UIUC/ECE408.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ECE408/CS483 Applied Parallel Programming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UIUC/ECE448.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ECE448/CS440 Artificial Intelligence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UIUC/ECE598.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ECE498/598 Deep Generative Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    技能⚙️
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            技能⚙️
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../skills/Algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../skills/deeplearning.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    深度学习
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    出国✈️
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            出国✈️
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    雅思口语
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            雅思口语
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abroad/IELTs_speaking1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    第一次
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abroad/IELTs_speaking2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    第二次
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abroad/IELTs_writing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    雅思作文
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    找工
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            找工
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../work/Interview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    面试
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    其他🎊
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            其他🎊
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../other/test.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../other/Debug_issue.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    部署网站时的问题
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      概述 Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="概述 Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统功能&amp;定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      计算机系统的运行
    </span>
  </a>
  
    <nav class="md-nav" aria-label="计算机系统的运行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#atmic-operation" class="md-nav__link">
    <span class="md-ellipsis">
      原语 atmic operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupt" class="md-nav__link">
    <span class="md-ellipsis">
      中断 interrupt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      存储
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      计算机体系结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统设计
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-operations" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统执行 OS operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="操作系统执行 OS operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-management" class="md-nav__link">
    <span class="md-ellipsis">
      Process management 进程管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    <span class="md-ellipsis">
      Memory management 内存管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-management" class="md-nav__link">
    <span class="md-ellipsis">
      File management 文件管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-management" class="md-nav__link">
    <span class="md-ellipsis">
      Storage management 存储管理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-purposes" class="md-nav__link">
    <span class="md-ellipsis">
      总结 OS purposes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operating-system-structures" class="md-nav__link">
    <span class="md-ellipsis">
      结构 Operating-System Structures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="结构 Operating-System Structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-call" class="md-nav__link">
    <span class="md-ellipsis">
      System call 系统调用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System call 系统调用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      系统调用实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      参数传递
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      系统调用分类/功能
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      系统程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    <span class="md-ellipsis">
      os 设计和实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      操作系统结构
    </span>
  </a>
  
    <nav class="md-nav" aria-label="操作系统结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unix" class="md-nav__link">
    <span class="md-ellipsis">
      UNIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monolithic-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Monolithic System Structure 宏内核架构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microkernel-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Microkernel System Structure 微内核
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-structuredarwin" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid Structure——Darwin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layered-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Layered Approach 分层方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules 模块化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Other Structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-machines" class="md-nav__link">
    <span class="md-ellipsis">
      虚拟机 Virtual Machines
    </span>
  </a>
  
    <nav class="md-nav" aria-label="虚拟机 Virtual Machines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      分类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hypervisor" class="md-nav__link">
    <span class="md-ellipsis">
      HyperVisor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os_1" class="md-nav__link">
    <span class="md-ellipsis">
      OS 生成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-boot" class="md-nav__link">
    <span class="md-ellipsis">
      系统启动 System Boot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processes" class="md-nav__link">
    <span class="md-ellipsis">
      进程 Processes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程 Processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      进程概念
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-state" class="md-nav__link">
    <span class="md-ellipsis">
      Process state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-control-blockpcb" class="md-nav__link">
    <span class="md-ellipsis">
      Process control block(PCB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      进程调度 scheduling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程调度 scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-scheduling-queues" class="md-nav__link">
    <span class="md-ellipsis">
      Process Scheduling Queues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedulers" class="md-nav__link">
    <span class="md-ellipsis">
      Schedulers 调度器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#context-switch" class="md-nav__link">
    <span class="md-ellipsis">
      Context Switch 上下文切换
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      进程操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Process Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-termination" class="md-nav__link">
    <span class="md-ellipsis">
      Process Termination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cooperating" class="md-nav__link">
    <span class="md-ellipsis">
      共同协作 cooperating
    </span>
  </a>
  
    <nav class="md-nav" aria-label="共同协作 cooperating">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cooperating-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Cooperating Processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer-consumer" class="md-nav__link">
    <span class="md-ellipsis">
      Producer-consumer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      进程间通信
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程间通信">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interprocess-communication-ipc" class="md-nav__link">
    <span class="md-ellipsis">
      Interprocess Communication (IPC)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Direct Communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indirect-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Indirect Communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronization" class="md-nav__link">
    <span class="md-ellipsis">
      Synchronization 同步性
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communication-in-client-server-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Communication in Client-Server Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Communication in Client-Server Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sockets" class="md-nav__link">
    <span class="md-ellipsis">
      Sockets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threads" class="md-nav__link">
    <span class="md-ellipsis">
      线程 Threads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="线程 Threads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-and-multithreaded-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Single and Multithreaded Processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benfits" class="md-nav__link">
    <span class="md-ellipsis">
      Benfits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-level-threadsult" class="md-nav__link">
    <span class="md-ellipsis">
      User Level Threads(ULT)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-level-threadsklt" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Level Threads(KLT)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multithreading-models" class="md-nav__link">
    <span class="md-ellipsis">
      Multithreading Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multithreading Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#many-to-one-model" class="md-nav__link">
    <span class="md-ellipsis">
      Many-to-one Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-to-one" class="md-nav__link">
    <span class="md-ellipsis">
      One-to-one
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#many-to-many-model" class="md-nav__link">
    <span class="md-ellipsis">
      Many-to-Many Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-level-model" class="md-nav__link">
    <span class="md-ellipsis">
      Two-level Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threading-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Threading Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threading Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#thread-cancellation" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Cancellation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signal-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Signal Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Pools 线程池
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduler-activations" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduler Activations 调度激活
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpu-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      调度 CPU Scheduling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调度 CPU Scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Basic concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu-scheduler" class="md-nav__link">
    <span class="md-ellipsis">
      CPU Scheduler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dispacher" class="md-nav__link">
    <span class="md-ellipsis">
      Dispacher
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      scheduling criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      调度算法 scheduling algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调度算法 scheduling algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fcfsfirst-come-first-served" class="md-nav__link">
    <span class="md-ellipsis">
      FCFS(First-Come, First-Served)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sjfshortest-job-first" class="md-nav__link">
    <span class="md-ellipsis">
      SJF(Shortest-Job-First)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#priority-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Priority Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highest-response-ratio-next-hrrn" class="md-nav__link">
    <span class="md-ellipsis">
      Highest Response Ratio Next （HRRN）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#round-robin-rr" class="md-nav__link">
    <span class="md-ellipsis">
      Round Robin (RR)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multilevel-queue" class="md-nav__link">
    <span class="md-ellipsis">
      Multilevel Queue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-feedback-queue" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Feedback Queue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-processor-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple-processor scheduling(了解)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Real-time scheduling(了解)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Thread scheduling(了解)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q" class="md-nav__link">
    <span class="md-ellipsis">
      Q
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process-synchronization" class="md-nav__link">
    <span class="md-ellipsis">
      进程同步 Process synchronization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程同步 Process synchronization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      背景 background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="背景 background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#race-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Race condition 竞态条件
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#critical-section-problem" class="md-nav__link">
    <span class="md-ellipsis">
      临界区问题 critical-section problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="临界区问题 critical-section problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      解决方案 solution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      同步机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="同步机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      软件方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      硬件方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutex-locks" class="md-nav__link">
    <span class="md-ellipsis">
      互斥锁 Mutex locks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semaphores" class="md-nav__link">
    <span class="md-ellipsis">
      信号量方法 Semaphores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor" class="md-nav__link">
    <span class="md-ellipsis">
      管程方法 monitor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      例子
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deadlock" class="md-nav__link">
    <span class="md-ellipsis">
      死锁 Deadlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="死锁 Deadlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-deadlock-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Deadlock Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Deadlock Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      产生死锁的四个必要条件
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-model" class="md-nav__link">
    <span class="md-ellipsis">
      系统模型 System Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="系统模型 System Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-allocation-graph" class="md-nav__link">
    <span class="md-ellipsis">
      资源分配图 Resource-Allocation Graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods-for-handling-deadlocks" class="md-nav__link">
    <span class="md-ellipsis">
      死锁处理方法 Methods for Handling Deadlocks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="死锁处理方法 Methods for Handling Deadlocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deadlock-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Prevention (预防)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-avoidance" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Avoidance (避免)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Detection ( 检测 )
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-from-deadlock" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery from Deadlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovery from Deadlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-preemption" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Preemption
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-management_1" class="md-nav__link">
    <span class="md-ellipsis">
      内存管理 Memory Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="内存管理 Memory Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background_1" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cache-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Cache Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multistep-processing-of-a-user-program" class="md-nav__link">
    <span class="md-ellipsis">
      Multistep Processing of a User Program
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binding-of-instructions-and-data-to-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Binding of Instructions and Data to Memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logical-vs-physical-address-space" class="md-nav__link">
    <span class="md-ellipsis">
      Logical vs. Physical Address Space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linking" class="md-nav__link">
    <span class="md-ellipsis">
      链接 Linking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading" class="md-nav__link">
    <span class="md-ellipsis">
      装入 Loading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contiguous-memory-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      连续分配 Contiguous Memory Allocation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="连续分配 Contiguous Memory Allocation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-storage-allocation-problem" class="md-nav__link">
    <span class="md-ellipsis">
      动态分配的算法 Dynamic storage-allocation problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fragmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Fragmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#paging" class="md-nav__link">
    <span class="md-ellipsis">
      分页 Paging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="分页 Paging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address-translation-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Address Translation Scheme
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      已知条件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      转换步骤
    </span>
  </a>
  
    <nav class="md-nav" aria-label="转换步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 计算虚拟地址的页号和页内偏移
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 根据页表找到对应页框号
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 计算物理地址
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      结果
    </span>
  </a>
  
    <nav class="md-nav" aria-label="结果">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#paging-hardware-with-tlb" class="md-nav__link">
    <span class="md-ellipsis">
      Paging Hardware With TLB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effective-access-time" class="md-nav__link">
    <span class="md-ellipsis">
      Effective Access Time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-protection-in-paged-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Protection in Paged Scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-pages" class="md-nav__link">
    <span class="md-ellipsis">
      Shared Pages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure-of-the-page-table" class="md-nav__link">
    <span class="md-ellipsis">
      Structure of the Page Table
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structure of the Page Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hierarchical-paging" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchical Paging 分级页表/多级页表
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashed-page-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Hashed Page Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inverted-page-tables" class="md-nav__link">
    <span class="md-ellipsis">
      倒排页表 Inverted Page Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      页表项计算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swapping" class="md-nav__link">
    <span class="md-ellipsis">
      Swapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      分段 Segmentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-the-intel-pentium" class="md-nav__link">
    <span class="md-ellipsis">
      Example: The Intel Pentium
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example: The Intel Pentium">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#intel-pentium-segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Intel Pentium Segmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#virtual-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Memory 虚拟内存
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virtual Memory 虚拟内存">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background_2" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle-of-locality" class="md-nav__link">
    <span class="md-ellipsis">
      principle of locality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-creation_1" class="md-nav__link">
    <span class="md-ellipsis">
      Process Creation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demand-paging" class="md-nav__link">
    <span class="md-ellipsis">
      Demand Paging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demand Paging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#valid-invalid-bit" class="md-nav__link">
    <span class="md-ellipsis">
      Valid-Invalid Bit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-fault" class="md-nav__link">
    <span class="md-ellipsis">
      Page Fault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-of-demand-paging" class="md-nav__link">
    <span class="md-ellipsis">
      Performance of Demand Paging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-on-write" class="md-nav__link">
    <span class="md-ellipsis">
      Copy-on-Write
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-replacement" class="md-nav__link">
    <span class="md-ellipsis">
      Page Replacement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page Replacement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page-replacement_1" class="md-nav__link">
    <span class="md-ellipsis">
      Page replacement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-replacement-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Page Replacement Algorithms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-of-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation of Frames
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocation of Frames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fixed-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed Allocation 固定分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#priority-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Priority Allocation 优先级分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-vs-local-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Global vs. Local Allocation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Thrashing 抖动、颠簸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Thrashing 抖动、颠簸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demand-paging-and-thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Demand Paging and Thrashing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-set-model" class="md-nav__link">
    <span class="md-ellipsis">
      Working-Set Model 工作集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-fault-frequency-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Page-Fault Frequency Scheme
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-mapped-files" class="md-nav__link">
    <span class="md-ellipsis">
      内存映射文件 Memory-Mapped Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocating-kernel-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating Kernel Memory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocating Kernel Memory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buddy-system" class="md-nav__link">
    <span class="md-ellipsis">
      Buddy System （伙伴系统）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slab-allocator" class="md-nav__link">
    <span class="md-ellipsis">
      Slab Allocator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-prepaging" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – Prepaging ( 预调页 )
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-page-size" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – Page Size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-tlb-reach-tlb" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – TLB Reach（ TLB 范围）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-issues-program-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Other Issues – Program Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Other Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-system-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Operating-System Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-interface" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-System Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-concept" class="md-nav__link">
    <span class="md-ellipsis">
      File Concept
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Concept">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-system" class="md-nav__link">
    <span class="md-ellipsis">
      File system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-concept_1" class="md-nav__link">
    <span class="md-ellipsis">
      File Concept
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operations-file-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Operations &amp; file attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-files" class="md-nav__link">
    <span class="md-ellipsis">
      Open files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Access Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      目录结构 Directory Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="目录结构 Directory Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#both-the-directory-structure-and-the-files-reside-on-disk" class="md-nav__link">
    <span class="md-ellipsis">
      Both the directory structure and the files reside on disk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operations-performed-on-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Operations Performed on Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      目录作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-level-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Single-Level Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-level-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Level Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree-structured-directories" class="md-nav__link">
    <span class="md-ellipsis">
      Tree-Structured Directories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acyclic-graph-directories" class="md-nav__link">
    <span class="md-ellipsis">
      Acyclic-Graph Directories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-symbolic-link-vs-hard-link" class="md-nav__link">
    <span class="md-ellipsis">
      Soft (Symbolic) Link vs. Hard Link
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-system-mounting" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Mounting 文件系统挂载
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-System Mounting 文件系统挂载">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mount-point" class="md-nav__link">
    <span class="md-ellipsis">
      Mount Point
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-sharing" class="md-nav__link">
    <span class="md-ellipsis">
      File Sharing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Sharing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-users" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-file-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Remote File Systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consistency-semantics" class="md-nav__link">
    <span class="md-ellipsis">
      Consistency Semantics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protection" class="md-nav__link">
    <span class="md-ellipsis">
      Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-lists-and-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Access Lists and Groups
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      文件系统实现 File system Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="文件系统实现 File system Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-System Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#layered-file-system" class="md-nav__link">
    <span class="md-ellipsis">
      Layered File System 分层
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-structures-used-to-implement-fs" class="md-nav__link">
    <span class="md-ellipsis">
      Data Structures Used to Implement FS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fcb" class="md-nav__link">
    <span class="md-ellipsis">
      FCB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-memory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      In-memory Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-file-system-vfs" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual File System (VFS) 虚拟文件系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contiguous-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Contiguous allocation 连续分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Linked allocation 链接分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed allocation 索引分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#free-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Free-Space Management 磁盘空闲空间管理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Free-Space Management 磁盘空闲空间管理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      空闲表法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bit-map" class="md-nav__link">
    <span class="md-ellipsis">
      Bit Map 位示图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked-list" class="md-nav__link">
    <span class="md-ellipsis">
      Linked list 链表法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protect" class="md-nav__link">
    <span class="md-ellipsis">
      Protect
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#efficiency-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Efficiency and Performance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Efficiency and Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page-cache" class="md-nav__link">
    <span class="md-ellipsis">
      Page Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unified-buffer-cache" class="md-nav__link">
    <span class="md-ellipsis">
      Unified Buffer Cache
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mass-storage-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Mass-Storage Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mass-Storage Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview-of-mass-storage-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Overview of Mass Storage Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview of Mass Storage Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetic-disks" class="md-nav__link">
    <span class="md-ellipsis">
      Magnetic disks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonvolatile-memory-devices" class="md-nav__link">
    <span class="md-ellipsis">
      Nonvolatile Memory Devices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk" class="md-nav__link">
    <span class="md-ellipsis">
      Disk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Disk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disk-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-attachment" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Attachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-a-disk-page" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing a Disk Page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-management" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Swap-Space Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid-structure" class="md-nav__link">
    <span class="md-ellipsis">
      RAID Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stable-storage-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Stable-Storage Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io-systems" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I/O Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#io-hardware-application" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Hardware Application
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I/O Hardware Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#io-port-registers" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Port Registers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-controling-methods" class="md-nav__link">
    <span class="md-ellipsis">
      I/O controling methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-io-interface-io" class="md-nav__link">
    <span class="md-ellipsis">
      Application I/O Interface 应用程序 I/O 接口
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-devices" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Devices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blocking-and-nonblocking-io" class="md-nav__link">
    <span class="md-ellipsis">
      Blocking and Nonblocking I/O
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-io-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel I/O Interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kernel I/O Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kernel-io-subsystem" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel I/O Subsystem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-subsystem-transforming" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Subsystem Transforming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-requests-to-hardware-operations" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Requests to Hardware Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quiz-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Quiz &amp; LAB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quiz &amp; LAB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quiz" class="md-nav__link">
    <span class="md-ellipsis">
      quiz
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab" class="md-nav__link">
    <span class="md-ellipsis">
      lab
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="operating-system-concepts">操作系统 Operating System Concepts<a class="headerlink" href="#operating-system-concepts" title="Permanent link">&para;</a></h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 24334 个字 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M360.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m64.6 136.1c-12.5 12.5-12.5 32.8 0 45.3l73.4 73.4-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3l-96-96c-12.5-12.5-32.8-12.5-45.3 0zm-274.7 0c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l73.3-73.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg></span> 245 行代码 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 138 张图片 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 84 分钟</p>
</div>
<blockquote>
<p>[!NOTE]</p>
<p>LAB 0-7（5+15+15+15+20+20+10+10 = 110）</p>
<p>考试：40 选择+4 填空+3 问答（schedule+syn+memory）</p>
<p>3 张 A4 纸（可正反打印）</p>
</blockquote>
<h2 id="overview">概述 Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>第一章</p>
<ul>
<li>kernel</li>
<li>中断</li>
<li>同步异步 I/O</li>
<li>设备 status table</li>
<li>storage hierarchy</li>
<li>cache 一致性</li>
<li>os structure: multiprogramming(系统视角 cpu utilization 并发), multitasking(用户角度 time-sharing 现代 os 使用)</li>
<li>os 操作：用户模式、内核模式</li>
<li>进程、内存、储存管理
</li>
</ul>
</blockquote>
<h3 id="_1">操作系统功能&amp;定义<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>从计算机角度，<strong>操作系统</strong> 是个程序，管理电脑硬件</p>
<ul>
<li>resource allocator：分配资源（cpu、内存、I/O 设备——硬件 hardware 提供资源）</li>
<li>control program：防止资源滥用</li>
</ul>
<p><strong>定义</strong>：The operating system is the one program running at all times on the computer——namely kernel
操作系统是一直运行在计算机上的程序——通常称为内核</p>
<p>multi-user OS: Linux ubuntu</p>
<h3 id="_2">计算机系统的运行<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>计算机 = CPU + 多个设备控制器（I/O devices），通过公用总线相连，该总线提供了共享内存的访问</p>
<p>CPU 和 I/O 设备可以并发执行（execute concurrently），并竞争访问内存，需要内存控制器协调访问内存</p>
<p>每个设备控制器 device controller</p>
<ul>
<li>控制特定的设备（磁盘驱动器、音频、视频显示..）</li>
<li>有本地缓冲区（local buffer），存储 I/O</li>
<li>经系统总线 system bus 触发中断 interrupt 告知 CPU 已完成</li>
</ul>
<h4 id="atmic-operation">原语 atmic operation<a class="headerlink" href="#atmic-operation" title="Permanent link">&para;</a></h4>
<p>按层次结构设计的操作系统的底层是原语，一种程序</p>
<ul>
<li>位于操作系统底层，最接近硬件</li>
<li>运行具有原子性，操作一气呵成（不能被打断）</li>
<li>运行时间短，调用频繁</li>
</ul>
<p>定义原语的直接方法是关中断</p>
<h4 id="interrupt">中断 interrupt<a class="headerlink" href="#interrupt" title="Permanent link">&para;</a></h4>
<p>中断是硬件或软件产生的一种信号，用于通知 CPU 需要对某一事件进行处理</p>
<p>ISR 中断服务例程 interrupt service routine</p>
<p>中断向量 interrupt vector：存储中断 <em>例程</em> 的地址 the addresses of all the service routines</p>
<ul>
<li>寄存器（Interrupt architecture）储存被中断 <em>指令</em> 的地址 </li>
</ul>
<p>有中断在处理时会停止其他未到的中断
Incoming interrupts are disabled while another interrupt is being processed to prevent a lost interrupt.</p>
<hr />
<p>外部中断：cpu 外部事件，如 I/O 设备请求、时钟信号</p>
<p>内部中断：cpu 内部事件，如仿管指令、缺页异常</p>
<p>trap ：软件的中断，经常由错误或用户请求（又称 系统调用 system call）导致</p>
<p>fault：通常由指令执行引起的异常，如非法操作码、缺页故障、除数为 0、运算溢出</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>---
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a># 根节点默认文本（若内容存在根节点，则此选项失效）
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a>title: 中断
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a># 配置:
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a>markmap:
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a>  # 是否允许缩放
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a>  zoom: false
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a>  # 是否允许平移
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a>  pan: false
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a>  # 节点最大长度（0则无长度限制）
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a>  maxWidth: 0
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a>  # 节点水平间距
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a>  spacingHorizontal: 30
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a>  # 节点垂直间距
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a>  spacingVertical: 5
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a>  # 节点内部边距
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a>  paddingX: 5
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a>  # 图形的窗口填充率
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a>  fitRatio: 0.75
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a>  # 展开的最大节点级别（-1则展开全部）
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a>  initialExpandLevel: -1
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a>  # 多少级开始固定分支颜色
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a>  colorFreezeLevel: 6
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a>  # 颜色
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a>  color: [&#39;#4E79A7&#39;, &#39;#F28E2C&#39;, &#39;#E15759&#39;, &#39;#76B7B2&#39;, &#39;#59A14F&#39;, &#39;#EDC949&#39;, &#39;#AF7AA1&#39;, &#39;#FF9DA7&#39;, &#39;#9C755F&#39;, &#39;#BAB0AB&#39;]
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a>  # 动画持续时间
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a>  duration: 100
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a>  # 图形高度
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a>  height: 100px
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a>  # 背景色
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31"></a>  backgroundColor: &quot;#f8f8f8&quot;
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32"></a>---
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33"></a>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34"></a>## 内部异常Exception
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a>- 故障（Fault） 软件中断
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a>- 自陷（trap） 软件中断
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a>- 终止（abort） 硬件中断
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a>## 外部中断Interruption（硬件）
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a>- 可屏蔽中断 INTR
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a>- 不可屏蔽中断 NMI
</span></code></pre></div></td></tr></table></div>
<p><strong>操作系统是由中断驱动的 An operating system is interrupt-driven</strong></p>
<p>中断处理——一种软件例程处理</p>
<ol>
<li>恢复 CPU 状态——存寄存器&amp;程序计数器 PC（program counter）
   - 计数器：存储下一条要执行的指令的位置</li>
<li>确定中断类型：通过通用例程或矢量中断系统进行轮询 polling by a generic routine or vectored interrupt system</li>
<li>用户态和内核态的转换：kernel -&gt; user by OS；user &rarr; kernel by 硬件（中断/异常）</li>
</ol>
<p>两种 I/O 处理方式：</p>
<ol>
<li>要等待，处理完传回——同步 synchronous</li>
<li>接收到（没做完）就传回——异步 asynchronous</li>
</ol>
<p><img src="./assets/image-20240911152005368.png" alt="image-20240911152005368" style="zoom:50%;" /></p>
<p>DMA：直接内存访问</p>
<p><img src="./assets/image-20240911152146945.png" alt="image-20240911152146945" style="zoom: 33%;" /></p>
<p>每块只产生一个中断</p>
<h3 id="_3">存储<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><img src="./assets/image-20240911152243818.png" alt="image-20240911152243818" style="zoom:50%;" /></p>
<p>速度、花销、易失性</p>
<p>一级二级三级是按容量分的</p>
<p>高速缓存 cache——更快的数据访问机制，主存可以认为是二级存储的最后一个 cache</p>
<h3 id="_4">计算机体系结构<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p><strong>多处理器</strong> multiprocessing</p>
<ul>
<li>增加吞吐量</li>
<li>规模经济</li>
<li>增加可靠性</li>
</ul>
<p>对称多处理器 SMP symmetric multiprocessing：所有处理器对等、没有主从关系，共享内存</p>
<p>多核 multicore</p>
<ul>
<li>单片通信比芯片间通信快</li>
<li>多核电源消耗低</li>
</ul>
<p>非均匀内存访问 Non-uniform memory access(NUMA architecture)</p>
<ul>
<li>CPU 通过一个共享系统连接</li>
<li>随着处理器的增加而更有效地扩展</li>
<li>跨互连的远程内存速度较慢</li>
<li>操作系统需要仔细的 CPU 调度和内存管理</li>
</ul>
<h3 id="_5">操作系统设计<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p><strong>Multiprogramming 多道程序设计</strong> needed for efficiency (<mark>CPU utilization</mark>)</p>
<ul>
<li>组织各项任务让 CPU 总有工作做</li>
<li>加载多项任务到内存</li>
<li>通过 job scheduling 安排选一个任务做</li>
<li>定义：在一个 cpu 上 <strong>并发</strong> 运行多个进程；多个 cpu，每个 cpu 并发，总体并行</li>
<li>宏观上并行，微观上串行</li>
</ul>
<p><strong>Timesharing (multitasking)</strong> is logical extension in which CPU switches jobs so frequently that users can interact with each job while it is running, creating interactive computing (<mark>interactivity</mark>)</p>
<ul>
<li>响应速度足够快</li>
<li>多任务（进程 process）并发在 CPU 上执行 -&gt; CPU 调度 scheduling</li>
<li>如果一个进程不能全放入内存 memory -&gt; 换入换出 swapping（将没用的进程挪出）</li>
<li>虚存 virtual memory：一种技术允许 CPU 执行不完全在内存的进程</li>
</ul>
<blockquote>
<p>[!NOTE]</p>
<p>并行和并发的区别？</p>
<ul>
<li>并行：多个事件在同一时刻发生</li>
<li>并发：多个事件在同一时间间隔发生</li>
</ul>
</blockquote>
<h3 id="os-operations">操作系统执行 OS operations<a class="headerlink" href="#os-operations" title="Permanent link">&para;</a></h3>
<p><strong>双模式 dual-mode</strong> 操作允许操作系统保护自身和其他系统组件</p>
<ul>
<li>用户模式和内核模式 user mode &amp; kernel mode</li>
<li>硬件提供的模式位 mode bit</li>
<li>提供区分系统何时运行用户代码或内核代码的能力</li>
<li>一些指令被指定为特权指令 privileged，只能在内核模式下执行（不允许用户直接使用）</li>
<li>系统调用 system call 将模式更改为 kernel 模式，再通过系统调用回来将其重置为 user 模式</li>
</ul>
<p><img alt="image-20240914104446706" src="assets/image-20240914104446706.png" /></p>
<p><strong>Timer 定时器</strong>：防止无限循环/进程占用资源</p>
<ul>
<li>在一段时间后中断进程 set interrupt</li>
<li>操作系统将计数器 counter <code>-1</code>，<strong>到 0 产生中断</strong></li>
<li>在安排流程之前进行设置，以重新获得控制权或终止超过分配时间的程序</li>
</ul>
<h4 id="process-management">Process management 进程管理<a class="headerlink" href="#process-management" title="Permanent link">&para;</a></h4>
<p>程序是被动实体，进程是主动实体 active entity</p>
<ul>
<li>需要资源去执行</li>
<li>进程终止时将资源还给操作系统</li>
<li><strong>多线程进程 Multi-threaded process</strong> 每个线程都有一个计数器</li>
<li><strong>多路复用 multiplexing</strong>-&gt; 实现并发 concurrency</li>
</ul>
<p><img src="./assets/image-20240914111333126.png" alt="image-20240914111333126" style="zoom:50%;" /></p>
<h4 id="memory-management">Memory management 内存管理<a class="headerlink" href="#memory-management" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20240914110859245.png" style="zoom:50%;" /></p>
<h4 id="file-management">File management 文件管理<a class="headerlink" href="#file-management" title="Permanent link">&para;</a></h4>
<p>文件管理：创建、删除、加密</p>
<p><img src="./assets/image-20240914111350634.png" alt="image-20240914111350634" style="zoom:50%;" /></p>
<p>管道 pipe 是一种文件</p>
<h4 id="storage-management">Storage management 存储管理<a class="headerlink" href="#storage-management" title="Permanent link">&para;</a></h4>
<p>Mass-Storage Management</p>
<p><img src="./assets/image-20240914111610391.png" alt="image-20240914111610391" style="zoom:40%;" /></p>
<p>I/O Subsystem 子系统</p>
<p><img src="./assets/image-20240914112031690.png" alt="image-20240914112031690" style="zoom: 40%;" /></p>
<h3 id="os-purposes">总结 OS purposes<a class="headerlink" href="#os-purposes" title="Permanent link">&para;</a></h3>
<ul>
<li>Abstraction 抽象： a way to hide complexity</li>
<li>Multiplex 多路复用（空间、时间）</li>
<li>Isolation 隔离（用户/核模式）</li>
<li>Sharing 共享（用户、进程 资源共享-&gt; 并发）</li>
<li>Security 安全（特权指令</li>
<li>Performance 性能</li>
<li>Range of uses</li>
</ul>
<h2 id="operating-system-structures">结构 Operating-System Structures<a class="headerlink" href="#operating-system-structures" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>第二章</p>
<ul>
<li>os 服务</li>
<li>系统调用 system call：api</li>
<li>os design &amp; implementation</li>
<li>os structures</li>
<li>layed</li>
<li>monolithic</li>
<li>microkernel 微内核 优缺点(overhead)
</li>
</ul>
</blockquote>
<h3 id="_6">操作系统服务<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>操作系统提供的服务有：</p>
<ul>
<li>UI(user interface)</li>
<li>CLI(command line)</li>
<li>
<p>优点：对重复性工作高效</p>
</li>
<li>
<p>GUI (Graphics User Interface)</p>
</li>
</ul>
<h3 id="system-call">System call 系统调用<a class="headerlink" href="#system-call" title="Permanent link">&para;</a></h3>
<h4 id="_7">系统调用实现<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<p>API（Application program interface)：被封装过 high-level 的系统调用</p>
<ul>
<li>Mostly accessed by programs via a high-level API rather than direct system call use 主要通过高级的 API 接触程序而不是直接的系统调用</li>
</ul>
<p>每个系统调用有个编号，通过系统调用表 table</p>
<p>系统调用发生时，程序控制权将交给内核来完成服务，服务完成后，控制权再还给程序（回到用户状态</p>
<p>系统调用是用户应用（软件）和硬件之间沟通的桥梁——保证了安全和有效的沟通 secure &amp; efficient</p>
<blockquote>
<p>系统调用是 OS 提供给用户的，只能通过用户程序间接使用</p>
<p>系统调用的目的是——请求系统服务</p>
</blockquote>
<h4 id="_8">参数传递<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>保存当前 cpu 的 PSW 和 PC</p>
<p>最简单：寄存器保存</p>
<p>间接方式：block、table、memory，把内存中 buffer 地址告诉寄存器（Linux &amp; Solaris）</p>
<p>其他：栈 stack，不一定支持多用户</p>
<ul>
<li>block 和 stack 方法不限制参数的数量或长度</li>
</ul>
<h4 id="_9">系统调用分类/功能<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>Process control 进程管理
File management 文件管理
Device management 设备管理
Information maintenance (e.g. time, date) 信息维护（内存管理）
Communications 交流
Protection 保护</p>
<p><img src="./assets/image-20240918150058573.png" alt="image-20240918150058573" style="zoom:50%;" /></p>
<h3 id="_10">系统程序<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>分类：File manipulation、Status information、File modification、Programming language support、Program loading and execution、Communications、Application programs</p>
<p>.....debuggers</p>
<p>不是系统程序：web browsers、word processors（用户程序）</p>
<h3 id="os">os 设计和实现<a class="headerlink" href="#os" title="Permanent link">&para;</a></h3>
<p>os 设计和实现不是一个解决问题的过程（不是具体的问题而是创造性过程）</p>
<p>1.由目标和指标出发：用户目标、系统目标</p>
<p>2.被硬件和系统类型影响</p>
<p><strong>Policy</strong>:   What to do? 策略（确定具体做什么事，eg 允许某些用户访问某些文件）
<strong>Mechanism</strong>:  How to do it? 机制（定义做事方式）</p>
<p>内存管理、cpu 调度是机制？（算法是机制？</p>
<p>配置文件写的是策略（policy）</p>
<p><mark>Provide mechanism rather than policy</mark>. In particular, place user interface policy in the clients' hands. </p>
<p>操作系统基本类型（3）：批处理、分时、实时</p>
<h3 id="_11">操作系统结构<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<h4 id="simple-structure">Simple Structure<a class="headerlink" href="#simple-structure" title="Permanent link">&para;</a></h4>
<p>MS-DOS: provide the most functionality in the least space</p>
<ul>
<li>不分模块，界面和多级功能间没有很好的分开</li>
</ul>
<h4 id="unix">UNIX<a class="headerlink" href="#unix" title="Permanent link">&para;</a></h4>
<p>UNIX – 受硬件功能限制，原始 UNIX 操作系统结构有限。UNIX 操作系统由两个可分离的部分组成</p>
<ul>
<li>系统程序</li>
<li>内核</li>
<li>包括系统调用接口以下和物理硬件以上的所有内容</li>
<li>提供文件系统、CPU 调度、内存管理和其他操作系统功能；一个级别的大量功能</li>
</ul>
<h4 id="monolithic-system-structure">Monolithic System Structure 宏内核架构<a class="headerlink" href="#monolithic-system-structure" title="Permanent link">&para;</a></h4>
<ul>
<li>将系统的主要功能模态作为一个整体运行在内核</li>
<li>主流操作系统都采用宏内核，如 Windows、Android、iOS、macos、Linux</li>
</ul>
<p><strong>UNIX System Structure</strong> 宏内核</p>
<p><img src="./assets/image-20240918154609215.png" alt="image-20240918154609215" style="zoom:50%;" /></p>
<h4 id="microkernel-system-structure">Microkernel System Structure 微内核<a class="headerlink" href="#microkernel-system-structure" title="Permanent link">&para;</a></h4>
<p>对应宏内核</p>
<p>将尽可能多的内容从内核移至“用户”空间，提供一小部分服务，例如进程调度</p>
<p>用户模块之间使用消息传递进行通信 message passing</p>
<ul>
<li>基于客户/服务器模式（C/S）</li>
<li>采用“机制与策略分离”原理</li>
<li>采用面向对象技术</li>
</ul>
<p>优点：</p>
<ul>
<li>更易于扩展 extend 微内核</li>
<li>更易于将操作系统移植 port 到新架构（flexibility）</li>
<li>更可靠（内核模式下运行的代码更少）、安全</li>
<li>分布式计算</li>
</ul>
<p>缺点：</p>
<ul>
<li>用户空间与内核空间通信的性能开销大，性能差 performance（宏内核更高效）</li>
<li>系统服务、驱动程序的复杂性</li>
<li>上下文切换不太有效</li>
</ul>
<h4 id="hybrid-structuredarwin">Hybrid Structure——Darwin<a class="headerlink" href="#hybrid-structuredarwin" title="Permanent link">&para;</a></h4>
<p>混合模式：By ??</p>
<p>Windows, MacOS, iOS——混合内核</p>
<h4 id="layered-approach">Layered Approach 分层方法<a class="headerlink" href="#layered-approach" title="Permanent link">&para;</a></h4>
<p>操作系统分为多个层（级别），每层都建立在较低层之上。</p>
<p><strong>最底层（第 0 层）是硬件；最高层（第 N 层）是用户界面</strong>。</p>
<p>通过模块化 modularity ，可以选择各层，以便每层仅使用较低层的功能（操作）和服务</p>
<p>逻辑分层：</p>
<p><img src="./assets/image-20240923104411850.png" alt="image-20240923104411850" style="zoom: 33%;" /></p>
<p>逐层调用（不能跨层调用）、逐层封装——层之间通讯的效率问题</p>
<p>优点：便于系统调试和验证；易扩充、易维护</p>
<p>缺点：require more overhead for iter-layer communication 效率低；合理定义各层比较困难</p>
<h4 id="modules">Modules 模块化<a class="headerlink" href="#modules" title="Permanent link">&para;</a></h4>
<p>和分层相似但更灵活、可拓展性 scal，但有模块兼容性问题</p>
<ul>
<li>使用目标导向的方法</li>
<li>每个模块再需要时可以加载到内核中（loadable）</li>
<li>每个模块核心组件隔离</li>
<li>模块相互调用（通过已知的接口）而不是消息传递</li>
</ul>
<p>LKMs(loadable kernel modules): extend the functionality of the kernel dynamically</p>
<p>优点：提高了操作系统设计的正确性、可理解性、可维护性；增强操作系统的可适应性；加速开发</p>
<p>缺点：模块间接口规定很难满足对接口的实际需求；无法找到一共可靠的决定顺序</p>
<h4 id="other-structures">Other Structures<a class="headerlink" href="#other-structures" title="Permanent link">&para;</a></h4>
<p><strong>Exokernel 外核</strong> (1994)：高度简化 kernel，只负责资源分配，提供了低级的硬件操作，必须通过定制 library 供应用使用</p>
<ul>
<li>高性能，但定制化 library 难度大，兼容性差</li>
</ul>
<p>Unikernel: statically linked with the OS code needed.Good for cloud service, APP boots in tens of ms.</p>
<h3 id="virtual-machines">虚拟机 Virtual Machines<a class="headerlink" href="#virtual-machines" title="Permanent link">&para;</a></h3>
<p>A virtual machine takes the layered approach to its logical conclusion.  It treats <em>hardware and the operating system kernel</em> as though they were all <strong>hardware</strong> 虚拟机将硬件和操作系统内核都看作硬件</p>
<p>A virtual machine provides an interface identical to the underlying bare hardware</p>
<p>The operating system creates the illusion of multiple processes, each executing on its own processor with its own (virtual) memory</p>
<h4 id="_12">分类<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<p>第一类 VMM 直接运行在硬盘上，最高级（内核态）</p>
<p>第二类 VMM 运行在宿主操作系统上，普通程序（用户态）</p>
<h4 id="hypervisor">HyperVisor<a class="headerlink" href="#hypervisor" title="Permanent link">&para;</a></h4>
<p>TYPE1 Bare-Metal 裸金属 architecture</p>
<ul>
<li>更高的性能、和硬件直接接触、安全性更高</li>
</ul>
<p>TYPE2 Hosted 宿主 需要 hostOS，eg VMware、Oracle</p>
<ul>
<li>应用简单、和现有 OS 兼容性高、适合测试和开发环境</li>
</ul>
<p>选 2 不选 1 的常见原因：easier integration with existing host OS</p>
<p><img src="./assets/image-20240923111559930.png" alt="image-20240923111559930" style="zoom:50%;" /></p>
<p>三种技术：</p>
<p>VM：更好的隔离性、灵活性，有资源消耗（复杂）的问题</p>
<p>LC：更加轻量级，不需要加载内核 os（docker）</p>
<p>Uk：所有东西都打包，只能允许一个 app 运行</p>
<h3 id="os_1">OS 生成<a class="headerlink" href="#os_1" title="Permanent link">&para;</a></h3>
<p>操作系统初始化时需要创建 <strong>中断向量表</strong></p>
<h3 id="system-boot">系统启动 System Boot<a class="headerlink" href="#system-boot" title="Permanent link">&para;</a></h3>
<p>引导程序 bootstrap program 在开机 power-up/reboot 时</p>
<ol>
<li>加载到 ROM/EPROM 上（Read-only Memory 是 firmware 固件）</li>
<li>初始化系统</li>
<li>bootstrap 定位操作系统内核并加载到内存、开始执行</li>
<li>OS 最终被加载到 RAM</li>
</ol>
<ul>
<li>操作系统的引导程序位于硬盘中</li>
<li>引导扇区产生在对硬盘进行高级格式化时</li>
</ul>
<h2 id="processes">进程 Processes<a class="headerlink" href="#processes" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>第三章</p>
<ul>
<li>进程状态 status</li>
<li>进程控制块 PCB</li>
<li>上下文切换</li>
<li>进程调度（job queue: 所有 process, ready queue: 为 cpu 服务, device queue）</li>
<li>生产者-消费者模型</li>
<li>unbounded buffer, bounded buffer（有限 buffer size）</li>
</ul>
</blockquote>
<h3 id="_13">进程概念<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>An operating system executes a variety of programs:</p>
<ul>
<li>Batch system – a batch is a sequence of jobs</li>
<li>Time-sharing systems – user programs or tasks</li>
<li>Multitasking</li>
<li>Less turnaround, less CPU idle, user interaction</li>
</ul>
<blockquote>
<p>[!NOTE]</p>
<p>Textbook uses the terms <em>job</em> and <em>process</em> almost interchangeably</p>
</blockquote>
<h4 id="_14">定义<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p>进程是运行中的程序，按照指令流顺序进行</p>
<p>一个进程包含</p>
<ul>
<li>text section (code)</li>
<li>data section (global vars)</li>
<li>stack (function parameters, local vars, return addresses)</li>
<li>heap (dynamically allocated memory)</li>
<li>program counter </li>
</ul>
<p><img src="./assets/image-20240923112853058.png" alt="image-20240923112853058" style="zoom:33%;" /> stack 和 heap 相对而生：灵活应用内存空间</p>
<p>进程是一个独立的运行单位，也是操作系统进行资源分配和调度的基本单位</p>
<h4 id="process-state">Process state<a class="headerlink" href="#process-state" title="Permanent link">&para;</a></h4>
<p>进程状态</p>
<p><img src="./assets/image-20240923113548425.png" alt="image-20240923113548425" style="zoom: 33%;" /></p>
<ul>
<li><strong>new 创建态</strong>：正在被创建中</li>
<li>
<p>创建新进程的操作原语</p>
<ul>
<li>申请一个空白 PCB，填写用于控制和管理进程的信息</li>
<li>分配运行所需资源</li>
<li>初始化 PCB</li>
<li>转入就绪态并插入就绪队列</li>
</ul>
</li>
<li>
<p><strong>running 运行态</strong></p>
</li>
<li><strong>ready 就绪态</strong>：等待被分配一个处理器 processor（CPU）已经被加载进内存 memory</li>
<li><strong>waiting/block 阻塞态</strong>：等待某个资源可用（不包括 CPU）或者等待 I/O 完成</li>
<li>
<p>阻塞原语 Block 执行过程</p>
<ul>
<li>找到被阻塞进程的标识号 PID 对应的 PCB</li>
<li>若该进程为运行态，则保护其线程，将其状态转为阻塞态，停止运行</li>
<li>将该 PCB 插入相应事件的等待队列，将 CPU 调度给其他进程</li>
</ul>
</li>
<li>
<p><strong>terminated 终止态</strong>：结束进程</p>
</li>
<li>终止进程的操作<ul>
<li>根据被终止进程的标识符，检索出该进程的 PCB，从中读出该进程的状态。</li>
<li>若被终止进程处于运行状态，立即终止该进程的执行，将 CPU 资源分配给其他进程。</li>
<li>若该进程还有子孙进程，则通常需将其所有子孙进程终止（有些 OS 无此操作）</li>
<li>将该进程所拥有的全部资源，或归还给其父进程，或归还给操作系统</li>
<li>将该 PCB 从所在队列(链表)中删除</li>
</ul>
</li>
</ul>
<hr />
<ul>
<li>
<p>进程唤醒 wakeup 原语</p>
</li>
<li>
<p>在该事件队列中找到相应进程的 PCB</p>
</li>
<li>
<p>将其从等待队列中移出，并设置状态为就绪态</p>
</li>
<li>
<p>将该 PCB 插入就绪队列，等待调度程序调度</p>
</li>
</ul>
<h4 id="process-control-blockpcb">Process control block(PCB)<a class="headerlink" href="#process-control-blockpcb" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>OS 数据结构，用来跟踪进程和相关资源</p>
</li>
<li>
<p>PCB 包含：进程状态、PC、寄存器值、CPU 调度、内存管理信息、accounting 信息、I/O 信息</p>
</li>
<li>Process ID 是进程的独特编号</li>
<li>PCB 中的 PC 是记录程序目前正在运行的位置</li>
</ul>
<p><img src="./assets/image-20240925150055065.png" alt="image-20240925150055065" style="zoom: 33%;" /></p>
<p><a href="# Context Switch 上下文切换">Context Switch 上下文切换</a> 的 overhead</p>
<blockquote>
<p>分配设备不需要创建新进程</p>
<p>用户登录成功、启动程序执行需要创建新进程</p>
</blockquote>
<h3 id="scheduling">进程调度 scheduling<a class="headerlink" href="#scheduling" title="Permanent link">&para;</a></h3>
<h4 id="process-scheduling-queues">Process Scheduling Queues<a class="headerlink" href="#process-scheduling-queues" title="Permanent link">&para;</a></h4>
<p>CPU Switch From Process to Process</p>
<p><strong>Job queue</strong> – set of all processes in the system（包括 ready 和正在执行的</p>
<p><strong>Ready queue</strong> – set of all processes residing in <em>main memory</em>, ready and waiting to execute（等待 CPU</p>
<p><strong>Device queues</strong> – set of processes waiting for an I/O device 有很多设备（申请使用 device——通过系统调用</p>
<p>Processes migrate among the various queues</p>
<blockquote>
<p>[!IMPORTANT]</p>
<p>一个 PCB 能不能在两个队列（device&amp;ready）里同时排队？</p>
<ul>
<li>不可能</li>
</ul>
</blockquote>
<p><img src="./assets/image-20240925152502875.png" alt="image-20240925152502875" style="zoom: 33%;" /></p>
<blockquote>
<p>[!NOTE]</p>
<p>我们是把 PCB 放到进程队列里；</p>
<p>CPU 有四个核可以有 4 个队列，也可以只有 1 个队列</p>
</blockquote>
<h4 id="schedulers">Schedulers 调度器<a class="headerlink" href="#schedulers" title="Permanent link">&para;</a></h4>
<p><mark>调度器是程序的一部分，A scheduler is a piece of program</mark></p>
<p><strong>Long-term scheduler</strong>  (or job scheduler) – selects which processes should be brought into memory (the ready queue) </p>
<p>长期调度控制多道程序设计(并发) degree of multiprogramming</p>
<p><strong>Short-term scheduler</strong>  (or CPU scheduler) – selects which process should be executed next and allocates CPU</p>
<ul>
<li>The long-term scheduler is invoked very infrequently (seconds, minutes) =&gt; (may be slow)</li>
<li>The short-term scheduler is invoked very frequently (milliseconds) =&gt; (must be fast)</li>
</ul>
<p><strong>Medium Term Scheduling</strong>：进程在内存和磁盘间交换 swap in and out</p>
<blockquote>
<p>[!WARNING]</p>
<p>UNIX and Windows do not use long-term scheduling</p>
</blockquote>
<p>交换运行程序到磁盘（....？</p>
<p><img src="./assets/image-20240925153235578.png" alt="image-20240925153235578" style="zoom:33%;" /></p>
<p>Processes can be described as either:</p>
<ul>
<li>
<p><strong>I/O-bound process</strong> I/O 绑定进程 – spends more time doing I/O than computations, many short CPU bursts，eg：下载</p>
</li>
<li>
<p><strong>CPU-bound process</strong> CPU 绑定进程 – spends more time doing computations; few very long CPU bursts，eg：科学计算</p>
</li>
</ul>
<h4 id="context-switch">Context Switch 上下文切换<a class="headerlink" href="#context-switch" title="Permanent link">&para;</a></h4>
<p>当 CPU 切换到另一个进程时，系统必须保存旧进程的状态，并为新进程加载保存的状态</p>
<p>上下文切换的流程如下：
1）挂起一个进程，将 CPU 上下文保存到 PCB ，包括程序计数器和其他寄存器。
2）将进程的 PCB 移入相应的队列，如就绪、在某事件阻塞等队列。
3）选择另一个进程执行，并更新其 PCB 。
4）恢复新进程的 CPU 上下文。
5）跳转到新进程 PCB 中的程序计数器所指向的位置执行。</p>
<p>上下文切换的消耗：</p>
<p>上下文切换通常是计算密集型的，即它需要相当可观的 CPU 时间，在每秒几十上百次的切换中，每次切换都需要纳秒量级的时间，所以上下文切换对系统来说意味着消耗大量的 CPU 时间。</p>
<p>时间取决于硬件支持；在 SPARC 架构中，提供了寄存器组</p>
<ul>
<li>上下文切换时 PCB 不必记录进程优先级，优先级是内核 kernel 判断的</li>
<li>上下文切换只能发生在内核态</li>
<li>进程上下文采用进程 PCB 表示，包括 CPU 寄存器的值、进程状态和内存管理信息等。</li>
</ul>
<blockquote>
<p>[!NOTE]</p>
<p>调度是决策行为，切换是执行行为</p>
<p>先有资源调度，再有进程切换</p>
</blockquote>
<h3 id="_15">进程操作<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<h4 id="process-creation">Process Creation<a class="headerlink" href="#process-creation" title="Permanent link">&para;</a></h4>
<p>父进程创造子进程 fork</p>
<ul>
<li>
<p>Resource sharing</p>
</li>
<li>
<p>Parent and children share all resources</p>
</li>
<li>
<p>Children share subset of parent’s resources</p>
</li>
<li>
<p>Parent and child share no resources</p>
</li>
<li>
<p>Execution</p>
</li>
<li>
<p>Parent and children execute concurrently</p>
</li>
<li>Parent waits until children terminate</li>
<li>Address space</li>
<li>Child duplicate of parent</li>
<li>
<p>Child <em>has a program loaded into it</em></p>
</li>
<li>
<p>UNIX examples</p>
</li>
<li><strong>fork</strong> system call creates new process</li>
<li><strong>exec</strong> system call used after a fork to replace the process's memory space with a new program</li>
</ul>
<blockquote>
<p>父进程和子进程可以并发执行</p>
<p>父进程和子进程有各自的空间，不共享虚拟地址</p>
<p>父进程和子进程有不同的进程控制块（PCB）-&gt; 隔离</p>
<p>父进程和子进程不能同时使用</p>
</blockquote>
<p><img src="./assets/image-20240930103721294.png" alt="image-20240930103721294" style="zoom:30%;" /></p>
<blockquote>
<p>[!NOTE]</p>
<p>子进程可以 <strong>继承</strong> 父进程的内容；
需要重置 pid，cpu time，优先级，堆栈</p>
<p>list of open files？？</p>
</blockquote>
<p>OS 不是真的 copy，显式 copy</p>
<blockquote>
<p>[!CAUTION]</p>
<p>创造进程的新线程不是通过 fork</p>
</blockquote>
<h4 id="process-termination">Process Termination<a class="headerlink" href="#process-termination" title="Permanent link">&para;</a></h4>
<h3 id="cooperating">共同协作 cooperating<a class="headerlink" href="#cooperating" title="Permanent link">&para;</a></h3>
<h4 id="cooperating-processes">Cooperating Processes<a class="headerlink" href="#cooperating-processes" title="Permanent link">&para;</a></h4>
<p><strong>Independent</strong> process 独立进程 cannot affect or be affected by the execution of another process</p>
<p><strong>Cooperating</strong> process can affect or be affected by the execution of another process</p>
<p><em>Advantages</em> of process cooperation:</p>
<ul>
<li>Information sharing</li>
<li>Computation speed-up (Multiple CPUs)</li>
<li>Modularity</li>
<li>Convenience</li>
</ul>
<h4 id="producer-consumer">Producer-consumer<a class="headerlink" href="#producer-consumer" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20240930110501365.png" alt="image-20240930110501365" style="zoom: 50%;" /></p>
<p>主要目的是 解决 生产者线程和消费者线程之间进行数据的 <strong>同步</strong> 操作</p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">//Shared data</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="cp">#define BUFFER_SIZE 10</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">.</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="p">}</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="n">item</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="kt">int</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="kt">int</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="c1">//Bounded-Buffer – Insert() Method</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="c1">//Producer pseudo-code:</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">    </span><span class="n">Produce</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(((</span><span class="n">in</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">BUFFER_SIZE</span><span class="w">   </span><span class="o">==</span><span class="w"> </span><span class="n">out</span><span class="p">);</span><span class="w"> </span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">           </span><span class="cm">/* do nothing -- no free buffers */</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">    </span><span class="n">buffer</span><span class="p">[</span><span class="n">in</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="w">    </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">BUFFER_SIZE</span><span class="p">;</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="p">}</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20"></a>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="c1">//Bounded Buffer – Remove() Method</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="c1">//Consumer pseudo-code:</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">out</span><span class="p">);</span><span class="w"> </span><span class="c1">//do nothing, nothing to consume</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25"></a>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="w">    </span><span class="n">Remove</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="w">    </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">out</span><span class="p">];</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">out</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">BUFFER</span><span class="w"> </span><span class="n">SIZE</span><span class="p">;</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<blockquote>
<p>How many items？</p>
<ul>
<li>(in-out) % BUFFER_SIZE</li>
<li>或者加一个变量 count</li>
</ul>
</blockquote>
<h3 id="_16">进程间通信<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<h4 id="interprocess-communication-ipc">Interprocess Communication (IPC)<a class="headerlink" href="#interprocess-communication-ipc" title="Permanent link">&para;</a></h4>
<p>Two models for IPC: <strong>message passing</strong> 消息队列 and <strong>shared memory</strong> 共享内存（文件）</p>
<p>通信模型：</p>
<p><img src="./assets/image-20240930111506403.png" alt="image-20240930111506403" style="zoom: 33%;" /></p>
<p>共享内存的主要优点：数据一致性</p>
<p>In IPC, minimize shared resources can reduce conflicts</p>
<h4 id="direct-communication">Direct Communication<a class="headerlink" href="#direct-communication" title="Permanent link">&para;</a></h4>
<p>explictly 显式的</p>
<p>A link is associated with exactly one pair of communicating processes</p>
<p>Between each pair there exists exactly one link</p>
<h4 id="indirect-communication">Indirect Communication<a class="headerlink" href="#indirect-communication" title="Permanent link">&para;</a></h4>
<p>mailbox(ports)——both synchronous and asynchronous communication</p>
<p>A link may be associated with many processes</p>
<p>Each pair of processes may share several communication links</p>
<h4 id="synchronization">Synchronization 同步性<a class="headerlink" href="#synchronization" title="Permanent link">&para;</a></h4>
<p>send 是一个系统调用</p>
<p><strong>Blocking</strong> is considered <strong>synchronous</strong></p>
<ul>
<li>Blocking send has the sender blocked until the message is received</li>
<li>Blocking receive has the receiver block until a message is available</li>
</ul>
<p><strong>Non-blocking</strong> is considered <strong>asynchronous</strong></p>
<ul>
<li>Non-blocking send has the sender send the message and continue</li>
<li>Non-blocking receive has the receiver receive a valid message or null</li>
</ul>
<h3 id="communication-in-client-server-systems">Communication in Client-Server Systems<a class="headerlink" href="#communication-in-client-server-systems" title="Permanent link">&para;</a></h3>
<h4 id="sockets">Sockets<a class="headerlink" href="#sockets" title="Permanent link">&para;</a></h4>
<h2 id="threads">线程 Threads<a class="headerlink" href="#threads" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>第四章</p>
<ul>
<li>线程概念</li>
<li>线程资源：私有数据（寄存器和栈）</li>
<li>用户、内核线程</li>
<li>multi-threading models 线程模型 3 种</li>
</ul>
</blockquote>
<h3 id="overview_1">Overview<a class="headerlink" href="#overview_1" title="Permanent link">&para;</a></h3>
<p>程序内部隔离和调度</p>
<h4 id="single-and-multithreaded-processes">Single and Multithreaded Processes<a class="headerlink" href="#single-and-multithreaded-processes" title="Permanent link">&para;</a></h4>
<h6 id="_17"><img src="../images/image-20241009150251297.png" alt="image-20241009150251297" style="zoom: 33%;" /><a class="headerlink" href="#_17" title="Permanent link">&para;</a></h6>
<p>CPU 调度 schedule/dispatch 的最小（基本）单位：线程 thread</p>
<p>资源分配 allocate 的最小（基本）单位：进程 process</p>
<h5 id="_18">进程和线程的区别<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h5>
<p><img src="./assets/cb8c649311628903e2240ebd3e73873.jpg" alt="cb8c649311628903e2240ebd3e73873" style="zoom:50%;" /></p>
<p>线程可以在多个 CPU 上执行</p>
<p>同一进程的线程共享地址空间和资源</p>
<p>线程可以提高系统并发性</p>
<h4 id="benfits">Benfits<a class="headerlink" href="#benfits" title="Permanent link">&para;</a></h4>
<p>Responsiveness：interactive applications</p>
<p>Resource Sharing：memory for code and data can be shared.</p>
<p>Economy：creating processes are more expensive.</p>
<p>Utilization of MP Architectures 多处理器架构：multi-threading increases concurrency 可拓展性</p>
<h4 id="user-level-threadsult">User Level Threads(ULT)<a class="headerlink" href="#user-level-threadsult" title="Permanent link">&para;</a></h4>
<p>Thread management done by user-level threads library</p>
<p>Three primary thread libraries: </p>
<ul>
<li>UNIX: POSIX Pthreads (can also be provided as system library) </li>
<li>Windows: Windows API (Java)</li>
</ul>
<p>一个用户级线程只能映射到一个内核级线程</p>
<p>对于用户级线程，内核并不知情</p>
<blockquote>
<p>用户级线程间的切换比内核级切换效率高</p>
<p>用户级线程可以在不支持内核级线程的操作系统上实现</p>
<p>用户级线程的切换通过 <strong>线程库</strong>，不需要内核的支持，即线程库为用户级线程建立一个线程控制块</p>
</blockquote>
<h4 id="kernel-level-threadsklt">Kernel Level Threads(KLT)<a class="headerlink" href="#kernel-level-threadsklt" title="Permanent link">&para;</a></h4>
<p>Almost all contemporary OS implements kernel threads.</p>
<p>Kernel level threads：支持调度，便于线程切换，避免阻塞；执行的载体</p>
<p>User level threads：；逻辑的载体</p>
<p>内核级线程所需要的资源是以进程为单位申请的</p>
<blockquote>
<p>内核级（系统级）线程的调度由操作系统完成</p>
<p>[!NOTE]</p>
<p>多线程的特长：提高并发性，例如矩阵乘法、web 服务器响应 HTTP</p>
<p>多线程不共享栈指针</p>
<p>同一进程中的各个线程有相同的地址单位</p>
</blockquote>
<h3 id="multithreading-models">Multithreading Models<a class="headerlink" href="#multithreading-models" title="Permanent link">&para;</a></h3>
<h4 id="many-to-one-model">Many-to-one Model<a class="headerlink" href="#many-to-one-model" title="Permanent link">&para;</a></h4>
<p>多对一模型</p>
<p>一个用户级线程卡住了，整个进程就卡住了</p>
<p>thread management is efficient, but will block if making system call, kernel can schedule only one thread at a time</p>
<p>线程管理是高效的，但如果进行系统调用会阻塞，内核一次只能调度一个线程</p>
<p><img src="./assets/image-20241009152351978.png" alt="image-20241009152351978" style="zoom:30%;" /></p>
<blockquote>
<p>Q：某个分时系统采用 <strong>多对一</strong> 线程模型。内存中有 10 个进程并发运行，其中 9 个进程中只有一个线程，另外一个进程 A 拥有 11 个线程。则 A 获得的 CPU 时间占总时间的 1/10</p>
</blockquote>
<h4 id="one-to-one">One-to-one<a class="headerlink" href="#one-to-one" title="Permanent link">&para;</a></h4>
<p>Each user-level thread maps to kernel thread</p>
<p>more concurrency, but creating thread is expensive</p>
<p>能让线程并行，每个用户级线程都有一个内核级线程</p>
<blockquote>
<p>Q：某个分时系统采用 <strong>一对一</strong> 线程模型。内存中有 10 个进程并发运行，其中 9 个进程中只有一个线程，另外一个进程 A 拥有 11 个线程。则 A 获得的 CPU 时间占总时间的 11/20</p>
</blockquote>
<h4 id="many-to-many-model">Many-to-Many Model<a class="headerlink" href="#many-to-many-model" title="Permanent link">&para;</a></h4>
<p>flexible，LWP ID kernel 根据情况看调度</p>
<p>Allows many user level threads to be mapped to many kernel threads</p>
<p>Allows the operating system to create a sufficient number of kernel threads</p>
<h4 id="two-level-model">Two-level Model<a class="headerlink" href="#two-level-model" title="Permanent link">&para;</a></h4>
<p>Similar to M: M, except that it allows a user thread to be bound to kernel thread</p>
<h3 id="threading-issues">Threading Issues<a class="headerlink" href="#threading-issues" title="Permanent link">&para;</a></h3>
<p>Semantics 语义 of <code>fork()</code> and <code>exec(）</code></p>
<blockquote>
<p>Does fork() duplicate only the calling thread or all threads?</p>
<ul>
<li>
<p>Some unix systems have two versions of fork(), one that <strong>duplicates all threads</strong> and another that <strong>duplicates the thread</strong> that invokes fork().</p>
</li>
<li>
<p>Exec() will replace the entire process.</p>
</li>
</ul>
</blockquote>
<h4 id="thread-cancellation">Thread Cancellation<a class="headerlink" href="#thread-cancellation" title="Permanent link">&para;</a></h4>
<p><strong>Asynchronous cancellation</strong> 异步 terminates the target thread  immediately</p>
<p><strong>Deferred cancellation</strong> 延后 allows the target thread to periodically check via a flag if it should be cancelled</p>
<h4 id="signal-handling">Signal Handling<a class="headerlink" href="#signal-handling" title="Permanent link">&para;</a></h4>
<p>A <strong>signal handler</strong> is used to process signals, either synchronous or asynchronous:</p>
<ul>
<li>Signal is generated by particular event</li>
<li>Signal is delivered to a process</li>
<li>Signal is handled</li>
</ul>
<h4 id="thread-pools">Thread Pools 线程池<a class="headerlink" href="#thread-pools" title="Permanent link">&para;</a></h4>
<p>Create a number of threads in a pool where they await work</p>
<p>Advantages</p>
<ul>
<li>Usually slightly faster to service a request with an existing thread than create a new thread</li>
<li>Allows the number of threads in the application(s) to be bound to the size of the pool</li>
</ul>
<p><strong>Thread-Local Storage（TLS）</strong>：Allows each thread to have its own copy of data</p>
<h4 id="scheduler-activations">Scheduler Activations 调度激活<a class="headerlink" href="#scheduler-activations" title="Permanent link">&para;</a></h4>
<p>LWP is a virtual processor attached to kernel thread</p>
<p>Scheduler activations provide <strong>upcalls</strong> - a communication mechanism from the kernel to the thread library</p>
<p>Upcalls are handled by the thread library with an <strong>upcall handler</strong>.</p>
<p>This communication allows an application to maintain the correct number of kernel threads</p>
<p>When an application thread is about to block, an upcall is triggered. </p>
<h2 id="cpu-scheduling">调度 CPU Scheduling<a class="headerlink" href="#cpu-scheduling" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>第五章</p>
<ul>
<li>调度标准 5 个</li>
<li>抢占、非抢占</li>
<li>调度算法 6 个</li>
</ul>
</blockquote>
<h3 id="basic-concepts">Basic concepts<a class="headerlink" href="#basic-concepts" title="Permanent link">&para;</a></h3>
<p>scheduler dispatch 调度器</p>
<p>调度资源？CPU</p>
<p>调度目标？Processes/threads</p>
<p><mark>Goal: 在多道程序设计 multiprogramming 下 CPU 使用率最大化</mark></p>
<p><img src="./assets/image-20241014100337138.png" alt="image-20241014100337138" style="zoom: 50%;" /></p>
<p>CPU-I/O Burst Cycle：Process execution consists of a cycle of CPU execution and I/O wait</p>
<p>进程实际运行时 CPU 占用时间少，I/O 多</p>
<p>大部分 CPU burst 时间非常短</p>
<p>调度的层次：高级（作业）调度 &rarr; 中级（内存）调度 &rarr; 低级（进程调度）</p>
<h4 id="cpu-scheduler">CPU Scheduler<a class="headerlink" href="#cpu-scheduler" title="Permanent link">&para;</a></h4>
<p>CPU 可能进行调度的情况（4 种）</p>
<p><img src="./assets/image-20241014100627801.png" alt="image-20241014100627801" style="zoom: 67%;" /></p>
<p>non-preemptive 非抢占式调度 1 &amp; 4</p>
<p>preemptive ✔️ 2 &amp; 3</p>
<hr />
<p>不能调度的情况：</p>
<ol>
<li>处理中断过程中</li>
<li>需要完全屏蔽中断的原子操作过程中</li>
</ol>
<h4 id="dispacher">Dispacher<a class="headerlink" href="#dispacher" title="Permanent link">&para;</a></h4>
<p>dispacher latency：P0 停止运行到 P1 运行</p>
<p><img src="./assets/image-20241014100422820.png" alt="image-20241014100422820" style="zoom:33%;" /></p>
<h3 id="scheduling-criteria">scheduling criteria<a class="headerlink" href="#scheduling-criteria" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>CPU utilization CPU 利用率：<strong>CPU 使用率 = (1 - 空闲态运行时间/总运行时间) * 100%</strong></p>
</li>
<li>
<p>Throughtput 吞吐率：<strong>进程数/总执行时间</strong></p>
</li>
<li>
<p>Turnaround time 周转时间  = 进程完成时间 - 进程提交时间（进程提交到结束）</p>
</li>
<li>
<p>waiting time 等待时间</p>
</li>
<li>
<p>response time 响应时间</p>
</li>
</ol>
<p><img src="./assets/image-20241014100514354.png" alt="image-20241014100514354" style="zoom:50%;" /></p>
<h3 id="scheduling-algorithms">调度算法 scheduling algorithms<a class="headerlink" href="#scheduling-algorithms" title="Permanent link">&para;</a></h3>
<h4 id="fcfsfirst-come-first-served">FCFS(First-Come, First-Served)<a class="headerlink" href="#fcfsfirst-come-first-served" title="Permanent link">&para;</a></h4>
<p>先来先服务算法</p>
<p><img src="./assets/image-20241014100837396.png" alt="image-20241014100837396" style="zoom:50%;" /></p>
<p><img src="./assets/image-20241014100934593.png" alt="image-20241014100934593" style="zoom:50%;" /></p>
<blockquote>
<p>[!IMPORTANT]</p>
<p>Arrival order makes a difference!
到达顺序很重要</p>
</blockquote>
<ul>
<li>FCFS 是 <strong>非抢占式</strong> 算法</li>
<li>FCFS 简单、公平</li>
<li><strong>Convoy effect</strong>（护航效应）: short process behind long process, the average waiting time may be longer, leading to I/O devices &amp; CPU being idle</li>
</ul>
<p><strong>有利于长作业，不利于短作业；有利于 CPU 繁忙型，不利于 I/O 繁忙型</strong></p>
<blockquote>
<p>短作业位于长作业后时调度时间要很长；I/O 繁忙会有很多 waiting，不断排队到 ready queue 队尾，如果排到长作业后面就要很长时间</p>
</blockquote>
<h4 id="sjfshortest-job-first">SJF(Shortest-Job-First)<a class="headerlink" href="#sjfshortest-job-first" title="Permanent link">&para;</a></h4>
<p>短作业优先算法</p>
<ul>
<li>
<p>SJF is a priority scheduling where priority is the predicted next CPU burst time</p>
</li>
<li>
<p>SJF 既可以是抢占式也可以是非抢占式</p>
</li>
<li>nonpreemptive – once CPU given to the process it cannot be preempted until completes its CPU burst</li>
<li>preemptive – if a new process arrives with CPU burst length less than remaining time of current executing process, preempt. This scheme is known as the <strong>Shortest-Remaining-TimeFirst (SRTF)</strong> 最短剩余时间调度算法</li>
<li>SJF is <strong>optimal</strong> – gives <strong>minimum average waiting time</strong> for a given set of processes</li>
<li>Which is better? Preemptive? Nonpreemptive? 不确定，要根据到达时间和 cpu burst 确定</li>
<li><strong>Starvation 饥饿问题</strong>，优先级低的进程一直无法运行，短作业都会发生</li>
<li>Not good for long process 不适合长进程，因为优先调度 cpu burst 最短的进程</li>
</ul>
<h5 id="nonpreemptive">nonpreemptive<a class="headerlink" href="#nonpreemptive" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241014103433736.png" alt="image-20241014103433736" style="zoom:50%;" /></p>
<h5 id="preemptive">preemptive<a class="headerlink" href="#preemptive" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241014104442138.png" alt="image-20241014104442138" style="zoom:50%;" /></p>
<h4 id="priority-scheduling">Priority Scheduling<a class="headerlink" href="#priority-scheduling" title="Permanent link">&para;</a></h4>
<p>优先级调度算法</p>
<p>The CPU is allocated to the process with the highest priority (smallest integer means highest priority)</p>
<ul>
<li>
<p>Preemptive</p>
</li>
<li>
<p>nonpreemptive</p>
</li>
</ul>
<p><strong>Static Priority</strong>: determine when processes is created; do not change 静态优先</p>
<p>Problem：<strong>Starvation 饥饿</strong> – low priority processes may never execute</p>
<p>Solution：<strong>Aging</strong> （老化）– as time progresses increase the priority of the process——<strong>Dynamic Priority</strong> 提高优先级</p>
<h4 id="highest-response-ratio-next-hrrn">Highest Response Ratio Next （HRRN）<a class="headerlink" href="#highest-response-ratio-next-hrrn" title="Permanent link">&para;</a></h4>
<p>高响应比优先算法</p>
<ul>
<li>非抢占式</li>
<li>HRRN is a <strong>compromise</strong> 折中 between FCFS and SJF</li>
<li>Computing response ratio requires time</li>
<li>improve the responsiveness of the system 提高系统响应性</li>
</ul>
<p>Response Ratio （响应比） = <span class="arithmatex">\(\frac{\text{cpu burst}+\text{waiting time}}{\text{cpu burst}}\)</span> （等待时间和执行时间都要考虑</p>
<p>Take Response Ratio as priority</p>
<p>Larger Response Ratio, higher priority</p>
<h5 id="hrrn">HRRN 算法的工作原理<a class="headerlink" href="#hrrn" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>初始化</strong>： 记录每个进程的到达时间和所需的服务时间。</p>
</li>
<li>
<p><strong>计算响应比</strong>： 对于每个就绪队列中的进程，计算其响应比。</p>
</li>
<li>
<p><strong>选择最高响应比的进程</strong>： </p>
</li>
<li>选择具有最高响应比的进程执行。</li>
<li>
<p>如果有多个进程具有相同的最高响应比，则可以按照其他规则（如先到先服务）来选择。</p>
</li>
<li>
<p><strong>更新等待时间和响应比</strong>： </p>
</li>
<li>每次调度后，更新所有就绪队列中进程的等待时间。</li>
<li>重新计算所有进程的响应比</li>
</ol>
<h4 id="round-robin-rr">Round Robin (RR)<a class="headerlink" href="#round-robin-rr" title="Permanent link">&para;</a></h4>
<p>时间片轮转算法</p>
<ul>
<li>Origin from signature method</li>
<li>Each process gets a small unit of CPU time (time quantum), usually 10-100 milliseconds. After this time has elapsed, the process is preempted and added to the end of the ready queue. 提高系统交互性（人机交互）</li>
<li>Application: Time-sharing system, Multi-tasking system</li>
<li>当前进程的时间片用完后，该进程的状态由执行态变成就绪态</li>
</ul>
<p><img src="./assets/image-20241014112933209.png" alt="image-20241014112933209" style="zoom:50%;" /></p>
<p><img src="./assets/image-20241014113016699.png" alt="image-20241014113016699" style="zoom:50%;" /></p>
<h4 id="multilevel-queue">Multilevel Queue<a class="headerlink" href="#multilevel-queue" title="Permanent link">&para;</a></h4>
<p>多层队列算法</p>
<p>Ready queue is partitioned into separate queues:</p>
<ul>
<li>foreground (interactive)</li>
<li>background (batch)</li>
</ul>
<p>Each queue has its <strong>own scheduling algorithm</strong>, for example</p>
<ul>
<li>foreground – RR</li>
<li>background – FCFS 计算密集</li>
</ul>
<p>Scheduling must be done between the queues</p>
<ul>
<li>
<p>Fixed priority scheduling; (i.e., serve all from foreground then from background). Possibility of starvation.</p>
</li>
<li>
<p>Time slice – each queue gets a certain amount of CPU time which it can schedule amongst its processes; i.e., 80% to foreground in RR ， 20% to background in FCFS </p>
</li>
</ul>
<h4 id="multiple-feedback-queue">Multiple Feedback Queue<a class="headerlink" href="#multiple-feedback-queue" title="Permanent link">&para;</a></h4>
<p>多级反馈队列</p>
<ul>
<li>
<p>多个就绪队列，优先级逐一降低，按照队列优先级调度</p>
</li>
<li>
<p>设置多个就绪队列，优先级从第一级依次降低</p>
</li>
<li>
<p>优先级高的队列，进程时间片越短</p>
</li>
<li>
<p>每个队列都采用 FCFS ，若在该时间片完成，则撒离系统，未完成，转入下一级级队列</p>
</li>
<li>
<p>按队列优先级调度，仅当上一级为空时，才运行下一级</p>
</li>
</ul>
<p>进程进来，先到优先级最高的队列中，时间片内完成则撤离；否则，到下一级队列排队</p>
<h4 id="multiple-processor-scheduling">Multiple-processor scheduling(了解)<a class="headerlink" href="#multiple-processor-scheduling" title="Permanent link">&para;</a></h4>
<p>多处理器调度</p>
<p>Load balancing 负载均衡</p>
<p>Symmetric multiprocessing(SMP) 对称处理器：每个处理器都是自我调度，多个处理器可以运行、更新一个相同的数据结构</p>
<p>Asymmetric multiprocessing 非对称处理器：只有一个处理器可以接触系统数据结构（调度），减轻数据共享，其他处理器只执行用户代码</p>
<ul>
<li>当调度的处理器坏了，整个系统就运行不下去了</li>
</ul>
<h4 id="real-time-scheduling">Real-time scheduling(了解)<a class="headerlink" href="#real-time-scheduling" title="Permanent link">&para;</a></h4>
<p>实时调度</p>
<p>实时系统一定要在规定时间内完成</p>
<p>Hard real-time systems 硬实时系统：ddl 前没运行完有严重后果</p>
<p>Soft real-time systems 软实时系统：可以在 ddl 前没运行完（eg，腾讯会议</p>
<ul>
<li>Earliest ddl First 最早截止时间优先</li>
<li>Least Laxity First 最低松弛度优先（不怎么用）</li>
<li>A 的松弛度 = A 必须完成的时间-A 需要运行的时间-当前时间</li>
<li>Rate Monotonic scheduling 速率单调调度</li>
<li>基于任务的周期（一个进程多久执行一次）来分配优先级，周期越短任务优先级越高</li>
</ul>
<h4 id="thread-scheduling">Thread scheduling(了解)<a class="headerlink" href="#thread-scheduling" title="Permanent link">&para;</a></h4>
<p>线程调度</p>
<p>Local scheduling 用户级</p>
<p>Global scheduling 内核级</p>
<blockquote>
<p>[!NOTE]</p>
<p>批处理 FCFS</p>
<p>分时系统</p>
<p>实时系统</p>
</blockquote>
<p><img alt="6be3c0221860c7866993492f536cac5" src="assets/6be3c0221860c7866993492f536cac5.jpg" /></p>
<h3 id="q">Q<a class="headerlink" href="#q" title="Permanent link">&para;</a></h3>
<p><img src="./assets/image-20241021100841358.png" alt="image-20241021100841358" style="zoom: 33%;" /></p>
<blockquote>
<p>外设是不可抢占的</p>
<p>waiting time 是进程等待 CPU 资源的时间！</p>
</blockquote>
<p><img src="./assets/image-20241021102905818.png" alt="image-20241021102905818" style="zoom: 33%;" /></p>
<h2 id="process-synchronization">进程同步 Process synchronization<a class="headerlink" href="#process-synchronization" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>基本概念：syn，race，critical section，four requirements（互斥/忙则等待、空闲让进、优先等待、）</p>
<p>软件实现方法：单标志，双标志、、、</p>
<p>硬件实现方法：原理、关中断、Test and Set、Swap、CAS、mutex lock</p>
<p>信号量机制：信号量基本概念（形式、类型、用法、实现、缺点）、三个经典问题（有界缓冲区、读写者、哲学家）</p>
<ul>
<li>非忙等/阻塞信号量</li>
</ul>
<p>管程：基本概念（形式、特点、条件变量）、应用</p>
</blockquote>
<h3 id="background">背景 background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h3>
<p>共享数据的并发访问可能导致数据不一致性；并发进程是异步的，所以需要同步</p>
<p>Producer-consumer 生产者消费者问题：解决多个进程间的同步和异步问题</p>
<p><img src="./assets/image-20241021105641372.png" alt="image-20241021105641372" style="zoom:50%;" /> <img src="./assets/image-20241021110813871.png" alt="image-20241021110813871" style="zoom: 67%;" /></p>
<p>count++和 count--两步有可能出错</p>
<h4 id="race-condition">Race condition 竞态条件<a class="headerlink" href="#race-condition" title="Permanent link">&para;</a></h4>
<p>出错的 example：</p>
<p><img src="./assets/image-20241021111018744.png" alt="image-20241021111018744" style="zoom:50%;" /></p>
<p>出错的原因：抢占式调度，多个进程对 shared data 进行操作</p>
<p>Race condition 定义：a memory location is accessed concurrently, and at least one access is a write</p>
<blockquote>
<p><strong>对于访问共享的内核数据，非抢占式的内核是否受竞态条件的影响？</strong></p>
<ul>
<li>可能会受影响，当多处理器对 shared data 进行操作</li>
</ul>
</blockquote>
<h3 id="critical-section-problem">临界区问题 critical-section problem<a class="headerlink" href="#critical-section-problem" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>What operations/processes may have critical problems in OS kernel?</strong></p>
<ul>
<li>cpu</li>
<li>用户态：一个进程的多个线程（满足 shared data 和并发执行）</li>
</ul>
</blockquote>
<p><strong>临界资源</strong>：多进程或多进程中被共享的资源(shared data)且一次只允许一个进程使用</p>
<p><strong>临界区</strong>：程序中一个访问公共资源的程序片段，每个进程中访问临界资源的那段代码被称为临界区</p>
<blockquote>
<p>[!NOTE]</p>
<p><strong>以下是临界资源吗？</strong></p>
<ul>
<li>全局共享变量（是），局部变量（不是），只读数据（不是），CPU（不是）</li>
</ul>
</blockquote>
<p>对一个进程，可能存在多个临界区；临界区可以合并（depends）</p>
<blockquote>
<p>[!CAUTION]</p>
<p>共享资源才需要互斥</p>
</blockquote>
<h4 id="solution">解决方案 solution<a class="headerlink" href="#solution" title="Permanent link">&para;</a></h4>
<h5 id="mutual-exclusion">Mutual Exclusion（互斥/忙则等待）<a class="headerlink" href="#mutual-exclusion" title="Permanent link">&para;</a></h5>
<p>如果进程 P<sub>i</sub> 正在其临界区中执行，则其他进程不能在其临界区中执行</p>
<h5 id="progress">Progress（空闲让进）<a class="headerlink" href="#progress" title="Permanent link">&para;</a></h5>
<p>如果没有任何进程在其临界区中执行，并且存在一些希望进入其临界区的进程，则不能无限期地推迟选择下一个将进入临界区的进程（即允许一个请求进入临界区的进程立即进入临界区）</p>
<h5 id="bounded-waiting">Bounded waiting（有限等待）<a class="headerlink" href="#bounded-waiting" title="Permanent link">&para;</a></h5>
<p>在一个进程发出进入其临界区的请求之后，在该请求被批准之前，必须对允许其他进程进入其临界区的 <strong>次数</strong> 进行限制</p>
<ul>
<li>假设每个进程以非零速度执行</li>
<li>没有关于 <em>N</em> 个进程相对速度的假设</li>
</ul>
<h5 id="_19">让权等待<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h5>
<p>（原则上应该遵守，但非必须）当进程不能进入临界区时，应立即释放处理器，防止进程忙则等待。</p>
<h3 id="_20">同步机制<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<h4 id="_21">软件方法<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<h5 id="_22">单标志法<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241023145626698.png" alt="image-20241023145626698" style="zoom:50%;" /></p>
<p>i 和 j 交替执行</p>
<ul>
<li>满足 Mutual Exclusion 和 bounded waiting</li>
<li>不满足 progess</li>
</ul>
<h5 id="_23">双标志后检查法<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241023145544929.png" alt="image-20241023145544929" style="zoom:50%;" /></p>
<ul>
<li>满足 Mutual Exclusion</li>
<li>不满足 Progress，违背空闲让进准则，存在 CPU 调度的一种情况，两个标志都为 TRUE 后一直循环下去）</li>
<li>如果没有死循环是 bounded waiting，但可能有所以总体不是</li>
</ul>
<h5 id="_24">双标志先检查法<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241023150759551.png" alt="image-20241023150759551" style="zoom:50%;" /></p>
<p>和前面两种算法相比，先 while 再设 flag 值：</p>
<p><img src="./assets/image-20241023150932808.png" alt="image-20241023150932808" style="zoom:50%;" /></p>
<ul>
<li><strong>不满足 Mutual Exclusion</strong>（存在 CPU 调度的一种情况，两个标志都为 TRUE，并进入临界区</li>
<li>满足 Progres</li>
<li>优点：不用交替进入，可连续使用</li>
</ul>
<h5 id="petersons-solution">Peterson’s Solution<a class="headerlink" href="#petersons-solution" title="Permanent link">&para;</a></h5>
<p>双进程解决方案
假设 LOAD 和 STORE 指令是原子的；即不能被中断。
两个进程共享两个变量：<code>int turn;Boolean flag[2];</code>
变量 <code>turn</code> 表示轮到谁进入临界区。
flag 数组用于指示进程是否已准备好进入临界区。<code>flag[i] = true</code> 表示进程 P<sub>i</sub> 已准备好</p>
<p>基本思想：<img src="../images/image-20241023151545037.png" alt="image-20241023151545037" style="zoom:50%;" /></p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1">//Process Pi</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="n">turn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">turn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="n">CRITICAL</span><span class="w"> </span><span class="n">SECTION</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">        </span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">    </span><span class="n">REMAINDER</span><span class="w"> </span><span class="n">SECTION</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="p">}</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="c1">//Process Pj</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">    </span><span class="n">flag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">    </span><span class="n">turn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">turn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">    </span><span class="n">CRITICAL</span><span class="w"> </span><span class="n">SECTION</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">        </span><span class="n">flag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">    </span><span class="n">REMAINDER</span><span class="w"> </span><span class="n">SECTION</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>满足 mutual exception 和 progress</li>
<li>满足 bounded waiting，bound 是 1</li>
<li>但还是不满足让权等待</li>
</ul>
<blockquote>
<p>[!CAUTION]</p>
<p>There are no guarantees that Peterson's solution works correctly on modern computer architectures.</p>
<p>Reason：计算机编译优化 -&gt; 代码的乱序执行【先 load（读），再 store（赋值）】</p>
<p>Solution：Memory barrier ( 内存栅栏 ) -- 插入这条指令后就不会乱序执行了</p>
</blockquote>
<h5 id="bakery-algorithm-lamport">Bakery Algorithm (面包房算法) Lamport<a class="headerlink" href="#bakery-algorithm-lamport" title="Permanent link">&para;</a></h5>
<p>Multiple-Process Solutions： for <strong>n</strong> processes</p>
<ol>
<li>任何时间，最多只能有一个进程进入 critical section ；</li>
<li>每个进程最终都会进入 critical section ；</li>
<li>每个进程都能停在 noncritical section ；</li>
<li>不能对进程的速度做任何假设。</li>
</ol>
<p>基本思想（排队取号）：<img src="../images/image-20241023153601642.png" alt="image-20241023153601642" style="zoom:50%;" /></p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1">//Multiple-Process Solutions</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="k">do</span><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="n">choosing</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="n">number</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">{</span><span class="n">number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w"> </span><span class="n">number</span><span class="p">[</span><span class="n">n</span><span class="mi">-1</span><span class="p">]}</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 选号码</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="n">choosing</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="err">＜</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">choosing</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="err">＜</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="p">));</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">    </span><span class="n">CRITICAL</span><span class="w"> </span><span class="n">SECTION</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">        </span><span class="n">number</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">    </span><span class="n">REMAINDER</span><span class="w"> </span><span class="n">SECTION</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>满足 mutual exception 和 progress，</li>
<li>满足 bounded waiting，bound 为 n-1</li>
</ul>
<h4 id="_25">硬件方法<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<p><strong>Synchronization Hardware</strong></p>
<p>Modern machines provide special atomic hardware <strong>instructions</strong></p>
<p>​   -&gt; <mark>Atomic = non-interruptable</mark> (原子操作，不能中断；后三种方法都用了这一思想)</p>
<p><strong>优点</strong>  </p>
<ul>
<li>
<p>适用于任意数目的进程，在单处理器或多处理器上</p>
</li>
<li>
<p>简单，容易验证其正确性</p>
</li>
<li>
<p>可以支持进程内存在多个临界区，只需为每个临界区设立一个布尔变量</p>
</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>
<p>耗费 CPU 时间，不能实现“让权等待” </p>
</li>
<li>
<p>可能不满足有限等待：从等待进程中随机选择一个进入临界区，有的进程可能一直选不上 </p>
</li>
<li>
<p>可能死锁</p>
</li>
</ul>
<h5 id="disable-interrupts">关中断法 Disable interrupts(中断屏蔽法)<a class="headerlink" href="#disable-interrupts" title="Permanent link">&para;</a></h5>
<p>思想：进入临界区前直接屏蔽中断，保证临界区资源顺利使用；使用完毕，打开中断</p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span>
<span class="normal"><a href="#__codelineno-4-7">7</a></span>
<span class="normal"><a href="#__codelineno-4-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="n">Disable</span><span class="w"> </span><span class="n">Interrupts</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">    </span><span class="n">Critical</span><span class="w"> </span><span class="n">section</span><span class="p">;</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="n">Enable</span><span class="w"> </span><span class="n">Interrupts</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">    </span><span class="n">Remainder</span><span class="w"> </span><span class="n">section</span><span class="p">;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="p">}</span><span class="w"> </span>
</span></code></pre></div></td></tr></table></div>
<h6 id="_26">缺点<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><strong>可能影响系统效率</strong>：滥用关中断会严重影响 CPU 执行效率，其锁住 CPU 可能导致原本一些短时间即可完成的需要等待开中断，影响 cpu 并发执行，cpu 利用率下降</p>
</li>
<li>
<p><strong>不适用于多 CPU 系统</strong>：中断屏蔽法适用于单 CPU 系统，在多 CPU 系统中 <strong>无法有效同步</strong> 各个 CPU 的操作。 </p>
</li>
<li><strong>安全性问题</strong>：滥用关中断权力可能导致严重后果，例如在关闭中断期间，一些重要的中断请求可能被错过，影响系统的稳定性和可靠性。</li>
</ul>
<h5 id="testandset-lock-instructiontsl">TestAndSet Lock Instruction（TSL）<a class="headerlink" href="#testandset-lock-instructiontsl" title="Permanent link">&para;</a></h5>
<p>Test and modify the content of a word atomically.</p>
<p>Shared boolean variable lock, initialized to false.</p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">boolean</span><span class="w"> </span><span class="nf">TestAndSet</span><span class="w"> </span><span class="p">(</span><span class="n">boolean</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="p">{</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="n">boolean</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="p">;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">    </span><span class="o">*</span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">rv</span><span class="o">:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="p">}</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">TestAndSet</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="w"> </span><span class="p">));</span><span class="cm">/* do nothing*/</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">    </span><span class="c1">// critical section</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">    </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">    </span><span class="c1">// remainder section </span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="p">};</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>满足 mutual exclusion, progress</li>
<li>不满足 bounded waiting（进入临界区靠运气），不满足让权等待</li>
<li>等待进入临界区的进程不会主动放弃 CPU</li>
</ul>
<h5 id="swap-instruction">Swap Instruction<a class="headerlink" href="#swap-instruction" title="Permanent link">&para;</a></h5>
<p>思想</p>
<ol>
<li>
<p>对每个临界资源，swap 设置一个全局 <code>bool</code> 变量 <code>lock</code>(初值为 false) ，每个进程设置局部变量 <code>key</code>(初值为 true)</p>
</li>
<li>
<p>进程调用 <code>swap()</code> 指令访问临界区，会交换 key 和 lock 的值，实现上锁，进入访问</p>
</li>
<li>
<p>退出时把 <code>lock</code> 重置为 <code>false</code></p>
</li>
</ol>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">    </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">        </span><span class="n">Swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">    </span><span class="c1">// critical section</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">    </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">    </span><span class="c1">// remainder section </span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="p">}</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="kt">void</span><span class="w"> </span><span class="n">Swap</span><span class="p">(</span><span class="n">boolean</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">boolean</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="p">{</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">    </span><span class="n">boolean</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">    </span><span class="o">*</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">    </span><span class="o">*</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>满足 mutual exclusion, progress</li>
<li>不满足 bounded waiting（</li>
</ul>
<h5 id="the-compare_and_swap-cas-instruction">The compare_and_swap (CAS) Instruction<a class="headerlink" href="#the-compare_and_swap-cas-instruction" title="Permanent link">&para;</a></h5>
<p>思想</p>
<ol>
<li>Executed atomically</li>
<li>Returns the original value of passed parameter <strong>value</strong></li>
<li>Set the variable <strong>value</strong> the value of the passed parameter <strong>new_value</strong> but only if <code>*value == expected</code> is true. That is, the swap takes place only under this condition.</li>
</ol>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c1">//Shared integer lock initialized to 0;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">){</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">compare_and_swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="cm">/* do nothing */</span><span class="w"> </span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">    </span><span class="cm">/* critical section */</span><span class="w"> </span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">    </span><span class="cm">/* remainder section */</span><span class="w"> </span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="p">}</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="kt">int</span><span class="w"> </span><span class="n">compare_and_swap</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">expected</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">new_value</span><span class="p">)</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="p">{</span><span class="w"> </span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">        </span><span class="o">*</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_value</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>满足 mutual exclusion, progress</li>
<li>不满足 bounded waiting（</li>
</ul>
<p>解决办法：排队</p>
<h5 id="bounded-waiting-with-compare-and-swap">Bounded-waiting with compare-and-swap<a class="headerlink" href="#bounded-waiting-with-compare-and-swap" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241028105047216.png" alt="image-20241028105047216" style="zoom:33%;" /></p>
<ul>
<li>满足 mutual exclusion, progress 和 bounded waiting</li>
</ul>
<blockquote>
<p>[!CAUTION]</p>
<p>以上对 TS 和 Swap 指令的描述仅为功能描述，它们由硬件逻辑实现，不会被中断</p>
</blockquote>
<h4 id="mutex-locks">互斥锁 Mutex locks<a class="headerlink" href="#mutex-locks" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241028112035245.png" alt="image-20241028112035245" style="zoom:33%;" /></p>
<p>But this solution requires <strong>busy waiting</strong> <strong>（不停空循环）</strong></p>
<p>This lock therefore called a <strong>spinlock</strong> <strong>（也叫 自旋锁）</strong></p>
<ul>
<li>主要采用硬件机制来实现</li>
<li>缺点：忙等待</li>
</ul>
<h4 id="semaphores">信号量方法 Semaphores<a class="headerlink" href="#semaphores" title="Permanent link">&para;</a></h4>
<p>用来解决同步和互斥问题</p>
<p>Two indivisible operations modify S: </p>
<ul>
<li>
<p><code>wait()</code> and <code>signal()</code>, originally called <code>P()</code> and <code>V()</code> </p>
</li>
<li>
<p>Proberen(测试)，Verhogen(增加) </p>
</li>
<li>
<p>只能在 wait 和 signal 中对信号量进行操作</p>
</li>
<li>
<p>低级的进程通信原语</p>
</li>
</ul>
<p>Can only be accessed via two indivisible (atomic) operations:</p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="n">wait</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//资源进入临界区</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// no-op，S &lt;= 0：有进程在临界区</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">    </span><span class="n">S</span><span class="o">--</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="p">}</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="n">signal</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//资源退出临界区，空出资源给其他进程</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">    </span><span class="n">S</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p>Can be implemented without busy waiting &rarr; 实现让权等待</p>
<blockquote>
<p>[!IMPORTANT]</p>
<p><img src="./assets/image-20241030152700179.png" alt="image-20241030152700179" style="zoom: 33%;" /></p>
<p>S.value = 0 已经有一个进程在临界区</p>
</blockquote>
<p>信号量种类：</p>
<p><img src="./assets/image-20241028113509355.png" alt="image-20241028113509355" style="zoom:33%;" /></p>
<p>👆 互斥访问</p>
<p>同步操作：</p>
<p><img src="./assets/image-20241030143820461.png" alt="image-20241030143820461" style="zoom:33%;" /></p>
<p>Question：有四个房间，四个进程访问</p>
<p><img src="./assets/image-20241030144512191.png" alt="image-20241030144512191" style="zoom: 33%;" /></p>
<h5 id="semaphore-implementation">实现 Semaphore Implementation<a class="headerlink" href="#semaphore-implementation" title="Permanent link">&para;</a></h5>
<h6 id="busy-waiting">Busy waiting<a class="headerlink" href="#busy-waiting" title="Permanent link">&para;</a></h6>
<p><img src="./assets/image-20241030144747181.png" alt="image-20241030144747181" style="zoom:33%;" /></p>
<p><img src="./assets/image-20241030145309092.png" alt="image-20241030145309092" style="zoom:33%;" /></p>
<p>对 P 不太友好</p>
<h6 id="no-busy-waiting">no Busy waiting 非忙等<a class="headerlink" href="#no-busy-waiting" title="Permanent link">&para;</a></h6>
<p><img src="./assets/image-20241030145617397.png" alt="image-20241030145617397" style="zoom:33%;" /></p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="cm">/*Implementation of wait*/</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="n">wait</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">){</span><span class="w"> </span><span class="c1">//取信号量操作</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">    </span><span class="n">value</span><span class="o">--</span><span class="p">;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="w">        </span><span class="c1">// add this process to waiting queue</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">        </span><span class="n">block</span><span class="p">();</span><span class="w"> </span><span class="c1">// 插到S的waiting queue中</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="p">}</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="cm">/*Implementation of signal*/</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="n">Signal</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">){</span><span class="w"> </span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="w">    </span><span class="n">value</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="w">        </span><span class="c1">// remove a process P from the waiting queue</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="w">        </span><span class="n">wakeup</span><span class="p">(</span><span class="n">P</span><span class="p">);</span><span class="w"> </span><span class="c1">// 把一个进程唤醒，移出waiting queue，到临界区执行</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>S 的取值可以是负的了（相比原先的 wait 和 signal），S 取负表示当前队列排队进程的个数</li>
</ul>
<p><img src="./assets/image-20241030151249807.png" alt="image-20241030151249807" style="zoom: 33%;" /></p>
<p><img src="./assets/image-20241030151458384.png" alt="image-20241030151458384" style="zoom: 33%;" /></p>
<p><img src="./assets/image-20241030151550913.png" alt="image-20241030151550913" style="zoom: 33%;" /></p>
<blockquote>
<p>[!WARNING]</p>
<p>进程在标黄处 sleep 后，再次被唤醒时会从头开始执行！</p>
</blockquote>
<p>Busy waiting? No busy waiting?</p>
<ul>
<li>No busy waiting</li>
</ul>
<p>What if one must choose busy waiting?</p>
<ul>
<li>电脑要多 CPU</li>
<li>上下文切换时间 &gt; busy waiting，选择 no busy waiting；&lt; 的话两者都行</li>
</ul>
<h5 id="deadlock-and-starvation">Deadlock and Starvation<a class="headerlink" href="#deadlock-and-starvation" title="Permanent link">&para;</a></h5>
<p><strong>Deadlock 死锁</strong> – two or more processes are waiting indefinitely for an event that can be caused by only one of the waiting processes</p>
<p><strong>Starvation 饥饿</strong> – indefinite blocking. A process may never be removed from the semaphore queue in which it is suspended</p>
<h5 id="classical-problems-of-synchronization">Classical Problems of Synchronization<a class="headerlink" href="#classical-problems-of-synchronization" title="Permanent link">&para;</a></h5>
<h6 id="bounded-buffer-problem">Bounded-Buffer Problem<a class="headerlink" href="#bounded-buffer-problem" title="Permanent link">&para;</a></h6>
<p><em>N</em> buffers, each can hold one item</p>
<ul>
<li>Semaphore <strong>mutex</strong> initialized to the value <strong>1</strong> 互斥信号量 1 个</li>
<li>Semaphore <strong>full</strong> initialized to the value 0, counting full items</li>
<li>Semaphore <strong>empty</strong> initialized to the value <strong>N</strong>, counting empty items</li>
</ul>
<p><img src="./assets/image-20241030153449418.png" alt="image-20241030153449418" style="zoom:33%;" /></p>
<h6 id="readers-and-writers-problem">Readers and Writers Problem<a class="headerlink" href="#readers-and-writers-problem" title="Permanent link">&para;</a></h6>
<p><strong>读者写者问题</strong></p>
<p>A data set is shared among a number of concurrent processes</p>
<ul>
<li>Readers – only read the data set; they do not perform any updates</li>
<li>Writers – can both read and write.</li>
</ul>
<p><strong>Problem</strong> – allow multiple readers to read at the same time. Only one single writer can access the shared data at the same time.  ( 读者优先 ) </p>
<p>Shared Data</p>
<ul>
<li>
<p>Data set</p>
</li>
<li>
<p>Semaphore <strong>mutex</strong> initialized to 1, to ensure mutual exclusion when readcount is updated.</p>
</li>
<li>
<p>Semaphore <strong>wrt</strong> initialized to 1.</p>
</li>
<li>
<p>Integer <strong>readcount</strong> initialized to 0 读者的数量</p>
</li>
</ul>
<p><img src="./assets/image-20241030154705621.png" alt="image-20241030154705621" style="zoom:33%;" /></p>
<h6 id="dining-philosophers-problem">Dining-Philosophers Problem<a class="headerlink" href="#dining-philosophers-problem" title="Permanent link">&para;</a></h6>
<p><strong>哲学家就餐问题</strong></p>
<p>Shared data </p>
<ul>
<li>
<p>Bowl of rice (data set)</p>
</li>
<li>
<p>Semaphore <code>chopstick [5]</code> initialized to 1</p>
</li>
</ul>
<p><img src="./assets/image-20241030155058113.png" alt="image-20241030155058113" style="zoom:33%;" /></p>
<p>如果只设置一个筷子的信号量，设置为 5，有什么问题？一个筷子可能被拿两次，违反互斥性</p>
<h4 id="monitor">管程方法 monitor<a class="headerlink" href="#monitor" title="Permanent link">&para;</a></h4>
<p>实现互斥和同步</p>
<h5 id="monitor_1">Monitor<a class="headerlink" href="#monitor_1" title="Permanent link">&para;</a></h5>
<p>A high-level abstraction that provides a convenient and effective mechanism for process synchronization. </p>
<p>Only <strong>one</strong> process may be active within the monitor at a time. (hint: the other processes may be sleeping within the monitor)</p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="c1">//管程变量只有内部函数可以访问</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">monitor</span><span class="w"> </span><span class="n">monitor</span><span class="o">-</span><span class="n">name</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="p">{</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">    </span><span class="c1">// shared variable declarations</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">    </span><span class="n">procedure</span><span class="w"> </span><span class="nf">P1</span><span class="w"> </span><span class="p">(</span><span class="err">…</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">…</span><span class="p">.</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">    </span><span class="err">…</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">        </span><span class="n">procedure</span><span class="w"> </span><span class="n">Pn</span><span class="w"> </span><span class="p">(</span><span class="err">…</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">……</span><span class="p">}</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">    </span><span class="n">Initialization</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">…</span><span class="p">.)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">…</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">    </span><span class="err">…</span><span class="w"> </span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p><img src="./assets/image-20241104104332459.png" alt="image-20241104104332459" style="zoom:33%;" /> 函数挂起</p>
<p><code>x.wait()</code> 作用：阻塞该进程并将他插入到 x 序列</p>
<p>管程中的 signal 操作和信号量的 V 操作不同：V 一定会改变信号量的值 S = S+1，但是 signal 是针对某个条件变量的，若不存在因该条件而阻塞的进程，则 signal 不会产生任何影响</p>
<h5 id="_27">管程方法解决哲学家就餐问题<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h5>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span>
<span class="normal"><a href="#__codelineno-11-22">22</a></span>
<span class="normal"><a href="#__codelineno-11-23">23</a></span>
<span class="normal"><a href="#__codelineno-11-24">24</a></span>
<span class="normal"><a href="#__codelineno-11-25">25</a></span>
<span class="normal"><a href="#__codelineno-11-26">26</a></span>
<span class="normal"><a href="#__codelineno-11-27">27</a></span>
<span class="normal"><a href="#__codelineno-11-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">monitor</span><span class="w"> </span><span class="n">DP</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="p">{</span><span class="w"> </span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">    </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">THINKING</span><span class="p">;</span><span class="w"> </span><span class="n">HUNGRY</span><span class="p">,</span><span class="w"> </span><span class="n">EATING</span><span class="p">)</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">          </span><span class="n">condition</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">          </span><span class="c1">//philosopher i can delay herself when unable to get chopsticks</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">          </span><span class="kt">void</span><span class="w"> </span><span class="nf">pickup</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 拿筷子</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w">              </span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HUNGRY</span><span class="p">;</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">              </span><span class="n">test</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"> </span><span class="c1">// 看看左边右边有没有人在eating</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">EATING</span><span class="p">)</span><span class="w"> </span><span class="c1">// 自己hungry</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">                  </span><span class="n">self</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">wait</span><span class="p">;</span><span class="w"> </span><span class="c1">// 筷子还不可用，等待</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="w">          </span><span class="kt">void</span><span class="w"> </span><span class="nf">putdown</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="w">              </span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">THINKING</span><span class="p">;</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="w">              </span><span class="c1">// test left and right neighbors</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="w">              </span><span class="n">test</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// 如若满足则唤醒进行吃饭</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="w">              </span><span class="n">test</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="w">          </span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">EATING</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20"></a><span class="w">                  </span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HUNGRY</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21"></a><span class="w">                  </span><span class="p">(</span><span class="n">state</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">EATING</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22"></a><span class="w">                  </span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EATING</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23"></a><span class="w">                  </span><span class="n">self</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">signal</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//执行时不在signal中等待，这句signal没有用</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24"></a><span class="w">              </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25"></a><span class="w">          </span><span class="n">initialization_code</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26"></a><span class="w">              </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27"></a><span class="w">                  </span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">THINKING</span><span class="p">;</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>When the left and right philosophers, <strong>self [(i+4)%5]</strong> and <strong>self [(i+1)%5]</strong></li>
</ul>
<p>continue to eat, <strong>self [i]</strong> may <em>starve</em></p>
<h4 id="_28">例子<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<h5 id="pthreads">Pthreads<a class="headerlink" href="#pthreads" title="Permanent link">&para;</a></h5>
<p>It provides:</p>
<ul>
<li>
<p>mutex locks</p>
</li>
<li>
<p>condition variables</p>
</li>
</ul>
<p>Non-portable extensions include:</p>
<ul>
<li>
<p>read-write locks</p>
</li>
<li>
<p>spin locks</p>
</li>
</ul>
<p>Using <code>pthread_cond_wait()</code> &amp; <code>pthread_cond_signal()</code></p>
<h2 id="deadlock">死锁 Deadlock<a class="headerlink" href="#deadlock" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>基本概念：死锁概念，4 个必要条件，资源分配图，cycle &amp;deadlock
solutions：3 种策略
死锁预防（如何破坏四个必要条件)
死锁避免（安全状态，安全状态与死锁，单实例算法，多实例算法——<strong>银行家算法</strong>）
检测（单实例算法——wait for graph，多实例算法)
恢复</p>
</blockquote>
<h3 id="the-deadlock-problem">The Deadlock Problem<a class="headerlink" href="#the-deadlock-problem" title="Permanent link">&para;</a></h3>
<p><strong>死锁</strong>：多个进程因竞争共享资源而造成相互等待的一种僵局，使得各个进程都被阻塞，若无外力作用，这些进程都将永远不能再向前推进</p>
<p>发生死锁的进程必定处于阻塞态</p>
<h4 id="_29">产生死锁的四个必要条件<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241106152044852.png" alt="image-20241106152044852" style="zoom:33%;" /></p>
<blockquote></blockquote>
<p><strong>死锁公式</strong>：</p>
<p>假设系统共有 m 个资源，n 个进程，每个进程需要 k 个资源，若满足 <span class="arithmatex">\(m&gt;n×(k- 1)\)</span>，则系统一定不会发生死锁</p>
<h3 id="system-model">系统模型 System Model<a class="headerlink" href="#system-model" title="Permanent link">&para;</a></h3>
<p>resource type &amp; resource instances</p>
<h4 id="resource-allocation-graph">资源分配图 Resource-Allocation Graph<a class="headerlink" href="#resource-allocation-graph" title="Permanent link">&para;</a></h4>
<p>A set of vertices <strong>顶点 V</strong> and a set of edges <strong>边 E</strong></p>
<p><img src="./assets/image-20241106153033476.png" alt="image-20241106153033476" style="zoom:33%;" /></p>
<p>顶点表示资源 R 或进程 P</p>
<p>边：</p>
<ul>
<li><strong>P-&gt; R</strong>，进程指向资源，进程申请资源 ==&gt; 申请边</li>
<li><strong>R-&gt; P </strong>，资源指向进程，进程可以使用资源，资源已经被分配给进程 ==&gt; 分配边</li>
</ul>
<p>死锁一定有环，有环不一定死锁</p>
<p>If graph contains no cycles =&gt; no deadlock. 无环一定没有死锁</p>
<p>If graph contains a cycle =&gt;</p>
<ul>
<li>
<p>if only one instance per resource type, then deadlock.</p>
</li>
<li>
<p>if several instances per resource type, possibility of deadlock.</p>
</li>
</ul>
<h3 id="methods-for-handling-deadlocks">死锁处理方法 Methods for Handling Deadlocks<a class="headerlink" href="#methods-for-handling-deadlocks" title="Permanent link">&para;</a></h3>
<p>Ensure that the system will never enter a deadlock state. 让系统永远不进入死锁状态 ---- <strong>Prevention 死锁预防</strong>、 <strong>Avoidance 死锁避免</strong></p>
<p>Allow the system to enter a deadlock state and then recover. 允许系统进入死锁状态，但可以恢复 ----<strong>Detection 死锁检测</strong>、 <strong>Recovery 死锁解除</strong></p>
<p>Ignore the problem and pretend that deadlocks never occur in the system. 忽略，假装不出现死锁 ---- <strong>鸵鸟算法</strong>（Ostrich Algorithm）</p>
<ul>
<li>大多数操作系统使用鸵鸟算法 used by most operating systems, including UNIX、Linux、Windows.</li>
<li>为什么选这个？用户运行多，解决代价少</li>
</ul>
<h4 id="deadlock-prevention">Deadlock Prevention (预防)<a class="headerlink" href="#deadlock-prevention" title="Permanent link">&para;</a></h4>
<p>破坏死锁产生的四个必要条件之一 Restrain the ways request can be made.</p>
<ul>
<li>限制用户申请资源的顺序 -- 破坏循环等待（条件 4）</li>
</ul>
<ol>
<li><strong>Prevent Mutual Exclusion 不互斥</strong>： not required for sharable resources; must hold for nonsharable resources 不共享资源，即互斥使用资源，实际中不太可行（这个条件无法被破坏）</li>
<li><strong>Prevent Hold and Wait 不请求等待</strong> ：一次分配好所有资源 must guarantee that whenever a process requests a resource, it does not hold any other resources.</li>
<li>Require process to request and be allocated all its resources before it begins execution, or allow process to request resources only when the process has none (<strong>release all current resources before requesting any additional ones</strong>).
      要求进程在开始执行之前请求并分配所有资源，或者仅在进程没有资源时才允许进程请求资源（在请求任何其他资源之前释放所有当前资源）。</li>
<li><strong>Low resource utilization</strong>; <strong>starvation possible</strong>. (example: copy data from DVD drive to a disk file, sorts the file, then prints the results to a printer.)
      <strong>资源利用率低</strong>；<strong>可能出现饥饿</strong>。（例如：将数据从 DVD 驱动器复制到磁盘文件，对文件进行排序，然后将结果打印到打印机。）</li>
<li><strong>Prevent No Preemption 可剥夺</strong>：变成非抢占式，实际中不太可行</li>
<li><strong>Prevent Circular Wait 不循环等待</strong>：impose a total <strong>ordering</strong> of all resource types, and require that each process requests resources in an increasing order of enumeration. 
   对所有资源类型实行总体 <strong>排序</strong>，并要求每个进程按照枚举的递增顺序请求资源。</li>
</ol>
<p>以上方法在实际中都不太可行</p>
<h4 id="deadlock-avoidance">Deadlock Avoidance (避免)<a class="headerlink" href="#deadlock-avoidance" title="Permanent link">&para;</a></h4>
<p>通过动态检测资源分配的安全性，确保系统 <strong>不会进入不安全状态</strong></p>
<ul>
<li>为实现安全性，我们需要知道</li>
<li>每个进程所需资源 max 数量 each process declares the maximum number of resources of each type that it may need</li>
<li>The deadlock-avoidance algorithm dynamically examines the resource-allocation state to ensure that there can never be a circular-wait condition.</li>
<li>Resource-allocation state is defined by the number of available and allocated resources, and the maximum demands of the processes.</li>
</ul>
<h5 id="safe-state">safe state 安全状态<a class="headerlink" href="#safe-state" title="Permanent link">&para;</a></h5>
<p><P1 , P2 , …, Pn> 称为安全序列。如果系统不存在安全序列，则称系统处于不安全状态</p>
<p>对于进程序列中的每一个进程 Pi，当前系统已经分配了一些资源，还剩下一些资源。如果 <strong>Pi 前面的资源之和+系统剩下的资源 能够满足 Pi 执行完毕</strong>，则这个序列是个安全状态。</p>
<p><img src="./assets/image-20241111103432235.png" alt="image-20241111103432235" style="zoom:33%;" /></p>
<blockquote>
<p>[!NOTE]</p>
<p>If a system is in safe state =&gt; no deadlocks. 安全状态一定无死锁</p>
<p>If a system is in unsafe state =&gt; possibility of deadlock. 不安全可能有死锁</p>
<p>Avoidance =&gt; ensure that a system will never enter an unsafe state.</p>
</blockquote>
<p><img src="./assets/image-20241111104223355.png" alt="image-20241111104223355" style="zoom:33%;" /></p>
<h5 id="avoidance-algorithms">Avoidance algorithms<a class="headerlink" href="#avoidance-algorithms" title="Permanent link">&para;</a></h5>
<p><strong>Single</strong> instance of a resource type. Use a resourceallocation graph</p>
<p><strong>Multiple</strong> instances of a resource type. Use the banker’s algorithm</p>
<h5 id="resource-allocation-graph-algorithm">Resource-Allocation Graph Algorithm 资源分配图算法<a class="headerlink" href="#resource-allocation-graph-algorithm" title="Permanent link">&para;</a></h5>
<p>Claim edge Pi -&gt; Rj indicated that process Pi may request resource Rj</p>
<p>有三种边：claim edge、request edge 和 assignment edge</p>
<p>？</p>
<h5 id="bankers-algorithm">Banker’s Algorithm 银行家算法<img alt="🔥" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f525.svg" title=":fire:" /><a class="headerlink" href="#bankers-algorithm" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241111110516636.png" alt="image-20241111110516636" style="zoom:33%;" /></p>
<p>数据结构</p>
<p><img src="./assets/image-20241111110607001.png" alt="image-20241111110607001" style="zoom:33%;" /></p>
<p>Example</p>
<p><img src="./assets/image-20241111111754885.png" alt="image-20241111111754885" style="zoom:33%;" /></p>
<p><img src="./assets/image-20241111112228808.png" alt="image-20241111112228808" style="zoom:33%;" /></p>
<ul>
<li>实际上很多操作系统都不是使用银行家算法进行死锁避免</li>
</ul>
<h5 id="safety-algorithm">Safety Algorithm<a class="headerlink" href="#safety-algorithm" title="Permanent link">&para;</a></h5>
<p><img src="./assets/image-20241111111035473.png" alt="image-20241111111035473" style="zoom:33%;" /></p>
<h4 id="deadlock-detection">Deadlock Detection ( 检测 )<a class="headerlink" href="#deadlock-detection" title="Permanent link">&para;</a></h4>
<p>本质：safety 算法，全部满足就没有死锁</p>
<h5 id="single-instance-of-each-resource-type">单实例 Single Instance of Each Resource Type<a class="headerlink" href="#single-instance-of-each-resource-type" title="Permanent link">&para;</a></h5>
<p>检查 wait-for graph 有没有环</p>
<p><img src="./assets/image-20241111112900123.png" alt="image-20241111112900123" style="zoom:33%;" /></p>
<h5 id="several-instances-of-a-resource-type">多实例 Several Instances of a Resource Type<a class="headerlink" href="#several-instances-of-a-resource-type" title="Permanent link">&para;</a></h5>
<p>多实例，调用 safety 算法</p>
<p>时间复杂度：O(m × n^2^)</p>
<h5 id="completely-reducible-graph">Completely Reducible Graph 可完全化简图<a class="headerlink" href="#completely-reducible-graph" title="Permanent link">&para;</a></h5>
<p>能消去图中所有边，能则称为可完全化简图</p>
<p>找出一个既不阻塞又非独立的进程结点 Pi</p>
<p>在顺利的情况下，分配给其资源让其完成，消去所有边变成孤立点</p>
<p>循环上述两步操作，直至消去所有边，代表无死锁。</p>
<h3 id="recovery-from-deadlock">Recovery from Deadlock<a class="headerlink" href="#recovery-from-deadlock" title="Permanent link">&para;</a></h3>
<p>解除死锁的方法：</p>
<ol>
<li>
<p>资源剥夺法：把部分进程挂起，剥夺其资源</p>
</li>
<li>
<p>撤销进程法：撤销部分进程，释放资源</p>
</li>
<li>
<p>进程回退法：让一个进程或多个进程回退到避免死锁的地步，释放中间资源</p>
</li>
</ol>
<p>依据：进程的优先级、已执行时间、剩余时间、已用资源、交互还是批处理等</p>
<h4 id="resource-preemption">Resource Preemption<a class="headerlink" href="#resource-preemption" title="Permanent link">&para;</a></h4>
<p>Selecting a victim – minimize cost.
Rollback – return to some safe state, restart process for that state.
Starvation – same process may always be picked as victim, include number of rollback in cost factor</p>
<h2 id="memory-management_1">内存管理 Memory Management<a class="headerlink" href="#memory-management_1" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>内存管理基本概念：</p>
<ul>
<li>源程序处理流程、链接</li>
<li>地址绑定 binding</li>
<li>编译、装入、执行时刻</li>
<li>逻辑地址与物理地址</li>
<li>MMU</li>
</ul>
<p>variable-partition scheme</p>
<ul>
<li>内存分配算法 FF best worst</li>
<li>外部、内部碎片</li>
</ul>
<p>内存保护</p>
<p>连续分配管理方式</p>
<p>Paging 分页管理方式</p>
<ul>
<li>page table、TLB、分级页表、索引页表</li>
<li>TLB effective access time</li>
</ul>
<p>分段管理方式、段页管理</p>
<ul>
<li>segment table</li>
<li>分配方式更灵活</li>
</ul>
</blockquote>
<h3 id="background_1">Background<a class="headerlink" href="#background_1" title="Permanent link">&para;</a></h3>
<p>电磁感应</p>
<p><strong>Semiconductor ROM/RAM</strong></p>
<p>DRAM: 动态随机存取存储器</p>
<p>SRAM: 静态随机存取存储器</p>
<p>ROM: 只读存储器</p>
<p><strong>“Memory Wall”</strong></p>
<p>内存墙 Memory is much slower than processors, and consumes more energy</p>
<p><strong>Emerging NVM Technologies</strong></p>
<p><strong>NVMs</strong> : 非挥发性存储器，非易失性存储器</p>
<ul>
<li>non-volatile; low idle power; no refreshes; high write overheads; etc. </li>
</ul>
<p><strong>Phase-Change Memory(PCM)</strong>：相变存储器</p>
<ul>
<li>Intel/Micron 3D Xpoint；Intel Optane DC Persistent Memory / DC SSD </li>
</ul>
<p><strong>ReRAM/RRAM</strong>：电阻式存储器</p>
<ul>
<li>Arbitrary programmed cell resistance (“memristor”). </li>
<li>First invented by HP Labs, now produced by many companies (in early stage). </li>
</ul>
<hr />
<p>Program must <strong>be brought (from disk) into memory</strong> and placed within a process for it to be run only storage CPU can access Main memory and registers directly</p>
<p>Register access in one CPU clock (or less)</p>
<p>Main memory can take many cycles</p>
<p>Cache sits between main memory and CPU registers</p>
<h4 id="cache-hierarchy">Cache Hierarchy<a class="headerlink" href="#cache-hierarchy" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241118100926438.png" alt="image-20241118100926438" style="zoom: 33%;" /></p>
<h4 id="multistep-processing-of-a-user-program">Multistep Processing of a User Program<a class="headerlink" href="#multistep-processing-of-a-user-program" title="Permanent link">&para;</a></h4>
<p>运行程序过程：complier -- linker -- loader -- run</p>
<ul>
<li><strong>Symbolic Address 符号地址</strong>: Addresses in the source program are generally symbolic (such as the variable count 函数名/变量名). </li>
<li><strong>Relocatable Addresses 可重定位地址</strong> : A compiler typically binds these symbolic addresses to relocatable addresses (such as “14 bytes from the beginning of this module”). </li>
<li><strong>Absolute Addresses 绝对地址</strong> : The linker or loader binds the relocatable addresses to absolute addresses (such as 74014)</li>
</ul>
<h4 id="binding-of-instructions-and-data-to-memory">Binding of Instructions and Data to Memory<a class="headerlink" href="#binding-of-instructions-and-data-to-memory" title="Permanent link">&para;</a></h4>
<p>地址绑定</p>
<p><strong>Address binding</strong>(Mapping From one address space to another) of instructions and data to memory addresses can happen at three different stages</p>
<ul>
<li><strong>Compile time 编译时刻</strong> : If memory location known a priori, absolute code can be generated; must recompile code if starting location changes</li>
<li><strong>Load time 装入时刻</strong> : Must generate relocatable codeif memory location is not known at compile time</li>
<li><strong>Execution time 执行时刻</strong> : Binding delayed until run time if the process can be moved during its execution from one memory segment to another. Need hardware support for address maps (e.g., base and limit registers 两个寄存器用来快速地址映射和绑定)</li>
<li>Base register 基址寄存器 , limit register 限长寄存器 <img src="../images/image-20241118102941818.png" alt="image-20241118102941818" style="zoom:25%;" /></li>
<li>Linux, Windows 系统在 <strong>执行时刻</strong> 进行地址绑定</li>
</ul>
<h4 id="logical-vs-physical-address-space">Logical vs. Physical Address Space<a class="headerlink" href="#logical-vs-physical-address-space" title="Permanent link">&para;</a></h4>
<p>The concept of a logical address space that is bound to a separate physical address space is central to proper memory management</p>
<ul>
<li><strong>Logical address</strong> 逻辑地址 – generated by the CPU; also referred to as virtual address</li>
<li><strong>Physical address</strong> 物理地址 – address seen by the memory unit</li>
</ul>
<p>Logical and physical addresses are the <strong>same</strong> in <strong>compile-time and load-time</strong> address-binding schemes</p>
<p>Logical (virtual) and physical addresses <strong>differ</strong> in <strong>execution time</strong> address-binding scheme</p>
<h5 id="memory-management-unit-mmu">Memory-Management Unit (MMU)<a class="headerlink" href="#memory-management-unit-mmu" title="Permanent link">&para;</a></h5>
<p>Hardware device that maps virtual to physical address 硬件 实现地址转换</p>
<p>The user program deals with logical addresses; it never sees the real physical addresses</p>
<h4 id="linking">链接 Linking<a class="headerlink" href="#linking" title="Permanent link">&para;</a></h4>
<h5 id="dynamic-linking">Dynamic Linking<a class="headerlink" href="#dynamic-linking" title="Permanent link">&para;</a></h5>
<p>动态链接</p>
<p>Linking postponed until execution time</p>
<ul>
<li>Small piece of code, <strong>stub 桩</strong>, used to locate the appropriate memory-resident library routine</li>
<li>Stub replaces itself with the address of the routine, and executes the routine</li>
</ul>
<p>Dynamic linking is particularly useful for libraries 共享库里的函数只用存一次</p>
<ul>
<li>Saves main memory space</li>
<li>Reduces size of exe image file</li>
<li>Relinking of new library not needed</li>
</ul>
<h5 id="static-linking">static linking<a class="headerlink" href="#static-linking" title="Permanent link">&para;</a></h5>
<p>静态链接</p>
<ul>
<li>运行前将库函数和程序等链接成一个完整的装入模块</li>
</ul>
<h4 id="loading">装入 Loading<a class="headerlink" href="#loading" title="Permanent link">&para;</a></h4>
<h5 id="dynamic-loading">Dynamic Loading<a class="headerlink" href="#dynamic-loading" title="Permanent link">&para;</a></h5>
<p>动态装入：程序用到了再装进内存</p>
<ul>
<li>Better memory-space utilization; unused routine is never loaded</li>
<li>装入内存时地址均为相对地址；执行时再绑定地址</li>
<li>优点：可以将程序分配到不连续的储存区，运行期间可以动态申请分配内存</li>
</ul>
<h5 id="static-loading">Static loading<a class="headerlink" href="#static-loading" title="Permanent link">&para;</a></h5>
<p>静态装入：把程序全部装入内存</p>
<ul>
<li>地址在装入时转换（绝对地址），装入后程序在内存中不能移动，也不能再申请空间</li>
</ul>
<h4 id="_30">总结<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<p><strong>程序的链接与装入</strong></p>
<ul>
<li>编译</li>
<li>从高级语言到目标模块的过程 ( 实际是预处理、编译、汇编三个阶段的统称 ) </li>
<li>
<p>本质是一些机器可以“看懂”的 0/1 指令和数据文件</p>
</li>
<li>
<p>链接</p>
</li>
<li>把编译后的目标模块与所需库函数链接在一起形成一个整体</li>
<li>静态链接、装入时动态链接、运行时动态链接</li>
<li>
<p>形成逻辑地址</p>
</li>
<li>
<p>装入</p>
</li>
<li>将虚拟地址映射为内存实际的物理地址</li>
<li>绝对装入、静态重定位 ( 可重定位装入 ) 、动态重定位 ( 动态运行时装入 )</li>
</ul>
<hr />
<p>进程内存映像 image</p>
<ul>
<li>代码段</li>
<li>只读代码段 <code>.init</code> <code>.text</code>(用户程序机器码) <code>.rodata</code></li>
<li>数据段</li>
<li>
<p><code>.data</code>(已初始化的全局变量和静态变量) <code>.bss</code>(未初始化和所有初始化为 0 的全局变量和静态变量)</p>
</li>
<li>
<p>进程控制块 PCB</p>
</li>
<li>堆</li>
<li>栈</li>
</ul>
<h3 id="contiguous-memory-allocation">连续分配 Contiguous Memory Allocation<a class="headerlink" href="#contiguous-memory-allocation" title="Permanent link">&para;</a></h3>
<p>Relocation register 可重定位寄存器 contains value of smallest <span style="color:#00CC00;"> physical address </span></p>
<p>单一连续分配，用户程序独占用户区</p>
<ul>
<li>简单、无外部碎片</li>
<li>只能用于单用户、单操作系统，有内部碎片、储存器的利用率低</li>
</ul>
<p>Limit register contains range of logical addresses – each logical address must be less than the limit register</p>
<p>MMU maps logical address dynamically</p>
<p><strong>多分区分配 Multi</strong></p>
<ul>
<li>
<p>固定分区 fixed partitioning：如果内存大程序小，浪费资源</p>
</li>
<li>
<p>动态分区 dynamic partition</p>
</li>
<li>
<p>Hole – block of available memory; holes of various size are scattered throughout memory</p>
</li>
<li>
<p>When a process arrives, it is allocated memory from a hole large enough to accommodate it</p>
</li>
<li>
<p>Operating system maintains information about: a) allocated partitions b) free partitions (hole)</p>
</li>
</ul>
<h4 id="dynamic-storage-allocation-problem">动态分配的算法 Dynamic storage-allocation problem<a class="headerlink" href="#dynamic-storage-allocation-problem" title="Permanent link">&para;</a></h4>
<p>基于顺序搜索的分配算法：</p>
<p><strong>FF(First Fit)</strong>：Allocate the first hole that is big enough 按顺序第一个放得下的洞；空闲分区按地址递增的次序排列</p>
<p><strong>NF(Next Fit)</strong>：下一个放的下的洞</p>
<p><strong>BF(Best Fit)</strong>： Allocate the smallest hole that is big enough; must search entire list, unless ordered by size 最小能放得下的洞，会产生一些小碎片（tiny leftover holes）最容易产生碎片</p>
<ul>
<li>空闲分区按容量递增的次序排列</li>
</ul>
<p><strong>WF(Worst Fit)</strong>：Allocate the largest hole; must also search entire list 最大的洞，会产生一些大碎片（large leftover holes）</p>
<ul>
<li>空闲分区按容量递减的次序排列</li>
</ul>
<blockquote>
<p>[!NOTE]</p>
<p>First-fit and best-fit better than worst-fit in terms of speed and storage utilization</p>
</blockquote>
<h4 id="fragmentation">Fragmentation<a class="headerlink" href="#fragmentation" title="Permanent link">&para;</a></h4>
<p><strong>External Fragmentation 外部碎片</strong>– total memory space exists to satisfy a request, but it is not contiguous</p>
<p><strong>Internal Fragmentation 内部碎片</strong>(refer to the textbook p287) – allocated memory may be slightly larger than requested memory; this size difference is memory internal to a partition, but not being used</p>
<p><strong>Reduce external fragmentation by compaction/defragmentation</strong> 通过压缩减少外部碎片</p>
<ul>
<li>Shuffle memory contents to place all free memory together in one large block</li>
<li>Compaction is possible <em>only if</em> <span style="color:#CC0066;"> relocation is dynamic </span>, and is done at execution time</li>
<li>I/O problem I/O 操作时也不允许进行压缩</li>
<li>Latch job in memory while it is involved in I/O</li>
<li>Do I/O only into OS buffers</li>
<li>Another solution to external frag. is non-contiguous allocation</li>
</ul>
<h3 id="paging">分页 Paging<a class="headerlink" href="#paging" title="Permanent link">&para;</a></h3>
<p>分页存储管理</p>
<p>Logical address space of a process can be noncontiguous 逻辑地址可以不连续; process is allocated physical memory whenever the latter is available</p>
<p>Divide physical memory into fixed-sized blocks called <strong>frames</strong>(size is power of 2, between 512 bytes and 8,192 bytes)
Divide logical memory into blocks of same size called <strong>pages</strong></p>
<p>To run a program of size n pages, need to find n free frames and load program</p>
<p>分页通过硬件机制实现</p>
<h4 id="address-translation-scheme">Address Translation Scheme<a class="headerlink" href="#address-translation-scheme" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241120144532930.png" alt="image-20241120144532930" style="zoom: 33%;" /></p>
<p>页号、页面偏移</p>
<p>地址转换</p>
<p><img src="./assets/image-20241125100730054.png" alt="image-20241125100730054" style="zoom: 33%;" /></p>
<blockquote>
<p>为了将虚拟地址转换为物理地址，需要结合虚拟地址的页号和页内偏移，以及页表中页号与页框号的映射关系。以下是计算步骤：</p>
<h3 id="_31">已知条件<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>页面大小</strong> = <span class="arithmatex">\(<span class="arithmatex">\(4 \, \text{KB} = 2^{12} = 4096 \, \text{bytes}\)</span>\)</span>，页号用高 20 位，页内偏移用低 12 位表示。</li>
<li>虚拟地址：
   - 2362H =  <span class="arithmatex">\(9026_{10}\)</span>
   - 1565H = <span class="arithmatex">\(5477_{10}\)</span></li>
<li>页表：
   - 页号 0 → 页框号 101H
   - 页号 1 → 页框号 102H
   - 页号 2 → 页框号 254H</li>
</ol>
<hr />
<h3 id="_32">转换步骤<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<h4 id="1">1. 计算虚拟地址的页号和页内偏移<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[\text{页号} = \left\lfloor \frac{\text{虚拟地址}}{\text{页面大小}} \right\rfloor$$, $$\quad \text{页内偏移} = \text{虚拟地址} \mod \text{页面大小}\]</div>
<ul>
<li><strong>2362H</strong>： <span class="arithmatex">\(<span class="arithmatex">\(\text{页号} = \left\lfloor \frac{9026}{4096} \right\rfloor = 2\)</span>\)</span>, <span class="arithmatex">\(<span class="arithmatex">\(\quad \text{页内偏移} = 9026 \mod 4096 = 1834\)</span>\)</span></li>
<li><strong>1565H</strong>： <span class="arithmatex">\(<span class="arithmatex">\(\text{页号} = \left\lfloor \frac{5477}{4096} \right\rfloor = 1\)</span>\)</span>, <span class="arithmatex">\(<span class="arithmatex">\(\text{页内偏移} = 5477 \mod 4096 = 1381\)</span>\)</span></li>
</ul>
<h4 id="2">2. 根据页表找到对应页框号<a class="headerlink" href="#2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>页号 2</strong> → 页框号 254H</li>
<li><strong>页号 1</strong> → 页框号 102H</li>
</ul>
<p>页框号左移 12 位（乘以 4096），再加上页内偏移，得到物理地址。</p>
<hr />
<h4 id="3">3. 计算物理地址<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>2362H（页号 2，页框号 254H）</strong>：<span class="arithmatex">\(<span class="arithmatex">\(\text{物理地址} = \text{页框号} \times 4096 + \text{页内偏移}\)</span>\)</span>，<span class="arithmatex">\(<span class="arithmatex">\(\text{物理地址} = 254H \times 4096 + 1834 = 254000H + 072A = 25472AH\)</span>\)</span></li>
<li><strong>1565H（页号 1，页框号 102H）</strong>：<span class="arithmatex">\(<span class="arithmatex">\(\text{物理地址} = 102H \times 4096 + 1381 = 102000H + 0565 = 1020565H\)</span>\)</span></li>
</ul>
<hr />
<h3 id="_33">结果<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<ol>
<li>虚拟地址 2362H → 物理地址 25472AH</li>
<li>虚拟地址 1565H → 物理地址 1020565H</li>
</ol>
</blockquote>
<h4 id="page">Page<a class="headerlink" href="#page" title="Permanent link">&para;</a></h4>
<p>TablePage table is kept in main memory</p>
<p><strong>Page-table base register (PTBR)</strong> points to the page table
<strong>Page-table length register (PTLR)</strong> indicates size of the page table
In this scheme every data/instruction access requires <strong>two</strong> memory accesses. One for the page table and one for the data/instruction.</p>
<blockquote>
<p>[!NOTE]</p>
<p>Pagetable 放在内存里，访问逻辑地址要访问两次内存</p>
</blockquote>
<p>The two-memory-access problem can be solved by the use of a special fast-lookup hardware cache called associative memory or translation look-aside buffers (<strong>TLB</strong> s 转换旁视缓冲 , 一称快表 )</p>
<h4 id="paging-hardware-with-tlb">Paging Hardware With TLB<a class="headerlink" href="#paging-hardware-with-tlb" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241120150234672.png" alt="image-20241120150234672" style="zoom:50%;" /></p>
<h4 id="effective-access-time">Effective Access Time<a class="headerlink" href="#effective-access-time" title="Permanent link">&para;</a></h4>
<p>TLB 快表命中率（EAT）
$$
EAT = (M + \varepsilon) \times \alpha + (2M +\varepsilon)\times(1 – \alpha)
$$</p>
<p>Associative Lookup 查 TLB 时间  <span class="arithmatex">\(\varepsilon\)</span> </p>
<p>Assume memory cycle time 访问内存时间 <span class="arithmatex">\(M\)</span> </p>
<p>Hit ratio – percentage of times that a page number is found in the associative registers; ratio related to number of associative registers</p>
<p>Hit ratio = <span class="arithmatex">\(\alpha\)</span>​</p>
<p>例子：<img src="../images/image-20241120150846991.png" alt="image-20241120150846991" style="zoom:50%;" /></p>
<h4 id="memory-protection-in-paged-scheme">Memory Protection in Paged Scheme<a class="headerlink" href="#memory-protection-in-paged-scheme" title="Permanent link">&para;</a></h4>
<p>内存保护</p>
<p>Valid-invalid bit attached to each entry in the page table</p>
<h4 id="shared-pages">Shared Pages<a class="headerlink" href="#shared-pages" title="Permanent link">&para;</a></h4>
<p><strong>Shared code</strong>：One copy of <span style="color:#CC0066;"> read-only </span> (reentrant) code shared among processes (i.e., text editors, compilers, window systems)；</p>
<p>Shared code must appear in <span style="color:#CC0066;"> same location in the logical address space </span> of all processes 逻辑地址一样在 TLB 只用存一次</p>
<h3 id="structure-of-the-page-table">Structure of the Page Table<a class="headerlink" href="#structure-of-the-page-table" title="Permanent link">&para;</a></h3>
<h4 id="hierarchical-paging">Hierarchical Paging 分级页表/多级页表<a class="headerlink" href="#hierarchical-paging" title="Permanent link">&para;</a></h4>
<p>两级页表</p>
<p><img src="./assets/image-20241120152043420.png" alt="image-20241120152043420" style="zoom:50%;" /></p>
<p>p1-&gt; outer page table -- p2 -&gt; page of page table -- d -&gt; real physical address </p>
<p>64 = 42+10+12, 32 = 12+10+10</p>
<blockquote>
<p>[!NOTE]</p>
<p><strong>Page-table base register (PTBR)</strong> ？</p>
<p><strong>What are the benefits of the hierarchical page</strong>? 节省内存（pagetable 的内存空间）</p>
</blockquote>
<h4 id="hashed-page-tables">Hashed Page Tables<a class="headerlink" href="#hashed-page-tables" title="Permanent link">&para;</a></h4>
<p>Variation for 64-bit addresses is the <strong>clustered page table</strong></p>
<p><img src="./assets/image-20241120153044232.png" alt="image-20241120153044232" style="zoom:50%;" /></p>
<p>哈希优点：快，hashtable 比 pagetable 小</p>
<h4 id="inverted-page-tables">倒排页表 Inverted Page Tables<a class="headerlink" href="#inverted-page-tables" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241120153453098.png" alt="image-20241120153453098" style="zoom:50%;" /></p>
<p>缺点：慢；好处：只有一个 pagetable</p>
<p>Search is slow, so put page table entries into a hash table. TLB can be used to speed up hash-table reference.</p>
<h4 id="_34">页表项计算<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h4>
<p><img src="././assets/image-20241229131108605.png" alt="image-20241229131108605" style="zoom:50%;" /></p>
<h3 id="swapping">Swapping<a class="headerlink" href="#swapping" title="Permanent link">&para;</a></h3>
<p>A process can be swapped temporarily out of memory to a backing store, and then brought back into memory for continued execution 进程可以暂时从内存交换到备用存储器，然后再返回到内存中继续执行
<strong>Backing store 交换区</strong> – fast disk large enough to accommodate copies of all memory images for all users; must provide direct access to these memory images 足够大的快速磁盘，可以容纳所有用户的所有内存映像的副本；必须提供对这些内存映像的直接访问</p>
<p><img src="./assets/image-20241120154044395.png" alt="image-20241120154044395" style="zoom:50%;" /></p>
<h3 id="segmentation">分段 Segmentation<a class="headerlink" href="#segmentation" title="Permanent link">&para;</a></h3>
<p>Memory-management scheme that supports user view of memory </p>
<p><strong>Segment table</strong> – maps two-dimensional physical addresses; each table entry has: </p>
<ul>
<li>
<p><strong>base</strong> – contains the starting physical address where the segments reside in memory</p>
</li>
<li>
<p><strong>limit</strong> – specifies the length of the segment</p>
</li>
</ul>
<p><strong>Segment-table base register (STBR)</strong> points to the segment table’s location in memory 段表中每个块对应的起始物理地址</p>
<p><strong>Segment-table length register (STLR)</strong> indicates number of segments used by a program</p>
<ul>
<li>segment number <strong>s</strong> is legal if <strong>s</strong> &lt; <strong>STLR</strong></li>
</ul>
<p>使用动态内存分配</p>
<p>引入段式存储管理方式，主要是为了满足用户的下列要求：</p>
<ul>
<li>方便编程、分段共享、分段保护、动态链接和动态增长</li>
</ul>
<p><img src="./assets/image-20241120154721954.png" alt="image-20241120154721954" style="zoom:50%;" /></p>
<p>非连续分配</p>
<ul>
<li>每个进程都有一张段表，每个段表项对应进程中的一段</li>
</ul>
<p>分段管理保护</p>
<ul>
<li>存取控制保护</li>
<li>地址越界保护</li>
</ul>
<p>在 <strong>段式分配</strong> 中，取一次数据时先从内存查找段表，再拼成物理地址后访问内存，共需要 2 次内存访问。</p>
<p>在 <strong>段页式分配</strong> 中，取一次数据时先从内存查找段表，再访问内存查找相应的页表，最后拼成物理地址后访问内存，共需要 3 次内存访问。</p>
<h3 id="example-the-intel-pentium">Example: The Intel Pentium<a class="headerlink" href="#example-the-intel-pentium" title="Permanent link">&para;</a></h3>
<p>奔腾处理器</p>
<p>Supports both segmentation and segmentation with paging 段页混合，先分段再分页</p>
<p>linear address: 32 offset</p>
<p><img src="./assets/image-20241125104027505.png" alt="image-20241125104027505" style="zoom:50%;" /></p>
<h4 id="intel-pentium-segmentation">Intel Pentium Segmentation<a class="headerlink" href="#intel-pentium-segmentation" title="Permanent link">&para;</a></h4>
<p>根据段号找页表基址，根据分页的 va（页框号）找到页号，两者拼接</p>
<p>Local Descriptor Table contains entries for the segments local to each program itself; 
Global Descriptor Table contains entries of the system (OS).</p>
<hr />
<p><strong>分段</strong> 式存储管理方法有利于程序的 <strong>动态链接</strong></p>
<p>操作系统实现 <strong>分区</strong> 存储管理的代价最小</p>
<p>存储管理方式中，只要是固定的分配就会产生内部碎片，其余的都会产生外部碎片。若固定和不固定同时存在(例如段页式)，则仍视为固定。</p>
<h2 id="virtual-memory">Virtual Memory 虚拟内存<a class="headerlink" href="#virtual-memory" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>虚拟内存基本概念：定义、好处</p>
<ul>
<li>按需分页、分段</li>
</ul>
<p>请求页式管理：</p>
<ul>
<li>好处</li>
<li>逻辑地址转换</li>
<li>page fault 缺页中断处理</li>
<li>缺页有效访问时间</li>
<li>页面替换</li>
<li>页面替换算法（FIFO OPTIMAL LRU CLOCK ENAHNCED CLOCK）</li>
<li>帧的分配和置换策略、抖动、工作集</li>
</ul>
<p>kernel 内存分配</p>
</blockquote>
<h3 id="background_2">Background<a class="headerlink" href="#background_2" title="Permanent link">&para;</a></h3>
<p><strong>Virtual memory</strong> – separation of user logical memory from physical memory 虚拟内存不是物理对象，而是指内核提供的用于管理物理内存和虚拟地址的抽象和机制的集合</p>
<ul>
<li>Only <strong>part</strong> of the program needs to be in memory for execution 作业不必全部装入内存</li>
<li>Logical address space can therefore be much <strong>larger</strong> than physical address space 逻辑地址可以比物理地址大很多</li>
<li>Allows address spaces to be <strong>shared</strong> by several processes 地址空间可以被多个进程共享</li>
<li>Allows for more efficient process <strong>creation</strong></li>
</ul>
<blockquote>
<p>非虚拟存储器：作业在运行前必须全部装入内存，且在运行过程中也一直驻留内存</p>
<p>虚拟存储器：作业在运行前不必全部装入内存，且在运行过程中也不必一直驻留内存</p>
</blockquote>
<p>Virtual memory can be implemented via 虚拟内存的实现：</p>
<ul>
<li>
<p><strong>Demand paging 请求式分页</strong></p>
</li>
<li>
<p><strong>Demand segmentation 请求式分段</strong></p>
</li>
</ul>
<hr />
<h4 id="principle-of-locality">principle of locality<a class="headerlink" href="#principle-of-locality" title="Permanent link">&para;</a></h4>
<p><strong>局部性原理 (principle of locality)</strong>: 指程序在执行过程中的一个较短时期所执行的指令地址和指令的操作数地址，分别局限于一定区域。</p>
<ul>
<li>时间局部性 : 一条指令的一次执行和下次执行，一个数据的一次访问和下次访问都集中在一个较短时期内 ; </li>
<li>空间局部性 : 当前指令和邻近的几条指令，当前访问的数据和邻近的数据都集中在一个较小区域内。</li>
<li>虚拟存储器是具有请求调入功能和置换功能，仅把进程的一部分装入内存便可运行进程的存储管理系统，它能从逻辑上对内存容量进行扩充的一种虚拟的存储管理系统。</li>
<li>虚拟存储器只能基于非连续分配——os 虚拟技术中的空分复用技术</li>
</ul>
<hr />
<p>虚拟内存其他优点：</p>
<ul>
<li>System libraries can be shared by several processes through mapping of the shared object into a virtual address space 通过将共享对象映射到虚拟地址空间，系统库可由多个进程共享</li>
<li>Shared memory is enabled 共享内存</li>
<li>Pages can be shared during process creation (speeds up creation) 可在进程创建期间共享页面（加快创建速度）</li>
</ul>
<h4 id="process-creation_1">Process Creation<a class="headerlink" href="#process-creation_1" title="Permanent link">&para;</a></h4>
<p>Virtual memory allows other benefits during process creation:
- <strong>Copy-on-Write(COW) 写时复制</strong>：CoW 的主要目的是减少内存使用和提高性能，通过延迟实际的内存
  复制，直到某个进程尝试修改内存内容时才进行复制（省时间和空间）
- <strong>Memory-Mapped Files (later)</strong>: 将文件内容映射到进程的地址空间的技术。通过内存映射文件，可以像访问内存一样访问文件内容，而无需显式地进行读写操作。这种技术在处理大文件、提高文件访问性能以及实现进程间通信等方面非常有用</p>
<h3 id="demand-paging">Demand Paging<a class="headerlink" href="#demand-paging" title="Permanent link">&para;</a></h3>
<p>请求调页，需要时将页面放到内存</p>
<p>Bring a page into memory only when it is needed</p>
<ul>
<li>
<p>Less I/O needed</p>
</li>
<li>
<p>Less memory needed </p>
</li>
<li>
<p>Faster response</p>
</li>
<li>
<p>More users</p>
</li>
<li>
<p>Page is needed =&gt; reference to it</p>
</li>
<li>
<p>invalid reference =&gt; abort</p>
</li>
<li>
<p>not-in-memory =&gt; bring to memory</p>
</li>
<li>
<p>Lazy swapper – never swaps a page into memory unless page will be needed</p>
</li>
<li>Swapper that deals with pages is a pager</li>
</ul>
<p>Transfer of a Paged Memory to Contiguous Disk Space 连续分配</p>
<h4 id="valid-invalid-bit">Valid-Invalid Bit<a class="headerlink" href="#valid-invalid-bit" title="Permanent link">&para;</a></h4>
<p>With each page table entry a valid–invalid bit is associated (<strong>v</strong>: in-memory, <strong>i</strong>: not-in-memory)</p>
<ul>
<li>Initially valid–invalid bit is set to i on all entries</li>
<li>During address translation, if valid–invalid bit in page table entry is <strong>i</strong> =&gt; <strong>page fault</strong> (a trap to the OS 缺页中断)</li>
</ul>
<p><img src="./assets/image-20241125112104401.png" alt="image-20241125112104401" style="zoom: 33%;" /></p>
<h4 id="page-fault">Page Fault<a class="headerlink" href="#page-fault" title="Permanent link">&para;</a></h4>
<p>If there is a reference to a page, first reference to that page will trap to operating system: <strong>page fault</strong></p>
<p>缺页处理流程：</p>
<ol>
<li>Operating system looks at <span style="color:#CC0000;"> another table </span> (kept with PCB) to decide:
  - Invalid reference =&gt; abort
  - Just not in memory</li>
<li>Get empty frame</li>
<li>Swap page into frame</li>
<li>Reset tables 磁盘内部表和页表</li>
<li>Set <code>validation bit = v</code></li>
<li>Restart the instruction that caused the page fault</li>
<li>中断后恢复 block move</li>
<li>auto increment/decrement location</li>
</ol>
<blockquote>
<p>页面替换不是必须的</p>
</blockquote>
<hr />
<p>What’s the state of the process that has page fault?</p>
<hr />
<h4 id="performance-of-demand-paging">Performance of Demand Paging<a class="headerlink" href="#performance-of-demand-paging" title="Permanent link">&para;</a></h4>
<p>Page Fault Rate 0 ≤ p ≤ 1.0
- if p = 0 no page faults 
- if p = 1, every reference is a fault</p>
<p><strong>Effective Access Time (EAT)</strong>
EAT = (1 – p) × memory access + p (page fault overhead + swap page out + swap page in + restart overhead)</p>
<p>例子：</p>
<p><img src="./assets/image-20241125113529011.png" alt="image-20241125113529011" style="zoom: 33%;" /></p>
<blockquote>
<p>[!NOTE]</p>
<p>请求分页存储管理中，若把页面尺寸增大，那么页帧数减小，缺页中断次数也会减少</p>
</blockquote>
<h3 id="copy-on-write">Copy-on-Write<a class="headerlink" href="#copy-on-write" title="Permanent link">&para;</a></h3>
<p>Copy-on-Write (COW) allows both parent and child processes to initially share the same pages in memory</p>
<p>If either process modifies a shared page, only then is the page copied</p>
<p>COW allows more efficient process creation as only modified pages are copied</p>
<p>Free pages are allocated from a <strong>pool</strong> of zeroed-out pages</p>
<p>CoW 的主要目的是减少内存使用和提高性能，通过延迟实际的内存复制，直到某个进程尝试修改内存内容时才进行复制</p>
<h3 id="page-replacement">Page Replacement<a class="headerlink" href="#page-replacement" title="Permanent link">&para;</a></h3>
<h4 id="page-replacement_1">Page replacement<a class="headerlink" href="#page-replacement_1" title="Permanent link">&para;</a></h4>
<p>如果没有空闲帧 free frame：</p>
<p><strong>Page replacement 页面替换</strong> – find some page in memory, but not really in use, swap it out</p>
<ul>
<li>algorithm 页面替换算法</li>
<li>performance – want an algorithm which will result in minimum number of page faults</li>
<li>Same page may be brought into memory several times</li>
</ul>
<p>好处：</p>
<ul>
<li>Prevent over-allocation of memory by modifying page-fault service routine to include page replacement</li>
<li>Use <strong>modify (dirty) bit 脏位</strong> to reduce overhead of page transfers – only modified pages are written to disk</li>
<li>Page replacement completes separation between logical memory and physical memory – large virtual memory can be provided on a smaller physical memory</li>
</ul>
<p>实际上不是等到没有空闲帧的时候进行替换，操作系统会提前做</p>
<p><img src="./assets/image-20241127143706318.png" alt="image-20241127143706318" style="zoom: 33%;" /></p>
<h4 id="page-replacement-algorithms">Page Replacement Algorithms<a class="headerlink" href="#page-replacement-algorithms" title="Permanent link">&para;</a></h4>
<p>Want lowest page-fault rate 最低缺页率</p>
<p>输入：引用串 reference string；输出：缺页的次数 number of page faults on that string</p>
<blockquote>
<p>[!NOTE]</p>
<p><strong>内存无限大，缺页会无线趋近于零吗</strong>？不会，趋于一个常数，缺页次数随着内存变大会变小</p>
</blockquote>
<h5 id="first-in-first-out-fifo-algorithm">First-In-First-Out (FIFO) Algorithm<a class="headerlink" href="#first-in-first-out-fifo-algorithm" title="Permanent link">&para;</a></h5>
<p>先进先出算法</p>
<p>Belady</p>
<p><img src="./assets/image-20241127145037198.png" alt="image-20241127145037198" style="zoom: 40%;" /></p>
<h5 id="optimal-algorithm">Optimal Algorithm<a class="headerlink" href="#optimal-algorithm" title="Permanent link">&para;</a></h5>
<p><strong>最佳置换算法</strong> 缺页次数最小 =&gt; optimal</p>
<p>替换将来最长不使用的 page Replace page that will not be used for longest period of time</p>
<p><img src="./assets/image-20241127145836832.png" alt="image-20241127145836832" style="zoom:40%;" /></p>
<h5 id="least-recently-used-lru-algorithm">Least Recently Used (LRU) Algorithm<a class="headerlink" href="#least-recently-used-lru-algorithm" title="Permanent link">&para;</a></h5>
<p><strong>最近最久未使用</strong> 置换算法：选择内存中最久没有引用的页面被置换。这是局部性原理的合理近似，性能接近最佳算法。但由于需要记录页面使用时间，硬件开销太大。</p>
<p><img src="./assets/image-20241127145959957.png" alt="image-20241127145959957" style="zoom:40%;" /></p>
<h5 id="lru-algorithm">LRU Algorithm<a class="headerlink" href="#lru-algorithm" title="Permanent link">&para;</a></h5>
<p>以下三种方法都是通过硬件实现</p>
<p>Counter implementation：每次引用时钟+1</p>
<p>Stack implementation：设置一个特殊的栈，把被访问的页面移到栈顶，于是栈底的是最久未使用页面。</p>
<p>移位寄存器 : 被访问时左边最高位置 1 ，定期右移并且最高位补 0 ，于是寄存器数值最小的是最久未使用页面。 (AdditionalReference-Bits Algorithm 附加引用位算法 )</p>
<h5 id="lru-approximation-algorithms">LRU Approximation Algorithms<a class="headerlink" href="#lru-approximation-algorithms" title="Permanent link">&para;</a></h5>
<p>又叫 second chance algorithm，clock algorithm</p>
<p>reference bit</p>
<ul>
<li>当访问到 page，bit = 1，周期内被访问过至少一次；bit = 0，较长时间内没被访问过，替换出去</li>
</ul>
<p>second chance</p>
<h5 id="enhanced-second-chance-algorithm">Enhanced second chance Algorithm<a class="headerlink" href="#enhanced-second-chance-algorithm" title="Permanent link">&para;</a></h5>
<p>使用引用位和修改位 (reference bit, modified bit)，引用过或者修改过置为 1 记录每个页面被引用的次数</p>
<p>淘汰次序：(0,0) &gt; (0,1) &gt; (1,0) &gt; (1,1)</p>
<p>基本思想：</p>
<p>第 1 轮扫描 : 查找 (0, 0) ，不做修改
第 2 轮扫描 : 查找 (0, 1) ，修改访问位为 0 
第 3 轮扫描 : 查找 (0, 0) ，不做修改
第 4 轮扫描 : 查找 (0, 1)</p>
<h5 id="counting-based-algorithms">Counting-based Algorithms<a class="headerlink" href="#counting-based-algorithms" title="Permanent link">&para;</a></h5>
<p>Keep a counter of the number of references that have been made to each page </p>
<ul>
<li><strong>LFU Algorithm</strong>: replaces page with smallest count 使用次数最少的页面置换出去</li>
<li><strong>MFU Algorithm(most frequently used)</strong>: based on the argument that the page with the smallest count was probably just brought in and has yet to be used 使用次数最多的页面置换出去</li>
</ul>
<h5 id="page-buffering-algorithm">Page Buffering Algorithm 页面缓冲算法<a class="headerlink" href="#page-buffering-algorithm" title="Permanent link">&para;</a></h5>
<p>通过被置换页面的缓冲，有机会找回刚被置换的页面</p>
<p>被置换页面的选择和处理：用 FIFO 算法选择被置换页，把被置换的页面放入两个链表之一，如果页面未被修改，就将其归入到 <strong>空闲页面链表</strong> 的末尾，否则将其归入到 <strong>已修改页面链表</strong>。 </p>
<p>需要调入新的页面时：将新页面内容读入到空闲页面链表的第一项所指的页面，然后将第一项删除。 
空闲页面和已修改页面，仍停留在内存中一段时间，如果这些页面被再次访问，这些页面还在内存中。
当已修改页面达到一定数目后，再将它们一起调出到外存，然后将它们归入空闲页面链表。</p>
<p>实际中，Windows 、 Linux 页面置换算法是基于 <strong>页面缓冲算法</strong></p>
<h3 id="allocation-of-frames">Allocation of Frames<a class="headerlink" href="#allocation-of-frames" title="Permanent link">&para;</a></h3>
<p>分配：Each process needs minimum number of pages － usually determined by computer architecture</p>
<h4 id="fixed-allocation">Fixed Allocation 固定分配<a class="headerlink" href="#fixed-allocation" title="Permanent link">&para;</a></h4>
<p>Equal allocation 等分</p>
<p>Proportional allocation – Allocate according to the size of process 按进程比例分配</p>
<h4 id="priority-allocation">Priority Allocation 优先级分配<a class="headerlink" href="#priority-allocation" title="Permanent link">&para;</a></h4>
<p>Use a proportional allocation scheme using priorities rather than size</p>
<p>If process Pi generates a page fault,</p>
<ul>
<li>select for a replacement one of its frames</li>
<li>select for replacement a frame from a process with a lower priority number</li>
</ul>
<h4 id="global-vs-local-allocation">Global vs. Local Allocation<a class="headerlink" href="#global-vs-local-allocation" title="Permanent link">&para;</a></h4>
<p><strong>Global replacement</strong> 全局替换– process selects a replacement frame from the set of all frames; one process can take a frame from another</p>
<p><strong>Local replacement</strong> 本地替换– each process selects from only its own set of allocated frames</p>
<p>Problem with global replacement 问题: unpredictable page-fault rate. Cannot control its own page-fault rate. </p>
<p>More common Problem with local replacement: free frames are not available for others. – Low throughput</p>
<p>固定分配、全局置换不能组合使用</p>
<h3 id="thrashing">Thrashing 抖动、颠簸<a class="headerlink" href="#thrashing" title="Permanent link">&para;</a></h3>
<blockquote>
<p>所有页面置换策略都可能引起抖动</p>
</blockquote>
<p>If a process does not have “enough” pages, the page-fault rate is very high. This leads to:</p>
<ul>
<li>low CPU utilization</li>
<li>Queuing at the paging device, the ready queue becomes empty</li>
<li>operating system thinks that it needs to increase the degree of multiprogramming</li>
<li>another process added to the system 循环</li>
</ul>
<p><strong>Thrashing</strong>：a process is busy swapping pages in and out 忙于页面替换，内存不够</p>
<p>Thrashing 解决方法 : </p>
<ul>
<li>增加物理内存</li>
<li>优化页面置换算法</li>
<li>在 cpu 调度中引入工作集算法</li>
<li>动态调整进程的内存分配</li>
<li>限制并发进程数</li>
<li>内存压缩</li>
</ul>
<hr />
<h4 id="demand-paging-and-thrashing">Demand Paging and Thrashing<a class="headerlink" href="#demand-paging-and-thrashing" title="Permanent link">&para;</a></h4>
<p>Why does demand paging work?
Locality model 局部性
- Process migrates from one locality to another
- Localities may overlap</p>
<p>Why does thrashing occur? </p>
<ul>
<li>size of locality &gt; total memory size</li>
</ul>
<p>To limit the effect of thrashing:  local replacement algo cannot steal frames from other processes. But queue in page device 
increases effective access time. </p>
<p>To prevent thrashing: allocate memory to accommodate its locality</p>
<h4 id="working-set-model">Working-Set Model 工作集<a class="headerlink" href="#working-set-model" title="Permanent link">&para;</a></h4>
<p>△ ≡ working-set window: a fixed number of page references</p>
<p>m = total available frames</p>
<p>WSSi (working set size of Process Pi ) = total number of pages referenced in the most recent  (varies </p>
<p>in time)</p>
<p>D = WSSi （total demand frames for all processes in the system</p>
<p>if D &gt; m，Thrashing</p>
<p>Policy if D &gt; m, then suspend one of the processes</p>
<p><img alt="image-20241202112051748" src="assets/image-20241202112051748.png" /></p>
<h4 id="page-fault-frequency-scheme">Page-Fault Frequency Scheme<a class="headerlink" href="#page-fault-frequency-scheme" title="Permanent link">&para;</a></h4>
<p>Establish “acceptable” page-fault rate for each process 调节 frame 数控制 page fault</p>
<ul>
<li>
<p>If actual rate too low, process loses frame</p>
</li>
<li>
<p>If actual rate too high, process gains frame</p>
</li>
</ul>
<p><img src="./assets/image-20241202101952067.png" alt="image-20241202101952067" style="zoom:50%;" /></p>
<h3 id="memory-mapped-files">内存映射文件 Memory-Mapped Files<a class="headerlink" href="#memory-mapped-files" title="Permanent link">&para;</a></h3>
<p>Simplifies file access by treating file I/O through memory rather than <strong>read() write()</strong> system calls</p>
<p>Also allows several processes to map the same file allowing the pages in memory to be shared</p>
<p><img src="./assets/image-20241202102258495.png" alt="image-20241202102258495" style="zoom:50%;" /></p>
<p>内存映射文件可以通过修改内存中的数据来实现对文件的写操作</p>
<h3 id="allocating-kernel-memory">Allocating Kernel Memory<a class="headerlink" href="#allocating-kernel-memory" title="Permanent link">&para;</a></h3>
<p>reated differently from user memory</p>
<p>Often allocated from a free-memory pool</p>
<ul>
<li>
<p>Kernel requests memory for structures of varying sizes – needs to reduce fragmentation</p>
</li>
<li>
<p>Some kernel memory needs to be contiguous (certain h/w device interacts with contiguous physical memory)</p>
</li>
</ul>
<p>Therefore, many systems do NOT utilize paging for kernel code and data.</p>
<h4 id="buddy-system">Buddy System （伙伴系统）<a class="headerlink" href="#buddy-system" title="Permanent link">&para;</a></h4>
<p>Allocates memory from fixed-size segment consisting of physically contiguous pages</p>
<p>Memory allocated using <strong>power-of-2 allocator</strong> 32 64 128 256</p>
<p>Linux 内存管理子系统采用基于内存区域 <strong>伙伴算法</strong> 来管理物理页帧的分配和回收</p>
<h4 id="slab-allocator">Slab Allocator<a class="headerlink" href="#slab-allocator" title="Permanent link">&para;</a></h4>
<p><strong>Slab</strong> is one or more physically contiguous pages-- 是一个预分配的内存池，包含多个相同大小的对象 </p>
<p><strong>Cache</strong> consists of one or more slabs</p>
<ul>
<li>
<p>Single cache for each unique kernel data structure</p>
</li>
<li>
<p>Each cache filled with <strong>objects</strong> – instantiations of the data structure</p>
</li>
</ul>
<p>When cache created, filled with objects marked as <strong>free</strong></p>
<p>When structures stored, objects marked as <strong>used</strong></p>
<ul>
<li>
<p>If slab is full of used objects, next object allocated from empty slab</p>
</li>
<li>
<p>If no empty slabs, new slab allocated</p>
</li>
</ul>
<p><strong>Benefits</strong> include no fragmentation, fast memory request satisfaction</p>
<p>主要目的：为申请不足一页帧的小对象（缓冲）申请与释放物理内存，以减少碎片</p>
<h4 id="other-issues-prepaging">Other Issues – Prepaging ( 预调页 )<a class="headerlink" href="#other-issues-prepaging" title="Permanent link">&para;</a></h4>
<p>To reduce the large number of page faults that occurs at process startup</p>
<ul>
<li>Prepage all or some of the pages a process will need, before they are referenced</li>
</ul>
<h4 id="other-issues-page-size">Other Issues – Page Size<a class="headerlink" href="#other-issues-page-size" title="Permanent link">&para;</a></h4>
<p>Page size selection must take into consideration:</p>
<ul>
<li>
<p>Fragmentation -&gt; small page size</p>
</li>
<li>
<p>table size -&gt; large page size</p>
</li>
<li>
<p>I/O times -&gt; large page size</p>
</li>
<li>
<p>Locality -&gt; small page size, accurate locality</p>
</li>
</ul>
<h4 id="other-issues-tlb-reach-tlb">Other Issues – TLB Reach（ TLB 范围）<a class="headerlink" href="#other-issues-tlb-reach-tlb" title="Permanent link">&para;</a></h4>
<p>TLB Reach - The amount of memory accessible from the TLB 增大 TLB 范围减少缺页</p>
<p>TLB Reach = (TLB Size) ✖ (Page Size)</p>
<p>Increase the Page Size</p>
<ul>
<li>This may lead to an increase in fragmentation as not all applications require a large page size </li>
</ul>
<p>Provide Multiple Page Sizes</p>
<ul>
<li>This allows applications that require larger page sizes the opportunity to use them without an increase in fragmentation</li>
</ul>
<h4 id="other-issues-program-structure">Other Issues – Program Structure<a class="headerlink" href="#other-issues-program-structure" title="Permanent link">&para;</a></h4>
<p>缺页次数和程序有关</p>
<p>EG，按列访问和按行访问</p>
<p><img src="./assets/image-20241202103517964.png" alt="image-20241202103517964" style="zoom: 33%;" /></p>
<h3 id="other-considerations">Other Considerations<a class="headerlink" href="#other-considerations" title="Permanent link">&para;</a></h3>
<p>不重要 过</p>
<h3 id="operating-system-examples">Operating-System Examples<a class="headerlink" href="#operating-system-examples" title="Permanent link">&para;</a></h3>
<p>不重要 过</p>
<h2 id="file-system-interface">File-System Interface<a class="headerlink" href="#file-system-interface" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>解释文件系统的功能
描述文件系统的接口
讨论文件系统设计权衡，包括访问方法、文件共享、文件锁定和目录结构
探索文件系统保护</p>
</blockquote>
<h3 id="file-concept">File Concept<a class="headerlink" href="#file-concept" title="Permanent link">&para;</a></h3>
<h4 id="file-system">File system<a class="headerlink" href="#file-system" title="Permanent link">&para;</a></h4>
<p>什么是文件系统？The way that controls how data is stored and retrieved in a storage medium.</p>
<ul>
<li>File naming 文件命名</li>
<li>Where files are placed 位置</li>
<li>Metadata 和文件内容相关的管理信息</li>
<li>Access rules 访问规则</li>
</ul>
<h4 id="file-concept_1">File Concept<a class="headerlink" href="#file-concept_1" title="Permanent link">&para;</a></h4>
<p>什么是文件？</p>
<ul>
<li>Contiguous logical address space. A sequence of bits, bytes, lines, or records. The meaning is defined by the creator and user. 连续的逻辑地址空间，一些位、字节、行或记录的序列</li>
<li>在用户进行输入、输出中，文件是基本单位</li>
</ul>
<p>文件类型 Types: </p>
<p>Data：numeric, character, binary
Program：Source, Object, Executable</p>
<h4 id="file-structure">File Structure<a class="headerlink" href="#file-structure" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>None 无结构文件 - sequence of words, bytes</p>
</li>
<li>
<p>Simple record structure</p>
</li>
<li>
<p>Lines </p>
</li>
<li>
<p>Fixed length 定长记录</p>
</li>
<li>
<p>Variable length 变长记录</p>
</li>
<li>
<p>Complex Structures</p>
</li>
<li>
<p>Formatted document：顺序文件、索引文件、索引顺序、散列</p>
</li>
<li>
<p>Relocatable load file   </p>
</li>
<li>
<p>Can simulate last two with first method by inserting appropriate control characters
  通过插入适当的控制字符，可以用第一种方法模拟最后两种</p>
</li>
<li>
<p>Who decides:</p>
</li>
<li>
<p>Operating system 操作系统决定文件</p>
</li>
<li>Program 程序</li>
</ul>
<h4 id="operations-file-attributes">Operations &amp; file attributes<a class="headerlink" href="#operations-file-attributes" title="Permanent link">&para;</a></h4>
<p>File is an abstract data type 抽象数据类型</p>
<p><strong>Create</strong> – 为新文件分配外存空间 + 在目录中创建一个目录项</p>
<p><strong>Write</strong> – define a pointer，每发生写操作，更新写指针</p>
<p><strong>Read</strong> – use the same pointer
    Per-process current file-position pointer</p>
<p><strong>Reposition within file</strong> (<strong>file seek</strong>) - 文件跳转到特定位置开始读写</p>
<p><strong>Delete</strong> - 删除文件对应的目录项和文件控制块（FCB），回收磁盘空间和内存缓冲区</p>
<p><strong>Truncate</strong> - 怎么截断文件</p>
<p><strong>Open</strong>(Fi) – search the directory structure on disk for entry F<sub>i</sub>, and move the content of entry to memory</p>
<p><strong>Close</strong> (Fi) – move the content of entry F<sub>i</sub> in memory to directory structure on disk</p>
<hr />
<p>文件属性</p>
<p><strong>Name</strong> – only information kept in human-readable form 文件名唯一</p>
<p><strong>Identifier</strong> 文件标识符 – unique tag (number) identifies file within file system</p>
<p><strong>Type</strong> 类型 – needed for systems that support different types</p>
<p><strong>Location</strong> – pointer to file location on device</p>
<p><strong>Size</strong> – current file size</p>
<p><strong>Protection</strong> – controls who can do reading, writing, executing</p>
<p><strong>Time, date, and user identification</strong> – data for protection, security, and usage monitoring</p>
<p>Information about files are kept in the <span style="color:#CC0000;"> directory structure </span>, which is maintained on the disk</p>
<h4 id="open-files">Open files<a class="headerlink" href="#open-files" title="Permanent link">&para;</a></h4>
<p>文件描述符是存储在进程的 <code>files_struct</code> 结构中的 <code>fd</code>（文件描述符表）数组的下标，用于唯一标识一个已打开的文件</p>
<p><code>Open()</code> <strong>system call</strong> returns a pointer to an entry in the <strong>open-file table</strong></p>
<p>Per-process table 每个进程的打开文件表: maintained by the kernel; unique for each</p>
<ul>
<li>Current file pointer</li>
<li>Access rights</li>
<li>…</li>
</ul>
<p>System-wide table 全局 table: maintained by the kernel</p>
<ul>
<li>Open count 计数</li>
<li>location？文件磁盘位置</li>
<li>...</li>
</ul>
<hr />
<p>Several pieces of data are needed to manage open files:</p>
<p><strong>File pointer</strong>:  pointer to last read/write location, per process that has the file open</p>
<p><strong>File-open count</strong>: counter of number of times a file is open – to allow removal of data from open-file table when last processes closes it 访问计数值</p>
<p><strong>Disk location of the file</strong>: cache of data access information – system doesn’t need to read it from disk for every operation. 文件物理地址</p>
<p><strong>Access rights</strong>: <em>per-process</em> access mode information</p>
<p>打开一个文件时，属于内存索引结点而磁盘索引结点没有的内容是 访问计数值</p>
<blockquote>
<p>[!NOTE]</p>
<p><strong>文件描述符 FD &amp; 文件控制块 FCB？</strong></p>
<table>
<thead>
<tr>
<th>特性</th>
<th>文件描述符（FD）</th>
<th>文件控制块（FCB）</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>定义层次</strong></td>
<td>用户进程与操作系统之间的接口</td>
<td>文件系统内部的管理结构</td>
</tr>
<tr>
<td><strong>作用</strong></td>
<td>标识打开的文件，用于文件操作</td>
<td>存储文件元信息，管理文件内容</td>
</tr>
<tr>
<td><strong>与进程的关系</strong></td>
<td>进程相关，属于进程的文件描述符表</td>
<td>独立于进程，全局共享</td>
</tr>
<tr>
<td><strong>存在形式</strong></td>
<td>整数值，操作系统分配和管理</td>
<td>数据结构，位于内存和磁盘</td>
</tr>
<tr>
<td><strong>存储的信息</strong></td>
<td>打开的文件标识符</td>
<td>文件元数据（大小、权限、位置等）</td>
</tr>
<tr>
<td><strong>典型操作</strong></td>
<td>系统调用 <code>open()</code>、<code>read()</code>、<code>write()</code></td>
<td>文件系统操作，涉及文件定位与管理</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>文件描述符</strong> 是操作系统提供给用户进程的简化文件接口，用于文件操作的快捷标识。</li>
<li><strong>文件控制块</strong> 是文件系统用于存储文件信息和管理文件的底层结构，体现了文件的全局属性和状态。</li>
</ul>
<p>两者互相关联但层次不同：文件描述符通过操作系统内部结构（如文件描述符表、打开文件表等）最终映射到文件控制块，从而完成具体的文件操作。</p>
</blockquote>
<h3 id="access-methods">Access Methods<a class="headerlink" href="#access-methods" title="Permanent link">&para;</a></h3>
<p><img src="./assets/image-20241204151552427.png" alt="image-20241204151552427" style="zoom:50%;" /></p>
<p>顺序访问</p>
<p><img src="./assets/image-20241204151629460.png" alt="image-20241204151629460" style="zoom:50%;" /></p>
<p>直接访问</p>
<h3 id="directory-structure">目录结构 Directory Structure<a class="headerlink" href="#directory-structure" title="Permanent link">&para;</a></h3>
<p>The directory can be viewed as <strong>a symbol table</strong> that translates file names into their file control blocks.</p>
<p>FCB 文件控制块</p>
<p>A collection of nodes containing (management)  information about all files</p>
<p>目录独立于所有文件之外的文件，有结构、每个 entry 就是一个 FCB，每个 FCB 对应于一个文件</p>
<p>Both the directory structure and the files reside on disk.</p>
<h4 id="both-the-directory-structure-and-the-files-reside-on-disk">Both the directory structure and the files reside on disk<a class="headerlink" href="#both-the-directory-structure-and-the-files-reside-on-disk" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241204153053743.png" alt="image-20241204153053743" style="zoom:50%;" /></p>
<p>The directory records information about the files in the system – such as name, location, size and type.</p>
<h4 id="operations-performed-on-directory">Operations Performed on Directory<a class="headerlink" href="#operations-performed-on-directory" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241204153144630.png" alt="image-20241204153144630" style="zoom:50%;" /></p>
<h4 id="_35">目录作用<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h4>
<p><strong>Efficiency</strong> – locating a file quickly</p>
<p><strong>Naming</strong> – convenient to users</p>
<ol>
<li>Two users can have same name for different files</li>
<li>The same file can have several different names</li>
</ol>
<p><strong>Grouping</strong> – logical grouping of files by properties, (e.g., all Java programs, all games, …)</p>
<h4 id="single-level-directory">Single-Level Directory<a class="headerlink" href="#single-level-directory" title="Permanent link">&para;</a></h4>
<p>为所有用户只提供一级目录，不方便，命名、分组问题</p>
<p><img src="./assets/image-20241204153539634.png" alt="image-20241204153539634" style="zoom:50%;" /></p>
<h4 id="two-level-directory">Two-Level Directory<a class="headerlink" href="#two-level-directory" title="Permanent link">&para;</a></h4>
<p>每个用户有个文件夹</p>
<p><img src="./assets/image-20241204153630912.png" alt="image-20241204153630912" style="zoom:50%;" /></p>
<p>还是不够高效</p>
<h4 id="tree-structured-directories">Tree-Structured Directories<a class="headerlink" href="#tree-structured-directories" title="Permanent link">&para;</a></h4>
<p>树状目录</p>
<p><img src="./assets/image-20241204154112574.png" alt="image-20241204154112574" style="zoom:50%;" /></p>
<p>从一个目录到一个子目录需要一次磁盘 I/O 操作</p>
<p><img src="./assets/image-20241204154200785.png" alt="image-20241204154200785" style="zoom:50%;" /></p>
<h4 id="acyclic-graph-directories">Acyclic-Graph Directories<a class="headerlink" href="#acyclic-graph-directories" title="Permanent link">&para;</a></h4>
<p>无环目录</p>
<p>共享子目录或文件</p>
<ul>
<li>Requirement for file sharing</li>
<li>Have shared subdirectories and files</li>
</ul>
<p><img src="./assets/image-20241204154308896.png" alt="image-20241204154308896" style="zoom:50%;" /></p>
<p><img src="./assets/image-20241204154716519.png" alt="image-20241204154716519" style="zoom:50%;" /></p>
<p>如果有环的话，会有删除问题，重复找到这个文件，reference count（文件被引用次数）&lt;&gt; 0 即使没被使用过</p>
<h4 id="soft-symbolic-link-vs-hard-link">Soft (Symbolic) Link vs. Hard Link<a class="headerlink" href="#soft-symbolic-link-vs-hard-link" title="Permanent link">&para;</a></h4>
<p>软链接</p>
<p>A <strong>soft link</strong> is a <strong>separate file</strong> that points to the original file by storing its path. </p>
<p>The soft link <strong>has its own inode</strong> (FCB), and its data contains the path to the linked file, not the file data itself.</p>
<p>Soft links can <strong>span file systems</strong> since they are simply paths to other files.</p>
<p>字符串指向路径，类似快捷方式，可以跨磁盘，可以在有引用的时候被其他用户删除（链接无效）</p>
<hr />
<p>A <strong>hard link</strong> is <strong>an additional name</strong> for an existing file. It increases the file's <em>link count</em>, which is a count of how many names (links) a file has.</p>
<p>Hard Link 硬链接: Both the original file and the hard link point to the <strong>same inode</strong> (FCB).</p>
<p>Hard links cannot span file systems; one <strong>cannot</strong> create a hard link for a directory to <strong>prevent the creation of cycles</strong>.</p>
<p>指针指向 索引块 -&gt; 文件（FCB/inode 索引节点），只能在同一个文件系统中被使用，在有引用的时候不能被其他用户删除</p>
<p><strong>Summary</strong>: hard link points to the actual data on the disk, while the symbolic link points to the path of the file 硬链接指向磁盘上的实际数据，而符号链接指向文件的路径</p>
<ul>
<li>两种链接方式都能解决 dangling pointer 的问题</li>
<li>硬链接的查找速度比软链接快</li>
</ul>
<h3 id="file-system-mounting">File-System Mounting 文件系统挂载<a class="headerlink" href="#file-system-mounting" title="Permanent link">&para;</a></h3>
<p>A file system must be <strong>mounted</strong> before it can be accessed 文件系统必须先 <strong>挂载</strong> 才能访问</p>
<p>An un-mounted file system is mounted at a <strong>mount point</strong></p>
<p><img src="./assets/image-20241209104208477.png" alt="image-20241209104208477" style="zoom:50%;" /></p>
<blockquote>
<p>可以挂载到 fred 上吗？可以</p>
<p>原来 fred 下的内容（help）可以访问吗？访问不了但还在盘上</p>
</blockquote>
<h4 id="mount-point">Mount Point<a class="headerlink" href="#mount-point" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241209104533983.png" alt="image-20241209104533983" style="zoom:50%;" /></p>
<h3 id="file-sharing">File Sharing<a class="headerlink" href="#file-sharing" title="Permanent link">&para;</a></h3>
<p>Sharing of files on multi-user systems is desirable</p>
<p>Sharing may be done through a protection scheme</p>
<p>On distributed systems, files may be shared across a network</p>
<p>Network File System (NFS) is a common distributed file-sharing method</p>
<h4 id="multiple-users">Multiple Users<a class="headerlink" href="#multiple-users" title="Permanent link">&para;</a></h4>
<p><strong>User ID</strong> s identify users, allowing permissions and protections to be per-user</p>
<p><strong>Group ID</strong> s allow users to be in groups, permitting group access rights</p>
<h4 id="remote-file-systems">Remote File Systems<a class="headerlink" href="#remote-file-systems" title="Permanent link">&para;</a></h4>
<h4 id="consistency-semantics">Consistency Semantics<a class="headerlink" href="#consistency-semantics" title="Permanent link">&para;</a></h4>
<h3 id="protection">Protection<a class="headerlink" href="#protection" title="Permanent link">&para;</a></h3>
<p>File owner/creator should be able to control:</p>
<ul>
<li>what can be done</li>
<li>by whom</li>
</ul>
<p>Types of access：Read, Write, Execute, Append, Delete, List</p>
<h4 id="access-lists-and-groups">Access Lists and Groups<a class="headerlink" href="#access-lists-and-groups" title="Permanent link">&para;</a></h4>
<p>Mode of access:  read, write, execute</p>
<p>权限</p>
<p><img src="./assets/image-20241209105120787.png" alt="image-20241209105120787" style="zoom: 33%;" /></p>
<blockquote>
<p>d 指目录</p>
<p>pbg 指 hard link 的数量</p>
</blockquote>
<h2 id="file-system-implementation">文件系统实现 File system Implementation<a class="headerlink" href="#file-system-implementation" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>To describe the <strong>details</strong> of implementing local file systems and directory structures</p>
<p>To discuss <strong>block allocation</strong> and <strong>free-block algorithms</strong> and trade-offs</p>
<p>磁盘结构</p>
<p>内存结构</p>
</blockquote>
<h3 id="file-system-structure">File-System Structure<a class="headerlink" href="#file-system-structure" title="Permanent link">&para;</a></h3>
<p>File structure</p>
<ul>
<li>Logical storage unit</li>
<li>Collection of related information</li>
</ul>
<p>File system resides on secondary storage (disks)</p>
<p>File system organized into <strong>layers</strong></p>
<p>文件的物理结构：连续分配、链接分配</p>
<p>物理文件的组织方式是由操作系统确定的</p>
<p>一个文件系统可以存放文件的数量受限于文件控制块的数量</p>
<h4 id="layered-file-system">Layered File System 分层<a class="headerlink" href="#layered-file-system" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241209111207161.png" alt="image-20241209111207161" style="zoom:50%;" /></p>
<h4 id="data-structures-used-to-implement-fs">Data Structures Used to Implement FS<a class="headerlink" href="#data-structures-used-to-implement-fs" title="Permanent link">&para;</a></h4>
<p><strong>Disk structures</strong> 磁盘结构</p>
<ul>
<li>主引导记录 Master Boot Record（MBR）</li>
<li>分区表</li>
<li>
<p>Boot control block (per volume) 引导块/启动卷</p>
</li>
<li>
<p>Volume control block per volume (<strong>superblock</strong> in Unix) 超级块</p>
</li>
<li>Directory structure per file system 目录</li>
<li>
<p>Per-file FCB (<strong>inode</strong> in Unix) 文件控制块</p>
</li>
<li>
<p>文件系统空闲块息</p>
</li>
<li>
<p>其他所有目录和文件</p>
</li>
</ul>
<p><strong>In-memory structures</strong></p>
<ul>
<li>In-memory mount table about each mounted volume 关于每个已安装卷的内存安装表</li>
<li>Directory cache</li>
<li>System-wide open-file table</li>
<li>Per-process open-file table</li>
</ul>
<h4 id="fcb">FCB<a class="headerlink" href="#fcb" title="Permanent link">&para;</a></h4>
<p><strong>File control block</strong> – storage structure consisting of information about a file</p>
<p>FCB 存放控制文件需要的各种信息的数据结构，以实现按名存取</p>
<p>FCB 与文件一一对应，一个 FCB 就是一个文件目录项</p>
<p>FCB 包含：基本信息、存取控制信息、使用信息</p>
<p>ACL：access control list 访问控制表</p>
<p><img src="./assets/image-20241209112133801.png" alt="image-20241209112133801" style="zoom:50%;" /></p>
<h4 id="in-memory-structure">In-memory Structure<a class="headerlink" href="#in-memory-structure" title="Permanent link">&para;</a></h4>
<p>open/read a file</p>
<p><img src="./assets/image-20241209112651669.png" alt="image-20241209112651669" style="zoom:50%;" /></p>
<h3 id="virtual-file-system-vfs">Virtual File System (VFS) 虚拟文件系统<a class="headerlink" href="#virtual-file-system-vfs" title="Permanent link">&para;</a></h3>
<p>Virtual File Systems (VFS) provide an <strong>object-oriented way</strong> of implementing file systems. 面向对象方法</p>
<p>VFS allows the same system call interface (the API) to be used for different types of file systems.</p>
<p>The API is to the VFS interface, rather than any specific type of file system.</p>
<p>Defines a network-wide unique structure called <strong>vnode</strong>.</p>
<p>封装</p>
<p><img src="./assets/image-20241209113303154.png" alt="image-20241209113303154" style="zoom: 33%;" /></p>
<p>The four primary object types of VFS 虚拟文件系统的物理结构:</p>
<ul>
<li><strong>superblock object</strong> 超级块: a specific mounted filesystem, corresponding to (but not equal) the superblock in the disk structure</li>
<li><strong>inode object</strong> 索引节点: a specific file, corresponding to (but not equal) FCB in the disk structure</li>
<li><strong>dentry object</strong> 目录: an individual directory entry</li>
<li><strong>file object</strong> 文件: an open file as associated with a process, existing as long as the file is opened</li>
</ul>
<h3 id="directory-implementation">Directory Implementation<a class="headerlink" href="#directory-implementation" title="Permanent link">&para;</a></h3>
<p>Linear list of file names with pointer to the data blocks. 线性列表</p>
<ul>
<li>simple to program</li>
<li>time-consuming to execute Hash </li>
</ul>
<p>Table – linear list with hash data structure. 哈希表</p>
<ul>
<li>decreases directory search time</li>
<li>collisions – situations where two file names hash to the same locationfixed size</li>
<li>can use chained-overflow hash table</li>
<li>Or rehashing to another larger hash table</li>
</ul>
<h3 id="allocation-methods">Allocation Methods<a class="headerlink" href="#allocation-methods" title="Permanent link">&para;</a></h3>
<h4 id="contiguous-allocation">Contiguous allocation 连续分配<a class="headerlink" href="#contiguous-allocation" title="Permanent link">&para;</a></h4>
<ul>
<li>Each file occupies a set of contiguous blocks on the disk</li>
<li>Simple – only starting location (block #) and length (number of blocks) are required</li>
<li>Random access supported</li>
<li>Wasteful of space (dynamic storage-allocation problem)</li>
<li>Files cannot grow Mapping from logical to physical：<img src="../images/image-20241211144254975.png" alt="image-20241211144254975" style="zoom:33%;" /></li>
</ul>
<p>Block to be accessed = Q + start_no
Displacement into block = R</p>
<p>缺点：</p>
<ul>
<li>会有碎片，不方便文件扩展</li>
<li>磁盘 I/O 次数最多</li>
</ul>
<hr />
<p>改进：<strong>Extent-Based Systems</strong></p>
<p>Many newer file systems (I.e. Veritas File System) use a modified contiguous allocation scheme</p>
<p>Extent-based file systems allocate disk blocks in <strong>extents</strong></p>
<p>An extent is a contiguous block of disks</p>
<ul>
<li>Extents are allocated for file allocation</li>
<li>A file consists of one or more extents.</li>
</ul>
<p>Extend 太多，浪费</p>
<h4 id="linked-allocation">Linked allocation 链接分配<a class="headerlink" href="#linked-allocation" title="Permanent link">&para;</a></h4>
<h5 id="_36">隐式链接<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h5>
<p>Each file is a linked list of disk blocks: blocks may be scattered anywhere on the disk.</p>
<p>block 最前面有个 pointer</p>
<p><img src="./assets/image-20241211145704443.png" alt="image-20241211145704443" style="zoom:33%;" /></p>
<p>特点</p>
<ul>
<li>Simple – need only starting address</li>
<li>Free-space management system – no waste of space </li>
<li><strong>No random access, poor reliability</strong> 不支持随机访问</li>
<li>Mapping</li>
</ul>
<h5 id="_37">显式链接<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h5>
<p>改进：文件分配表 File-Allocation Table（FAT），以空间换时间</p>
<p>好处：灵活，快，提高检索速度、减少访问磁盘的次数</p>
<p>坏处：要在内存中存 FAT，占用一定空间</p>
<h4 id="indexed-allocation">Indexed allocation 索引分配<a class="headerlink" href="#indexed-allocation" title="Permanent link">&para;</a></h4>
<p>Brings all pointers together into the index block，index block 存 pointer 信息</p>
<p><img src="./assets/image-20241211145954492.png" alt="image-20241211145954492" style="zoom:33%;" /></p>
<ul>
<li>
<p>Need index table (analogous to <em>page table</em>)</p>
</li>
<li>
<p>Random access</p>
</li>
<li>
<p>Dynamic access without external fragmentation, but have overhead of index block.</p>
</li>
<li>
<p>When mapping from logical to physical in a file of maximum size of 256K words and block size of 512 words.  We need only 1 block for index table.</p>
</li>
</ul>
<p><img src="./assets/image-20241211150401806.png" alt="image-20241211150401806" style="zoom:33%;" /></p>
<p>Mapping</p>
<p>When mapping from logical to physical in a file of unbounded length (block size of 512 words). – more pointers are needed</p>
<h5 id="linked-scheme">Linked scheme<a class="headerlink" href="#linked-scheme" title="Permanent link">&para;</a></h5>
<p><strong>Linked scheme</strong> – Link blocks of index table (no limit on size). 链式</p>
<p><img src="./assets/image-20241211150753298.png" alt="image-20241211150753298" style="zoom: 33%;" /></p>
<p><img src="./assets/image-20241211150625283.png" alt="image-20241211150625283" style="zoom:50%;" /></p>
<hr />
<h5 id="two-level-index">Two-level index<a class="headerlink" href="#two-level-index" title="Permanent link">&para;</a></h5>
<p><strong>Two-level index</strong> (maximum file size is 512^3^)</p>
<p><img src="./assets/image-20241211151259004.png" alt="image-20241211151259004" style="zoom:33%;" /></p>
<p><img src="./assets/image-20241211151324165.png" alt="image-20241211151324165" style="zoom:50%;" /></p>
<table>
<thead>
<tr>
<th></th>
<th><strong>Two-level</strong> <strong>Index</strong></th>
<th><strong>Linked</strong> <strong>Scheme</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Scalability</strong></td>
<td>Supports very large files (up to 512³ words)</td>
<td>Supports dynamic file growth, but chaining may limit scalability</td>
</tr>
<tr>
<td><strong>Random</strong> <strong>Access</strong> <strong>Efficiency</strong></td>
<td>High: Quick locates data blocks using two-level index</td>
<td>Low: Requires sequential traversal of the linked list to find the target block</td>
</tr>
<tr>
<td><strong>Sequential</strong> <strong>Access</strong> <strong>Efficiency</strong></td>
<td>Low: Requires multiple index lookups</td>
<td>High: Linked blocks are directly connected</td>
</tr>
<tr>
<td><strong>Storage</strong> <strong>Overhead</strong></td>
<td>High: Index tables consume significant space, especially for small files</td>
<td>Low: Only requires additional space for pointers in each block</td>
</tr>
<tr>
<td><strong>Implementation</strong> <strong>Complexity</strong></td>
<td>High: Requires management of two-level index table</td>
<td>Low: Easier to implement with simple linked structure</td>
</tr>
<tr>
<td><strong>Reliability</strong></td>
<td>High: Index table corruption affects only part of the file</td>
<td>Low: A broken link can make subsequent blocks inaccessible</td>
</tr>
<tr>
<td><strong>Disk</strong> <strong>Fragmentation</strong></td>
<td>None: Blocks don’t need to be stored contiguously</td>
<td>Present: Linked structure can lead to scattered data blocks</td>
</tr>
<tr>
<td><strong>Best</strong> <strong>Use</strong> <strong>Case</strong></td>
<td>Suitable for random access and very large files (e.g., databases, large file systems)</td>
<td>Suitable for sequential access and small to medium-sized files (e.g., log files, streaming data)</td>
</tr>
</tbody>
</table>
<h5 id="combined-scheme">Combined Scheme<a class="headerlink" href="#combined-scheme" title="Permanent link">&para;</a></h5>
<p>Combined Scheme:  UNIX (4K bytes per block)</p>
<p><img src="./assets/image-20241211151641943.png" alt="image-20241211151641943" style="zoom:33%;" /></p>
<h4 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h4>
<p><img alt="image-20241211151709367" src="assets/image-20241211151709367.png" /></p>
<h3 id="free-space-management">Free-Space Management 磁盘空闲空间管理<a class="headerlink" href="#free-space-management" title="Permanent link">&para;</a></h3>
<h4 id="_38">空闲表法<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h4>
<p>属于连续分配方式</p>
<p>优点</p>
<ul>
<li>较高分配速度，减少访问磁盘的 I/O 频率</li>
</ul>
<h4 id="bit-map">Bit Map 位示图<a class="headerlink" href="#bit-map" title="Permanent link">&para;</a></h4>
<p>当前空闲的磁盘块记录在 super block 中</p>
<p><img src="./assets/image-20241216100958836.png" alt="image-20241216100958836" style="zoom:50%;" /></p>
<ul>
<li>缺点</li>
<li>
<p>Bit map requires extra space</p>
</li>
<li>
<p>优点</p>
</li>
<li>Easy to get contiguous files</li>
<li>简单</li>
</ul>
<p>Example:        </p>
<p>block size = 212 bytes    <br />
disk size = 230 bytes (1 gigabyte)    <br />
n = 230/212 = 218 bits (or 32K bytes)</p>
<h4 id="linked-list">Linked list 链表法<a class="headerlink" href="#linked-list" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Linked list (free list) 空闲链表</p>
</li>
<li>
<p>Cannot get contiguous space easily 难以得到连续空间</p>
</li>
<li>
<p>But basically can work (FAT)</p>
</li>
<li>
<p>No waste of space</p>
</li>
<li>
<p>Grouping 分组– a modification of the Linked List 成组链表法</p>
</li>
<li>Addresses of the n free blocks are stored in the first block. </li>
<li>The first n-1 blocks are actually free. </li>
<li>The last block contains addresses of another n free blocks</li>
<li>Counting 计数</li>
<li>Address of the first free block and number n contiguous blocks </li>
</ul>
<h4 id="protect">Protect<a class="headerlink" href="#protect" title="Permanent link">&para;</a></h4>
<p>Need to protect:</p>
<ul>
<li>Pointer to free list</li>
<li>Bit map</li>
<li>Must be kept on disk</li>
<li>The copy in memory and disk may differ</li>
<li>Cannot allow for block [i] to have a situation where bit [i] = 1 in memory and bit [i] = 0 on disk</li>
</ul>
<p>Solution:</p>
<ul>
<li>Set bit [i] = 1 in disk（1 代表空闲）</li>
<li>deallocate block [i]</li>
<li>Set bit [i] = 1 in memory</li>
</ul>
<p>先更新磁盘再更新内存，保持数据一致性，避免 crash</p>
<h3 id="efficiency-and-performance">Efficiency and Performance<a class="headerlink" href="#efficiency-and-performance" title="Permanent link">&para;</a></h3>
<p>Efficiency dependent on:</p>
<ul>
<li><strong>disk allocation</strong> and <strong>directory</strong> algorithms</li>
<li>types of data kept in file’s directory entry (for example “last write date” is recorded in directory)</li>
<li>Generally, every data item has to be considered for its effect.</li>
</ul>
<p>Performance</p>
<ul>
<li><strong>disk cache</strong> – separate section of main memory for frequently used blocks</li>
<li><strong>free-behind and read-ahead</strong> – techniques to optimize sequential access</li>
<li>improve PC performance by dedicating section of memory as virtual disk, or RAM disk</li>
</ul>
<h4 id="page-cache">Page Cache<a class="headerlink" href="#page-cache" title="Permanent link">&para;</a></h4>
<p>A page cache caches <strong>pages</strong> rather than disk blocks using <span style="color:#CC0000;"> virtual memory </span> techniques</p>
<p>Memory-mapped I/O uses a page cache</p>
<p>Routine I/O through the file system uses the buffer (disk) cache</p>
<p>This leads to the following figure</p>
<p><img src="./assets/image-20241216102559255.png" alt="image-20241216102559255" style="zoom:33%;" /></p>
<h4 id="unified-buffer-cache">Unified Buffer Cache<a class="headerlink" href="#unified-buffer-cache" title="Permanent link">&para;</a></h4>
<p>A unified buffer cache uses the same page cache to cache both <strong>memory-mapped</strong> pages and ordinary <strong>file system I/O</strong></p>
<p>Avoids double caching</p>
<p>用一个统一的 buffer cache</p>
<p><img src="./assets/image-20241216102902616.png" alt="image-20241216102902616" style="zoom:33%;" /></p>
<h2 id="mass-storage-systems">Mass-Storage Systems<a class="headerlink" href="#mass-storage-systems" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>Time to access a disk block</p>
<ul>
<li>seek time, rotational delay, transfer time</li>
</ul>
<p>磁盘调度算法</p>
<p>RAID concept</p>
</blockquote>
<h3 id="overview-of-mass-storage-structure">Overview of Mass Storage Structure<a class="headerlink" href="#overview-of-mass-storage-structure" title="Permanent link">&para;</a></h3>
<h4 id="magnetic-disks">Magnetic disks<a class="headerlink" href="#magnetic-disks" title="Permanent link">&para;</a></h4>
<p>Magnetic disks provide bulk of secondary storage of modern computers</p>
<p>Drives rotate at 60 to 200 times per secondTransfer rate is rate at which data flow between drive and computer</p>
<p><strong>Positioning time</strong> (random-access time) is time to move disk arm to desired cylinder (seek time) and time for desired sector to rotate under the disk head (rotational latency)</p>
<p>Head crash results from disk head making contact with the disk surfaceThat’s bad</p>
<p>每秒转速 r，实际上</p>
<p>半径小（内圈）的和半径大的（外圈）存的数据大小一样</p>
<p>Disks can be removable</p>
<p>Drive attached to computer via <strong>I/O bus</strong></p>
<p>Buses vary, including EIDE, ATA, SATA, USB, Fiber Channel, SCSIHost controller in computer uses bus to talk to disk controller built into drive or storage array</p>
<p><img src="./assets/image-20241216104144039.png" alt="image-20241216104144039" style="zoom:33%;" /></p>
<h4 id="nonvolatile-memory-devices">Nonvolatile Memory Devices<a class="headerlink" href="#nonvolatile-memory-devices" title="Permanent link">&para;</a></h4>
<p>SSD uses NVM devices</p>
<p>Magnetic tape</p>
<h3 id="disk">Disk<a class="headerlink" href="#disk" title="Permanent link">&para;</a></h3>
<h4 id="disk-structure">Disk Structure<a class="headerlink" href="#disk-structure" title="Permanent link">&para;</a></h4>
<p>Disk drives are addressed as large <em>1-dimensional arrays of logical blocks</em>, where the logical block is the smallest unit of transfer. </p>
<ul>
<li>主引导记录 Master Boot Record</li>
<li>分区表</li>
<li>
<p>Boot control block (per volume) 引导块/启动卷</p>
</li>
<li>
<p>Volume control block per volume (<strong>superblock</strong> in Unix) 超级块</p>
</li>
<li>Directory structure per file system 目录</li>
<li>
<p>Per-file FCB (<strong>inode</strong> in Unix) 文件控制块</p>
</li>
<li>
<p>文件系统空闲块息</p>
</li>
<li>
<p>其他所有目录和文件</p>
</li>
</ul>
<p>SSD 固态硬盘</p>
<ul>
<li>缺点：易磨损</li>
<li>基于闪存技术，随机读写速度高于磁盘（写 &gt; 读）</li>
<li>有磨损均衡机制，目的是延长固态硬盘寿命</li>
<li>静态磨损均衡算法通常比动态~表现更优秀</li>
</ul>
<h4 id="disk-attachment">Disk Attachment<a class="headerlink" href="#disk-attachment" title="Permanent link">&para;</a></h4>
<p>磁盘接口</p>
<p>Network-Attached Storage</p>
<h4 id="accessing-a-disk-page">Accessing a Disk Page<a class="headerlink" href="#accessing-a-disk-page" title="Permanent link">&para;</a></h4>
<p><img src="./assets/image-20241216110137892.png" alt="image-20241216110137892" style="zoom:50%;" /></p>
<p>transfer time 和 rotational delay 和磁盘转速有关，转速越高，开销越小</p>
<p>旋转延迟</p>
<ul>
<li>
<p>Average rotational latency (half a rotation) 平均 &frac12; 个圈的延迟</p>
</li>
<li>
<p>与磁盘调度算法无关</p>
</li>
<li>
<p>取决于磁盘空间的分配程序</p>
</li>
<li>
<p>与文件的物理结构有关</p>
</li>
</ul>
<p>主要目标是减少 seek time 以提高效率</p>
<ul>
<li>寻道时间最长</li>
</ul>
<p>寻道时间 <span class="arithmatex">\(T_S=m\times n+s\)</span>，m 是与磁盘移动相关的常数，n 是跨越磁道数量，s 是启动磁头臂的时间</p>
<p>旋转延迟时间 <span class="arithmatex">\(T_r = \frac{1}{2r}\)</span>，r 是磁盘的旋转速度</p>
<p>传输时间 <span class="arithmatex">\(T_t=\frac{b}{rN}\)</span>，b 是每次读/写的字节数，N 是一个磁道上的字节数</p>
<p>总平均存取时间 <span class="arithmatex">\(T_a=T_s+T_r+T_t\)</span></p>
<h4 id="disk-scheduling">Disk Scheduling<a class="headerlink" href="#disk-scheduling" title="Permanent link">&para;</a></h4>
<p>磁盘调度算法</p>
<p>Access time has two major components</p>
<ul>
<li>Seek time is the time for the disk are to move the heads to the cylinder containing the desired sector.</li>
<li>Rotational latency is the additional time waiting for the disk to rotate the desired sector to the disk head.</li>
</ul>
<p>Minimize seek time</p>
<p>Metric: Seek time ≈ seek distance</p>
<p>Several algorithms exist to schedule the servicing of disk I/O requests. </p>
<p>We illustrate them with a request queue (0-199). 最外侧 0，最里层 199</p>
<p>Distance = 98-45 = 53 两个数相减就行</p>
<h5 id="fcfs">FCFS<a class="headerlink" href="#fcfs" title="Permanent link">&para;</a></h5>
<p>先来先服务</p>
<ul>
<li>
<p>会出现 zig zag</p>
</li>
<li>
<p>优点：公平性</p>
</li>
<li>平均寻道长度 =  总磁道数/移动次数</li>
</ul>
<h5 id="sstf">SSTF<a class="headerlink" href="#sstf" title="Permanent link">&para;</a></h5>
<p>shortest seek time first 最短寻道时间优先</p>
<ul>
<li>
<p>每次调度与当前磁头最近的磁道</p>
</li>
<li>
<p>可能会产生饥饿现象 may cause starvation of some requests</p>
</li>
<li>性能比 FCFS 好</li>
</ul>
<h5 id="scan">SCAN<a class="headerlink" href="#scan" title="Permanent link">&para;</a></h5>
<p>扫描算法</p>
<p>The disk arm starts at one end of the disk, and moves toward the other end, servicing requests until it gets to the other end of the disk, where the head movement is reversed and servicing continues.</p>
<p>Sometimes called the elevator algorithm 电梯调度算法</p>
<ul>
<li>
<p>规定了磁头移动方向，可避免饥饿</p>
</li>
<li>
<p>EG, [0, 200] 100, 160, 200, 90, 10</p>
<p><img src="././assets/image-20250104161909559.png" alt="image-20250104161909559" style="zoom:40%;" /></p>
</li>
<li>
<p>对最近扫描过的区域不公平，因此它在局部性方面不如 FCFS 和 SSTF</p>
</li>
</ul>
<h5 id="c-scan">C-SCAN<a class="headerlink" href="#c-scan" title="Permanent link">&para;</a></h5>
<p>循环扫描算法 circular-SCAN</p>
<p>Provides a more uniform wait time than SCAN.</p>
<p>The head moves from one end of the disk to the other, servicing requests as it goes.  When it reaches the other end, however, it immediately returns to the beginning of the disk, without servicing any requests on the return trip.</p>
<p>Treats the cylinders as a circular list that wraps around from the last cylinder to the first one.</p>
<ul>
<li>EG, [0, 200] 100, 160, 200, 0, 10, 90</li>
</ul>
<p><img src="././assets/image-20250104161926401.png" alt="image-20250104161926401" style="zoom: 33%;" /></p>
<h5 id="c-look">C-Look<a class="headerlink" href="#c-look" title="Permanent link">&para;</a></h5>
<p>改进 SCAN 和 C-SCAN，磁头只需要移动到最远端的一个请求即可返回，不需要到达磁盘端点</p>
<p><img src="././assets/image-20250104161951659.png" alt="image-20250104161951659" style="zoom:40%;" /></p>
<blockquote>
<p>Question: What scheduling algorithm is good for SSD（solid state disk，固态硬盘）? </p>
<ul>
<li>FCFS</li>
</ul>
</blockquote>
<p><img src="././assets/image-20250104162015836.png" alt="image-20250104162015836" style="zoom:50%;" /></p>
<h4 id="disk-management">Disk Management<a class="headerlink" href="#disk-management" title="Permanent link">&para;</a></h4>
<p><strong>Low-level formatting</strong>, or physical formatting — Dividing a disk into sectors that the disk controller can read and write.</p>
<p>To use a disk to hold files, the operating system still needs to record its own data structures on the disk.</p>
<ul>
<li>Partition the disk into one or more groups of cylinders.</li>
<li>Logical formatting or “making a file system”.</li>
</ul>
<p>Boot block initializes system.</p>
<ul>
<li>The <em>bootstrap</em> is stored in ROM.</li>
<li>Bootstrap loader program.</li>
</ul>
<p>Methods such as sector sparing used to handle bad blocks.</p>
<p>磁盘逻辑格式化程序</p>
<ul>
<li>建立文件系统的根目录（逻辑格式化）</li>
<li>对保存空闲磁盘块信息的数据结构进行初始化</li>
</ul>
<h3 id="swap-space-management">Swap-Space Management<a class="headerlink" href="#swap-space-management" title="Permanent link">&para;</a></h3>
<p>Swap-space — Virtual memory uses disk space as an extension of main memory.</p>
<p>Swap-space can be carved out of the normal file system, or, more commonly, it can be in a separate disk partition. 可以是文件也可以是分区</p>
<p><img src="./assets/image-20241218151850790.png" alt="image-20241218151850790" style="zoom:33%;" /></p>
<h3 id="raid-structure">RAID Structure<a class="headerlink" href="#raid-structure" title="Permanent link">&para;</a></h3>
<p>RAID：Redundant Arrays of Independent Disks 独立磁盘冗余阵列</p>
<p>RAID – multiple disk drives provides reliability via redundancy.</p>
<p>RAID is arranged into six different levels.</p>
<p>Disk <strong>striping</strong> uses a group of disks as one storage unit.</p>
<ul>
<li>Bit-level StripingBlock-level Striping </li>
<li>different blocks of a file are striped</li>
</ul>
<h3 id="stable-storage-implementation">Stable-Storage Implementation<a class="headerlink" href="#stable-storage-implementation" title="Permanent link">&para;</a></h3>
<p>既可以顺序读写，也可以按任意次序读写的存储器</p>
<ul>
<li>U 盘、光盘、磁盘</li>
</ul>
<h2 id="io-systems">I/O Systems<a class="headerlink" href="#io-systems" title="Permanent link">&para;</a></h2>
<blockquote>
<p>[!IMPORTANT]</p>
<p>Explore the structure of an operating system’s I/O subsystem</p>
<p>Discuss the principles of I/O hardware and its complexity</p>
<p>Provide details of the performance aspects of I/O hardware and software</p>
<p>Interrupts, DMA,</p>
</blockquote>
<h3 id="io-hardware-application">I/O Hardware Application<a class="headerlink" href="#io-hardware-application" title="Permanent link">&para;</a></h3>
<p>Common concepts</p>
<ul>
<li><strong>Port</strong> 端口</li>
<li>port addresses, used by Special I/O instructions &amp; <strong>Memory-mapped</strong> I/O</li>
<li>Device control registers mapped into processor address space.</li>
<li><strong>Bus</strong> 总线 (daisy chain or shared direct access)</li>
<li><strong>Controller</strong> (host adapter) 控制器</li>
</ul>
<p><img src="./assets/image-20241223102241700.png" alt="image-20241223102241700" style="zoom:50%;" /></p>
<h4 id="io-port-registers">I/O Port Registers<a class="headerlink" href="#io-port-registers" title="Permanent link">&para;</a></h4>
<p><strong>Data-in</strong>: read by the host to get input</p>
<p><strong>Data-out</strong>: written by the host to send output</p>
<ul>
<li>data in/out 是相对于 CPU 而言，从外部设备读取是 in，输出是 out</li>
</ul>
<p><strong>Status</strong> 状态寄存器: device status read by the host</p>
<p><strong>Control</strong> 控制寄存器: written by the host to start a command or change the mode of a device</p>
<h4 id="io-controling-methods">I/O controling methods<a class="headerlink" href="#io-controling-methods" title="Permanent link">&para;</a></h4>
<h5 id="polling">Polling<a class="headerlink" href="#polling" title="Permanent link">&para;</a></h5>
<p>轮循——一种 I/O 控制方式</p>
<p>Repeated for each byte:</p>
<p><img src="./assets/image-20241223103025651.png" alt="image-20241223103025651" style="zoom:50%;" /></p>
<p>Determines state of device </p>
<ul>
<li>command-ready</li>
<li>busy</li>
<li>Error</li>
</ul>
<p>Busy-wait cycle in Step 1 to wait for I/O from device</p>
<blockquote>
<p>[!CAUTION]</p>
<p>Repeatedly reading the status register until the busy bit becomes clear. <span style="color:#CC0000;"> Can be inefficient!! </span></p>
</blockquote>
<h5 id="interrupts">Interrupts<a class="headerlink" href="#interrupts" title="Permanent link">&para;</a></h5>
<p>一种 I/O 控制方式</p>
<p><strong>CPU Interrupt-request line</strong> triggered by I/O device</p>
<p><strong>Interrupt handler</strong> 中断处理 receives interrupts</p>
<p><strong>Maskable</strong> to ignore or delay some interrupts</p>
<p>Interrupt vector to dispatch interrupt to correct handler</p>
<ul>
<li>Based on priority</li>
<li>Some nonmaskable</li>
<li>Interrupt chaining: To handle more devices than interrupt vector elements. Handlers on each list are called one by one.</li>
</ul>
<p>Interrupt mechanism also used for exceptions</p>
<p>EG，键盘 keyboard</p>
<hr />
<p><strong>Various Interrupt Processing</strong> 其他中断处理过程</p>
<p><strong>Page fault</strong>: saves the state of the process, moves it to the waiting queue, schedules another process to resume execution, then returns.</p>
<p><strong>Trap</strong> (s/w interrupt): saves the state of user code, switches to supervisor mode. Low priority 低优先级</p>
<p>Low priority interrupt can be preempted by high priority ones. 低优先级中断能被高优先级中断抢占</p>
<p>Example usage: </p>
<ul>
<li>high-priority handler records the I/O status, clears the device interrupt, starts the next pending I/O, and raises a low-priority interrupt to complete the work</li>
<li>Later, the low-priority handlercompletes the user-level I/O by copying data from kernel buffers to the application space and calling the scheduler to place the application on the ready queue</li>
</ul>
<h5 id="direct-memory-access">Direct Memory Access<a class="headerlink" href="#direct-memory-access" title="Permanent link">&para;</a></h5>
<p>DMA 直接内存访问——一种 I/O 控制方式，是控制器</p>
<p>Used to avoid programmed I/O (可编程 I/O) for large data movement </p>
<p>Requires DMA controller</p>
<p>需要 CPU 指出所取数据的地址与长度</p>
<p>优点</p>
<ul>
<li>Bypasses CPU to transfer data directly between I/O device and memory 绕过 CPU，直接在 I/O 设备和内存之间传输数据 &rarr; CPU 和设备并行操作程度得到提升</li>
<li>数据传输以块为单位，CPU 介入的频率进一步降低</li>
</ul>
<p><img src="./assets/image-20241223105154629.png" alt="image-20241223105154629" style="zoom:50%;" /></p>
<p>需要 4 类寄存器</p>
<ul>
<li>CR 命令寄存器</li>
<li>MAR 内存地址寄存器</li>
<li>DR 数据寄存器</li>
<li>DC 数据计数器</li>
</ul>
<h4 id="application-io-interface-io">Application I/O Interface 应用程序 I/O 接口<a class="headerlink" href="#application-io-interface-io" title="Permanent link">&para;</a></h4>
<p>Devices vary in many dimensions</p>
<ul>
<li>Character-stream or block</li>
<li>Sequential or random-access</li>
<li>Sharable or dedicated</li>
<li>Speed of operation</li>
<li>read-write, read only, or write only</li>
</ul>
<p><img src="./assets/image-20241223105355845.png" alt="image-20241223105355845" style="zoom:50%;" /></p>
<p>Permissions  Owner  Group  Major Device Number  Minor Device Number  Timestamp  Device  Name</p>
<p><img src="./assets/image-20241223105509629.png" alt="image-20241223105509629" style="zoom:50%;" /></p>
<p>用户程序对 I/O 设备的请求采用逻辑设备名。而程序执行时使用物理设备名，它们之间的转换是设备无关软件层完成的。主设备和从设备是总线仲裁中的概念。</p>
<h4 id="io-devices">I/O Devices<a class="headerlink" href="#io-devices" title="Permanent link">&para;</a></h4>
<p>设备视为特殊的文件，可以使用文件名访问物理设备</p>
<p><strong>Block devices</strong> 块设备 include disk drives</p>
<ul>
<li>Commands include read, write, seek </li>
<li>Raw I/O or file-system access </li>
<li>Memory-mapped file access possible 可寻址</li>
</ul>
<p><strong>Character devices</strong> 字符设备 include keyboards, mice, serial ports</p>
<ul>
<li>Commands include get, put</li>
<li>Libraries layered on top allow line editing</li>
</ul>
<p>Clocks and Timers</p>
<hr />
<p>共享设备必须是可寻址和可随机访问的设备</p>
<p>将系统调用参数翻译成设备操作命令的工作由 <em>设备无关的 os 软件</em> 完成</p>
<p>向设备寄存器的写命令是在 I/O 软件的 <em>设备驱动程序</em> 中完成的</p>
<p>输入/输出软件一般从上到下分为 4 个层次：用户层、与设备无关的软件层、设备驱动程序及中断处理程序。与设备无关的软件层也就是系统调用的处理程序。</p>
<p>设备的独立性是指用户编程时使用的设备与实际使用的设备无关</p>
<h4 id="blocking-and-nonblocking-io">Blocking and Nonblocking I/O<a class="headerlink" href="#blocking-and-nonblocking-io" title="Permanent link">&para;</a></h4>
<p>Blocking 阻塞式 I/O- process suspended until I/O completed</p>
<ul>
<li>Easy to use and understand</li>
<li>Insufficient for some needs</li>
</ul>
<p>Nonblocking 非阻塞式 I/O - I/O call returns as much as available</p>
<ul>
<li>User interface, data copy (buffered I/O)</li>
<li>Implemented via multi-threading</li>
<li>Returns quickly with count of bytes read or written</li>
</ul>
<p>Asynchronous - process runs while I/O executes</p>
<ul>
<li>Difficult to use</li>
<li>I/O subsystem signals process when I/O completed</li>
</ul>
<p><img src="./assets/image-20241223112145908.png" alt="image-20241223112145908" style="zoom:50%;" /></p>
<h3 id="kernel-io-interface">Kernel I/O Interface<a class="headerlink" href="#kernel-io-interface" title="Permanent link">&para;</a></h3>
<h4 id="kernel-io-subsystem">Kernel I/O Subsystem<a class="headerlink" href="#kernel-io-subsystem" title="Permanent link">&para;</a></h4>
<p>Device-status Table</p>
<h5 id="scheduling_1"><strong>Scheduling</strong> 调度<a class="headerlink" href="#scheduling_1" title="Permanent link">&para;</a></h5>
<ul>
<li>Some I/O request ordering via per-device queue</li>
<li>E.g. disk scheduling</li>
<li>Some OSs try fairness</li>
</ul>
<h5 id="buffering">Buffering<a class="headerlink" href="#buffering" title="Permanent link">&para;</a></h5>
<p><strong>Buffering</strong> 缓存- store data in memory while transferring <em>between devices</em></p>
<ul>
<li>To cope with device <em>speed mismatch</em>, e.g. receiving data from  modem to disk. 缓和 CPU 和 I/O 设备间速度不匹配的矛盾（通常 CPU 比 I/O 快）</li>
<li>Double buffering 双缓冲</li>
<li>To cope with device transfer <em>size mismatch</em>, e.g. network packet</li>
<li>To maintain “copy semantics” (when a write() system call specifies a buffer for storing the data, and modifies its contents after the system call)</li>
<li>减少磁盘 I/O 次数</li>
</ul>
<p>T ：I/O 输入到缓冲区的时间
M：缓冲区传送到工作区时间
C：CPU 对数据的处理时间</p>
<p>单缓冲区平均处理每块数据的时间：<span class="arithmatex">\(Max(C, T)+M\)</span></p>
<p>双缓冲区平均处理每块数据的时间：<span class="arithmatex">\(Max(C+T, M)\)</span></p>
<p>循环缓冲</p>
<p>缓冲池</p>
<ul>
<li>可供多个进程共享使用</li>
</ul>
<h5 id="disk-caching">Disk caching 磁盘高速缓存<a class="headerlink" href="#disk-caching" title="Permanent link">&para;</a></h5>
<p><strong>Caching</strong> - fast memory holding copy of data</p>
<ul>
<li>Always just <em>a copy</em></li>
<li>Key to performance</li>
<li>软件机制</li>
<li>解决 I/O 比 CPU 慢很多的问题</li>
</ul>
<p>高速缓存和缓冲区的对比</p>
<p><img src="././assets/image-20250104154338116.png" alt="image-20250104154338116" style="zoom:50%;" /></p>
<h5 id="spooling">Spooling<a class="headerlink" href="#spooling" title="Permanent link">&para;</a></h5>
<p><strong>Spooling</strong> 假脱机- hold output for a device</p>
<ul>
<li>If device can serve only one request at a time i.e., Printing</li>
<li>软件机制，需要外存、多道程序设计技术的支持</li>
<li>
<p>大容量、高速度的外存作为输入井、输出井</p>
</li>
<li>
<p>提高 I/O 速度，独占设备改造成共享设备</p>
</li>
<li>以空间换时间</li>
<li>可以实现虚拟设备</li>
</ul>
<p>通道技术</p>
<ul>
<li>硬件机制</li>
</ul>
<p><strong>Device reservation</strong> - provides exclusive access to a device</p>
<ul>
<li>System calls for allocation and deallocation</li>
<li>Watch out for deadlock</li>
</ul>
<h4 id="io-subsystem-transforming">I/O Subsystem Transforming<a class="headerlink" href="#io-subsystem-transforming" title="Permanent link">&para;</a></h4>
<p>先分配设备，再分配设备控制器，最后分配通道</p>
<p>用户程序发出磁盘 I/O 请求后，</p>
<ul>
<li>
<p>系统的处理流程是：用户程序 → 系统调用处理程序 → 设备驱动程序 → 中断处理程序</p>
</li>
<li>
<p>其中，计算数据所在磁盘的柱面号、磁头号、扇区号的程序是 <strong>设备驱动程序</strong></p>
</li>
<li>
<p>驱动程序与 I/O 控制方式有关</p>
<p>初始化设备是由驱动程序控制完成的</p>
<p>进程再执行驱动程序时可能进入阻塞态</p>
<p>读/写设备的操作是由驱动程序控制完成的</p>
</li>
<li>
<p>设备驱动程序处理顺序</p>
<ul>
<li>将抽象要求转化成具体要求 → 对服务请求进行校验 → 检查设备的状态 → 传送必要参数 → 启动 I/O 设备</li>
</ul>
</li>
</ul>
<h4 id="io-requests-to-hardware-operations">I/O Requests to Hardware Operations<a class="headerlink" href="#io-requests-to-hardware-operations" title="Permanent link">&para;</a></h4>
<p>通道控制设备控制器，设备控制器控制设备工作</p>
<p>设备分配过程中，先后访问的数据结构为 SDT DCT COCT CHCT，设备、控制器、通道都要可用</p>
<p>Consider reading a file from disk for a process: </p>
<ul>
<li>Determine device holding file MS-DOS uses the ‘c:’ disk id; Unix uses the mount table</li>
<li>Translate name to device representation</li>
<li>Physically read data from disk into buffer</li>
<li>Make data available to requesting process</li>
<li>Return control to process</li>
</ul>
<h4 id="performance">Performance<a class="headerlink" href="#performance" title="Permanent link">&para;</a></h4>
<p><strong>I/O</strong> is a major factor in system performance:</p>
<ul>
<li>Demands CPU to execute device driver, kernel I/O code</li>
<li>Context switches due to interrupts are heavy burden on CPU</li>
<li>Data copying</li>
<li>Network traffic especially stressful</li>
</ul>
<p>改善磁盘 I/P 性能</p>
<ul>
<li>重排 I/O 请求次序</li>
<li>预读和滞后写</li>
<li>优化文件物理块的分布</li>
</ul>
<h2 id="quiz-lab">Quiz &amp; LAB<a class="headerlink" href="#quiz-lab" title="Permanent link">&para;</a></h2>
<h3 id="quiz">quiz<a class="headerlink" href="#quiz" title="Permanent link">&para;</a></h3>
<p>make install  Linux /boot</p>
<p>~ home directory</p>
<p>struct task_struct</p>
<p>h✖ 10+200(1-h)=（1+0.5）✖100 </p>
<h3 id="lab">lab<a class="headerlink" href="#lab" title="Permanent link">&para;</a></h3>
<p>Linux 指令：ls, cp, ln, mv, echo, ....</p>
<p><strong>目录类</strong></p>
<ol>
<li><strong>pwd</strong>
    <strong>作用</strong>：显示当前工作目录的绝对路径。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>$<span class="w"> </span><span class="nb">pwd</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>/home/user
</span></code></pre></div></td></tr></table></div>
<ol start="2">
<li><strong>cd</strong>
    <strong>作用</strong>：切换工作目录。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/etc
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>$<span class="w"> </span><span class="nb">pwd</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a>/etc
</span></code></pre></div></td></tr></table></div>
<ol start="3">
<li><strong>ls</strong>
    <strong>作用</strong>：列出指定目录下的文件和子目录。
    <strong>常用选项</strong>：</li>
</ol>
<ul>
<li><code>-l</code>：详细信息格式。</li>
<li><code>-a</code>：显示隐藏文件（以 <code>.</code> 开头的文件）。
      <strong>示例</strong>：</li>
</ul>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>$<span class="w"> </span>ls<span class="w"> </span>-la
</span></code></pre></div></td></tr></table></div>
<ol start="4">
<li><strong>ln</strong>
    <strong>作用</strong>：创建文件的链接（硬链接或符号链接）。
    <strong>示例</strong>：</li>
</ol>
<ul>
<li>
<p>创建符号链接：</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/path/to/original<span class="w"> </span>/path/to/link
</span></code></pre></div></td></tr></table></div>
</li>
<li>
<p>创建硬链接：</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a>$<span class="w"> </span>ln<span class="w"> </span>/path/to/original<span class="w"> </span>/path/to/link
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<ol start="5">
<li><strong>.</strong>
    <strong>作用</strong>：表示当前目录。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a>$<span class="w"> </span>ls<span class="w"> </span>.
</span></code></pre></div></td></tr></table></div>
<ol start="6">
<li><strong>..</strong>
    <strong>作用</strong>：表示上级目录。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..
</span></code></pre></div></td></tr></table></div>
<ol start="7">
<li><strong>~</strong>
    <strong>作用</strong>：表示当前用户的主目录。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~
</span></code></pre></div></td></tr></table></div>
<p><strong>权限类</strong></p>
<ol>
<li><strong>chmod</strong>
    <strong>作用</strong>：更改文件或目录的权限。
    <strong>格式</strong>：<code>chmod [选项] 权限 文件</code>
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a>$<span class="w"> </span>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>file
</span></code></pre></div></td></tr></table></div>
<ol start="2">
<li><strong>chown</strong>
    <strong>作用</strong>：更改文件或目录的所有者。
    <strong>格式</strong>：<code>chown [选项] 用户:组 文件</code>
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a>$<span class="w"> </span>chown<span class="w"> </span>user:group<span class="w"> </span>file
</span></code></pre></div></td></tr></table></div>
<p><strong>解压类</strong></p>
<ol>
<li><strong>tar</strong>
    <strong>作用</strong>：创建和提取 tar 压缩包。
    <strong>示例</strong>：</li>
</ol>
<ul>
<li>
<p>创建压缩包：</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a>$<span class="w"> </span>tar<span class="w"> </span>-cvf<span class="w"> </span>archive.tar<span class="w"> </span>file1<span class="w"> </span>file2
</span></code></pre></div></td></tr></table></div>
</li>
<li>
<p>解压压缩包：</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a>$<span class="w"> </span>tar<span class="w"> </span>-xvf<span class="w"> </span>archive.tar
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<ol start="2">
<li><strong>gzip</strong>
    <strong>作用</strong>：对文件进行压缩或解压缩（.gz 格式）。
    <strong>示例</strong>：</li>
</ol>
<ul>
<li>
<p>压缩：</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a>$<span class="w"> </span>gzip<span class="w"> </span>file
</span></code></pre></div></td></tr></table></div>
</li>
<li>
<p>解压：</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a>$<span class="w"> </span>gzip<span class="w"> </span>-d<span class="w"> </span>file.gz
</span></code></pre></div></td></tr></table></div>
</li>
</ul>
<p><strong>搜索类</strong></p>
<ol>
<li><strong>grep</strong>
    <strong>作用</strong>：搜索文本内容。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a>$<span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;pattern&quot;</span><span class="w"> </span>file
</span></code></pre></div></td></tr></table></div>
<ol start="2">
<li><strong>find</strong>
    <strong>作用</strong>：搜索文件或目录。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a>$<span class="w"> </span>find<span class="w"> </span>.<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.h&quot;</span><span class="w"> </span>-print
</span></code></pre></div></td></tr></table></div>
<p><strong>设备类</strong></p>
<ol>
<li><strong>mount</strong>
    <strong>作用</strong>：挂载设备或文件系统。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a>$<span class="w"> </span>mount<span class="w"> </span>/dev/sda1<span class="w"> </span>/mnt
</span></code></pre></div></td></tr></table></div>
<ol start="2">
<li><strong>umount</strong>
    <strong>作用</strong>：卸载挂载的设备或文件系统。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a>$<span class="w"> </span>umount<span class="w"> </span>/mnt
</span></code></pre></div></td></tr></table></div>
<p><strong>进程类</strong></p>
<ol>
<li><strong>ps</strong>
    <strong>作用</strong>：查看系统中的进程。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a>$<span class="w"> </span>ps<span class="w"> </span>aux
</span></code></pre></div></td></tr></table></div>
<ol start="2">
<li><strong>top</strong>
    <strong>作用</strong>：动态显示系统资源使用情况和进程信息。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a>$<span class="w"> </span>top
</span></code></pre></div></td></tr></table></div>
<ol start="3">
<li><strong>kill</strong>
    <strong>作用</strong>：终止指定进程。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a>$<span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-9<span class="w"> </span>PID
</span></code></pre></div></td></tr></table></div>
<p><strong>文件类</strong></p>
<ol>
<li><strong>echo</strong>
    <strong>作用</strong>：输出字符串到终端或文件。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello, World!&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>file
</span></code></pre></div></td></tr></table></div>
<ol start="2">
<li><strong>cat</strong>
    <strong>作用</strong>：查看文件内容或合并文件。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a>$<span class="w"> </span>cat<span class="w"> </span>file
</span></code></pre></div></td></tr></table></div>
<ol start="3">
<li><strong>touch</strong>
    <strong>作用</strong>：创建空文件或更新文件的时间戳。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a>$<span class="w"> </span>touch<span class="w"> </span>file
</span></code></pre></div></td></tr></table></div>
<ol start="4">
<li><strong>mkdir</strong>
    <strong>作用</strong>：创建目录。
    <strong>示例</strong>：</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a>$<span class="w"> </span>mkdir<span class="w"> </span>directory
</span></code></pre></div></td></tr></table></div>
<p>实验指导书</p>
<p>trap 和系统调用</p>
<p>Linux 文件系统：FCB, inode, VFS structure</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025年10月10日 00:34:04 CST">2025年10月10日 00:34:04</span>
  </span>

    
    
    
    
  </aside>




<div id="__comments">
  
    <h2 ><!-- 评论 -->评论区~</h2>
    
    有用的话请给我个赞和 star => <a href="https://cindyzhou2003.github.io/mymkdocs/">
        <img alt="GitHub stars" src="https://img.shields.io/github/stars/CindyZhou2003/mymkdocs.svg?style=plastic&amp;label=Stars"></a>
    
    
    </div>
    <script src="https://giscus.app/client.js"
        data-repo="CindyZhou2003/mymkdocs"
        data-repo-id="R_kgDOJHRt5g"
        data-category="General"
        data-category-id="DIC_kwDOJHRt5s4Cge0r"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>

        updateScheme();

    </script>
    
    
    <!-- Synchronize Giscus theme with palette -->
    <script>
    var giscus = document.querySelector("script[src*=giscus]")
    
    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"
        giscus.setAttribute("data-theme", theme) 
    }
    
    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
            var theme = palette.color.scheme === "slate" ? "dark" : "light"
            localStorage.setItem("data-md-color-scheme", palette.color.scheme === "slate" ? "slate" : "default");
            /* Instruct Giscus to change theme */
            var frame = document.querySelector(".giscus-frame")
            frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
            )
        }
        })
    })
    </script>
                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="PIS.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: 信息安全原理">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                信息安全原理
              </div>
            </div>
          </a>
        
        
          
          <a href="CN.html" class="md-footer__link md-footer__link--next" aria-label="下一页: 计算机网络">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                计算机网络
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024-2025 <a href="https://github.com/CindyZhou2003/mymkdocs"  target="_blank" rel="noopener">Cindy</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/CindyZhou2003/mymkdocs" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "navigation.indexes", "navigation.expand", "toc.follow", "navigation.top", "search.suggest", "navigation.footer", "navigation.tabs", "navigation.tracking", "navigation.instant.progress", "content.code.copy", "search.highlight", "search.share", "content.code.annotate", "navigation.tabs"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
      
        <script src="../js/katex.js"></script>
      
        <script src="../js/tablesort.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>